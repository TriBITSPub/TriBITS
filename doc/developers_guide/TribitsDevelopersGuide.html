<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.6: http://docutils.sourceforge.net/" />
<title>TriBITS Developers Guide and Reference</title>
<meta name="author" content="Roscoe A. Bartlett (bartlettra&#64;ornl.gov)" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5951 2009-05-18 18:03:10Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left{
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="tribits-developers-guide-and-reference">
<h1 class="title">TriBITS Developers Guide and Reference</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Roscoe A. Bartlett (<a class="reference external" href="mailto:bartlettra&#64;ornl.gov">bartlettra&#64;ornl.gov</a>)</td></tr>
</tbody>
</table>
<div class="abstract topic">
<p class="topic-title first">Abstract</p>
<p>This document describes the usage of TriBITS to build, test, and deploy complex software.  The primary audience are those individuals who develop on a software project which uses TriBITS.  The overall structure of a TriBITS project is descrided including all of the various project- and package-specific files that TriBITS requires or can use and how and what order these files are processed.  It also contains detailed reference information on all of the various TriBITS macros and functions.  Many other topics of interest to a TriBITS project developer and archetect are also discussed.</p>
</div>
<!-- Above, the depth of the TOC is set to just 2 because I don't want the -->
<!-- TriBITS function/macro names to have section numbers appearing before them. -->
<!-- Also, some of them are long and I don't want them to go off the page of the -->
<!-- PDF document. -->
<!-- Sections in this document use the underlines: -->
<!--  -->
<!-- Level-1 ================== -->
<!-- Level-2 - - - - - - - - - - - - - - - - - - -->
<!-- Level-3 ++++++++++++++++++ -->
<!-- Level-4 .................. -->
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#introduction" id="id12">1&nbsp;&nbsp;&nbsp;Introduction</a></li>
<li><a class="reference internal" href="#background" id="id13">2&nbsp;&nbsp;&nbsp;Background</a><ul class="auto-toc">
<li><a class="reference internal" href="#tribits-developer-and-user-roles" id="id14">2.1&nbsp;&nbsp;&nbsp;TriBITS Developer and User Roles</a></li>
<li><a class="reference internal" href="#cmake-language-overview-and-gotchas" id="id15">2.2&nbsp;&nbsp;&nbsp;CMake Language Overview and Gotchas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tribits-project-structure" id="id16">3&nbsp;&nbsp;&nbsp;TriBITS Project Structure</a><ul class="auto-toc">
<li><a class="reference internal" href="#tribits-structural-units" id="id17">3.1&nbsp;&nbsp;&nbsp;TriBITS Structural Units</a><ul>
<li><a class="reference internal" href="#tribits-project" id="id18">TriBITS Project</a><ul>
<li><a class="reference internal" href="#tribits-project-core-files" id="id19">TriBITS Project Core Files</a></li>
<li><a class="reference internal" href="#tribits-project-core-variables" id="id20">TriBITS Project Core Variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tribits-repository" id="id21">TriBITS Repository</a><ul>
<li><a class="reference internal" href="#tribits-repository-core-files" id="id22">TriBITS Repository Core Files</a></li>
<li><a class="reference internal" href="#tribits-repository-core-variables" id="id23">TriBITS Repository Core Variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tribits-package" id="id24">TriBITS Package</a><ul>
<li><a class="reference internal" href="#tribits-package-core-files" id="id25">TriBITS Package Core Files</a></li>
<li><a class="reference internal" href="#tribits-package-core-variables" id="id26">TriBITS Package Core Variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tribits-subpackage" id="id27">TriBITS Subpackage</a><ul>
<li><a class="reference internal" href="#tribits-subpackage-core-files" id="id28">TriBITS Subpackage Core Files</a></li>
<li><a class="reference internal" href="#tribits-subpackage-core-variables" id="id29">TriBITS Subpackage Core Variables</a></li>
<li><a class="reference internal" href="#how-is-tribits-subpackage-is-different-from-a-tribits-package" id="id30">How is TriBITS Subpackage is different from a TriBITS Package?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tribits-tpl" id="id31">TriBITS TPL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#processing-of-tribits-files-ordering-and-details" id="id32">3.2&nbsp;&nbsp;&nbsp;Processing of TriBITS Files: Ordering and Details</a></li>
<li><a class="reference internal" href="#coexisting-projects-repositories-and-packages" id="id33">3.3&nbsp;&nbsp;&nbsp;Coexisting Projects, Repositories, and Packages</a></li>
<li><a class="reference internal" href="#standard-tribits-tpls" id="id34">3.4&nbsp;&nbsp;&nbsp;Standard TriBITS TPLs</a></li>
<li><a class="reference internal" href="#where-to-set-variables" id="id35">3.5&nbsp;&nbsp;&nbsp;Where to set variables?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-tribits-projects" id="id36">4&nbsp;&nbsp;&nbsp;Example TriBITS Projects</a><ul class="auto-toc">
<li><a class="reference internal" href="#tribitshelloworld" id="id37">4.1&nbsp;&nbsp;&nbsp;TribitsHelloWorld</a></li>
<li><a class="reference internal" href="#tribitsexampleproject" id="id38">4.2&nbsp;&nbsp;&nbsp;TribitsExampleProject</a></li>
<li><a class="reference internal" href="#mocktrilinos" id="id39">4.3&nbsp;&nbsp;&nbsp;MockTrilinos</a></li>
<li><a class="reference internal" href="#the-tribits-package-itself" id="id40">4.4&nbsp;&nbsp;&nbsp;The TriBITS Package Itself</a></li>
</ul>
</li>
<li><a class="reference internal" href="#package-dependencies-and-enable-disable-logic" id="id41">5&nbsp;&nbsp;&nbsp;Package Dependencies and Enable/Disable Logic</a><ul class="auto-toc">
<li><a class="reference internal" href="#project-packagedependencies-xml" id="id42">5.1&nbsp;&nbsp;&nbsp;&lt;Project&gt;PackageDependencies.xml</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tribits-automated-testing" id="id43">6&nbsp;&nbsp;&nbsp;TriBITS Automated Testing</a><ul class="auto-toc">
<li><a class="reference internal" href="#testing-categories-for-repositories-packages-and-tests" id="id44">6.1&nbsp;&nbsp;&nbsp;Testing categories for Repositories, Packages, and Tests</a></li>
<li><a class="reference internal" href="#pre-push-testing-using-checkin-test-py" id="id45">6.2&nbsp;&nbsp;&nbsp;Pre-push Testing using checkin-test.py</a></li>
<li><a class="reference internal" href="#tribits-package-by-package-ctest-dash-driver" id="id46">6.3&nbsp;&nbsp;&nbsp;TriBITS Package-by-Package CTest/Dash Driver</a></li>
<li><a class="reference internal" href="#tribits-cdash-customizations" id="id47">6.4&nbsp;&nbsp;&nbsp;TriBITS CDash Customizations</a><ul>
<li><a class="reference internal" href="#cdash-regression-email-addresses" id="id48">CDash regression email addresses</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#multi-repository-support" id="id49">7&nbsp;&nbsp;&nbsp;Multi-Repository Support</a><ul class="auto-toc">
<li><a class="reference internal" href="#multi-repository-almost-continuous-integration" id="id50">7.1&nbsp;&nbsp;&nbsp;Multi-Repository Almost Continuous Integration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#development-workflows" id="id51">8&nbsp;&nbsp;&nbsp;Development Workflows</a><ul class="auto-toc">
<li><a class="reference internal" href="#basic-development-workflow" id="id52">8.1&nbsp;&nbsp;&nbsp;Basic Development Workflow</a></li>
<li><a class="reference internal" href="#multi-repository-development-workflow" id="id53">8.2&nbsp;&nbsp;&nbsp;Multi-Repository Development Workflow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#howtos" id="id54">9&nbsp;&nbsp;&nbsp;Howtos</a><ul class="auto-toc">
<li><a class="reference internal" href="#how-to-add-a-new-tribits-package" id="id55">9.1&nbsp;&nbsp;&nbsp;How to Add a new TriBITS Package</a></li>
<li><a class="reference internal" href="#how-to-add-a-new-tribits-package-with-subpackages" id="id56">9.2&nbsp;&nbsp;&nbsp;How to Add a new TriBITS Package with Subpackages</a></li>
<li><a class="reference internal" href="#how-to-add-a-new-tribits-tpl" id="id57">9.3&nbsp;&nbsp;&nbsp;How to Add a new TriBITS TPL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-topics" id="id58">10&nbsp;&nbsp;&nbsp;Additional Topics</a><ul class="auto-toc">
<li><a class="reference internal" href="#tribits-system-project-dependencies" id="id59">10.1&nbsp;&nbsp;&nbsp;TriBITS System Project Dependencies</a></li>
<li><a class="reference internal" href="#project-specific-build-quick-reference" id="id60">10.2&nbsp;&nbsp;&nbsp;Project-Specific Build Quick Reference</a></li>
<li><a class="reference internal" href="#project-and-repositiory-versioning-and-release-mode" id="id61">10.3&nbsp;&nbsp;&nbsp;Project and Repositiory Versioning and Release Mode</a></li>
<li><a class="reference internal" href="#configure-time-system-tests" id="id62">10.4&nbsp;&nbsp;&nbsp;Configure-time System Tests</a></li>
<li><a class="reference internal" href="#creating-source-distributions" id="id63">10.5&nbsp;&nbsp;&nbsp;Creating Source Distributions</a></li>
<li><a class="reference internal" href="#regulated-backward-compatibility-and-deprecated-code" id="id64">10.6&nbsp;&nbsp;&nbsp;Regulated Backward Compatibility and Deprecated Code</a></li>
<li><a class="reference internal" href="#wrapping-exterally-configured-built-software-as-a-tribits-package" id="id65">10.7&nbsp;&nbsp;&nbsp;Wrapping Exterally Configured/Built Software as a TriBITS Package</a></li>
<li><a class="reference internal" href="#tribits-dashboard-driver" id="id66">10.8&nbsp;&nbsp;&nbsp;TriBITS Dashboard Driver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id67">11&nbsp;&nbsp;&nbsp;References</a></li>
<li><a class="reference internal" href="#tribits-detailed-reference-documentation" id="id68">12&nbsp;&nbsp;&nbsp;TriBITS Detailed Reference Documentation</a><ul class="auto-toc">
<li><a class="reference internal" href="#tribits-global-project-settings" id="id69">12.1&nbsp;&nbsp;&nbsp;TriBITS Global Project Settings</a></li>
<li><a class="reference internal" href="#tribits-macros-and-functions" id="id70">12.2&nbsp;&nbsp;&nbsp;TriBITS Macros and Functions</a><ul>
<li><a class="reference internal" href="#tribits-add-advanced-test" id="id71">TRIBITS_ADD_ADVANCED_TEST()</a></li>
<li><a class="reference internal" href="#tribits-add-debug-option" id="id72">TRIBITS_ADD_DEBUG_OPTION()</a></li>
<li><a class="reference internal" href="#tribits-add-example-directories" id="id73">TRIBITS_ADD_EXAMPLE_DIRECTORIES()</a></li>
<li><a class="reference internal" href="#tribits-add-executable" id="id74">TRIBITS_ADD_EXECUTABLE()</a></li>
<li><a class="reference internal" href="#tribits-add-executable-and-test" id="id75">TRIBITS_ADD_EXECUTABLE_AND_TEST()</a></li>
<li><a class="reference internal" href="#tribits-add-library" id="id76">TRIBITS_ADD_LIBRARY()</a></li>
<li><a class="reference internal" href="#tribits-add-option-and-define" id="id77">TRIBITS_ADD_OPTION_AND_DEFINE()</a></li>
<li><a class="reference internal" href="#tribits-add-show-deprecated-warnings-option" id="id78">TRIBITS_ADD_SHOW_DEPRECATED_WARNINGS_OPTION()</a></li>
<li><a class="reference internal" href="#tribits-add-test" id="id79">TRIBITS_ADD_TEST()</a></li>
<li><a class="reference internal" href="#tribits-add-test-directories" id="id80">TRIBITS_ADD_TEST_DIRECTORIES()</a></li>
<li><a class="reference internal" href="#tribits-allow-missing-external-packages" id="id81">TRIBITS_ALLOW_MISSING_EXTERNAL_PACKAGES()</a></li>
<li><a class="reference internal" href="#tribits-configure-file" id="id82">TRIBITS_CONFIGURE_FILE()</a></li>
<li><a class="reference internal" href="#tribits-copy-files-to-binary-dir" id="id83">TRIBITS_COPY_FILES_TO_BINARY_DIR()</a></li>
<li><a class="reference internal" href="#tribits-define-package-dependencies" id="id84">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a></li>
<li><a class="reference internal" href="#tribits-define-repository-packages" id="id85">TRIBITS_DEFINE_REPOSITORY_PACKAGES()</a></li>
<li><a class="reference internal" href="#tribits-define-repository-tpls" id="id86">TRIBITS_DEFINE_REPOSITORY_TPLS()</a></li>
<li><a class="reference internal" href="#tribits-disable-package-on-platforms" id="id87">TRIBITS_DISABLE_PACKAGE_ON_PLATFORMS()</a></li>
<li><a class="reference internal" href="#tribits-include-directories" id="id88">TRIBITS_INCLUDE_DIRECTORIES()</a></li>
<li><a class="reference internal" href="#id7" id="id89">TRIBITS_PACKAGE()</a></li>
<li><a class="reference internal" href="#tribits-package-decl" id="id90">TRIBITS_PACKAGE_DECL()</a></li>
<li><a class="reference internal" href="#tribits-package-def" id="id91">TRIBITS_PACKAGE_DEF()</a></li>
<li><a class="reference internal" href="#tribits-package-postprocess" id="id92">TRIBITS_PACKAGE_POSTPROCESS()</a></li>
<li><a class="reference internal" href="#tribits-process-subpackages" id="id93">TRIBITS_PROCESS_SUBPACKAGES()</a></li>
<li><a class="reference internal" href="#id8" id="id94">TRIBITS_PROJECT()</a></li>
<li><a class="reference internal" href="#tribits-project-define-extra-repositories" id="id95">TRIBITS_PROJECT_DEFINE_EXTRA_REPOSITORIES()</a></li>
<li><a class="reference internal" href="#tribits-set-st-for-dev-mode" id="id96">TRIBITS_SET_ST_FOR_DEV_MODE()</a></li>
<li><a class="reference internal" href="#id9" id="id97">TRIBITS_SUBPACKAGE()</a></li>
<li><a class="reference internal" href="#tribits-subpackage-postprocess" id="id98">TRIBITS_SUBPACKAGE_POSTPROCESS()</a></li>
<li><a class="reference internal" href="#tribits-tpl-declare-libraries" id="id99">TRIBITS_TPL_DECLARE_LIBRARIES()</a></li>
<li><a class="reference internal" href="#tribits-write-flexible-package-client-export-files" id="id100">TRIBITS_WRITE_FLEXIBLE_PACKAGE_CLIENT_EXPORT_FILES()</a></li>
</ul>
</li>
<li><a class="reference internal" href="#general-utility-macros-and-functions" id="id101">12.3&nbsp;&nbsp;&nbsp;General Utility Macros and Functions</a><ul>
<li><a class="reference internal" href="#add-subdirectories" id="id102">ADD_SUBDIRECTORIES()</a></li>
<li><a class="reference internal" href="#advanced-option" id="id103">ADVANCED_OPTION()</a></li>
<li><a class="reference internal" href="#advanced-set" id="id104">ADVANCED_SET()</a></li>
<li><a class="reference internal" href="#append-cmndline-args" id="id105">APPEND_CMNDLINE_ARGS()</a></li>
<li><a class="reference internal" href="#append-glob" id="id106">APPEND_GLOB()</a></li>
<li><a class="reference internal" href="#append-global-set" id="id107">APPEND_GLOBAL_SET()</a></li>
<li><a class="reference internal" href="#append-set" id="id108">APPEND_SET()</a></li>
<li><a class="reference internal" href="#append-string-var" id="id109">APPEND_STRING_VAR()</a></li>
<li><a class="reference internal" href="#append-string-var-ext" id="id110">APPEND_STRING_VAR_EXT()</a></li>
<li><a class="reference internal" href="#append-string-var-with-sep" id="id111">APPEND_STRING_VAR_WITH_SEP()</a></li>
<li><a class="reference internal" href="#assert-defined" id="id112">ASSERT_DEFINED()</a></li>
<li><a class="reference internal" href="#combined-option" id="id113">COMBINED_OPTION()</a></li>
<li><a class="reference internal" href="#concat-strings" id="id114">CONCAT_STRINGS()</a></li>
<li><a class="reference internal" href="#dual-scope-append-cmndline-args" id="id115">DUAL_SCOPE_APPEND_CMNDLINE_ARGS()</a></li>
<li><a class="reference internal" href="#dual-scope-prepend-cmndline-args" id="id116">DUAL_SCOPE_PREPEND_CMNDLINE_ARGS()</a></li>
<li><a class="reference internal" href="#dual-scope-set" id="id117">DUAL_SCOPE_SET()</a></li>
<li><a class="reference internal" href="#global-null-set" id="id118">GLOBAL_NULL_SET()</a></li>
<li><a class="reference internal" href="#global-set" id="id119">GLOBAL_SET()</a></li>
<li><a class="reference internal" href="#join" id="id120">JOIN()</a></li>
<li><a class="reference internal" href="#message-wrapper" id="id121">MESSAGE_WRAPPER()</a></li>
<li><a class="reference internal" href="#multiline-set" id="id122">MULTILINE_SET()</a></li>
<li><a class="reference internal" href="#parse-arguments" id="id123">PARSE_ARGUMENTS()</a></li>
<li><a class="reference internal" href="#prepend-cmndline-args" id="id124">PREPEND_CMNDLINE_ARGS()</a></li>
<li><a class="reference internal" href="#prepend-global-set" id="id125">PREPEND_GLOBAL_SET()</a></li>
<li><a class="reference internal" href="#id10" id="id126">APPEND_SET()</a></li>
<li><a class="reference internal" href="#print-nonempty-var" id="id127">PRINT_NONEMPTY_VAR()</a></li>
<li><a class="reference internal" href="#print-var" id="id128">PRINT_VAR()</a></li>
<li><a class="reference internal" href="#remove-global-duplicates" id="id129">REMOVE_GLOBAL_DUPLICATES()</a></li>
<li><a class="reference internal" href="#set-and-inc-dirs" id="id130">SET_AND_INC_DIRS()</a></li>
<li><a class="reference internal" href="#set-cache-on-off-empty" id="id131">SET_CACHE_ON_OFF_EMPTY()</a></li>
<li><a class="reference internal" href="#set-default" id="id132">SET_DEFAULT()</a></li>
<li><a class="reference internal" href="#set-default-and-from-env" id="id133">SET_DEFAULT_AND_FROM_ENV()</a></li>
<li><a class="reference internal" href="#split" id="id134">SPLIT()</a></li>
<li><a class="reference internal" href="#timer-get-raw-seconds" id="id135">TIMER_GET_RAW_SECONDS()</a></li>
<li><a class="reference internal" href="#timer-get-rel-seconds" id="id136">TIMER_GET_REL_SECONDS()</a></li>
<li><a class="reference internal" href="#timer-print-rel-time" id="id137">TIMER_PRINT_REL_TIME()</a></li>
<li><a class="reference internal" href="#unittest-compare-const" id="id138">UNITTEST_COMPARE_CONST()</a></li>
<li><a class="reference internal" href="#unittest-string-regex" id="id139">UNITTEST_STRING_REGEX()</a></li>
<li><a class="reference internal" href="#unittest-file-regex" id="id140">UNITTEST_FILE_REGEX()</a></li>
<li><a class="reference internal" href="#unittest-final-result" id="id141">UNITTEST_FINAL_RESULT()</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix" id="id142">13&nbsp;&nbsp;&nbsp;Appendix</a><ul class="auto-toc">
<li><a class="reference internal" href="#history-of-tribits" id="id143">13.1&nbsp;&nbsp;&nbsp;History of TriBITS</a></li>
<li><a class="reference internal" href="#design-considerations-for-tribits" id="id144">13.2&nbsp;&nbsp;&nbsp;Design Considerations for TriBITS</a></li>
<li><a class="reference internal" href="#checkin-test-py-help" id="id145">13.3&nbsp;&nbsp;&nbsp;checkin-test.py --help</a></li>
<li><a class="reference internal" href="#egdist-help" id="id146">13.4&nbsp;&nbsp;&nbsp;egdist --help</a></li>
</ul>
</li>
</ul>
</div>
<!-- Common references to TribitsBuildQuickRef document -->
<div class="section" id="introduction">
<h1><a class="toc-backref" href="#id12">1&nbsp;&nbsp;&nbsp;Introduction</a></h1>
<p>This document describes the usage of the TriBITS (Tribal Build, Integration,
Test System) to develop software projects.  An initial overview of TriBITS is
provided in the <a class="reference external" href="../overview/TribitsOverview.pdf">TriBITS Overview</a> document
which contains the big picture and provides a high-level road map to what
TriBITS provides.  This particular document, however, describes the details on
how to use the TriBITS system to create a CMake build system for a set of
compiled software packages.</p>
<p>TriBITS is a fairly extensive framework that is build on
CMake/CTest/CPack/CDash which in of itself is a very extensive system of
software and tools.  The most important thing to remember is that software
project that use TriBITS are really just CMake projects.  TriBITS makes no
attent to hide that either from the TriBITS project developers or from the
users that need to configure and build the software.  Therefore, to make
effective usage of TriBITS, one must learn the basics of CMake.  In
particular, CMake is a Turning complete programming lanauge with local and
global variables (with strange scoping rules), macros, functions, targets,
commands, and other features.  One needs to understand how to define and use
variables, macros, functions in CMake.  One needs to know how to debug
CMakeLists.txt files and CMake code in general (i.e. using <tt class="docutils literal">MESSAGE()</tt> print
statements).  One needs to understand how CMake defines and uses targets for
various qualities like libraries, executables, etc.  Without this basic
understanding of CMake, one will have trouble resolving problems when they
might occur.</p>
<p>The remainder of this documented is structured as follows.  First, there is
some additional <a class="reference internal" href="#background">Background</a> material provided.  Then, a detailed
specification of <a class="reference internal" href="#tribits-project-structure">TriBITS Project Structure</a> is given.  This is followed up
by short descriptions of <cite>Example TriBITS Projects</cite> that are provided with the
TriBITS source tree that are used throughout this document.  The topic of
<a class="reference internal" href="#package-dependencies-and-enable-disable-logic">Package Dependencies and Enable/Disable Logic</a> is then discussed. An
overview of the foundations for <a class="reference internal" href="#tribits-automated-testing">TriBITS Automated Testing</a> is then given.
The topic of TriBITS <a class="reference internal" href="#multi-repository-support">Multi-Repository Support</a> is examined next.
<a class="reference internal" href="#development-workflows">Development Workflows</a> using TriBITS is then explored.  This is followed by
a set of detailed <a class="reference internal" href="#howtos">Howtos</a>.  Later some <a class="reference internal" href="#additional-topics">Additional Topics</a> are presented
that don't fit well into other sections.  Then the main bulk of the detailed
reference material for TriBITS is given in the section <a class="reference internal" href="#tribits-detailed-reference-documentation">TriBITS Detailed
Reference Documentation</a>.  Finally, several bits of information is provided
in the <a class="reference internal" href="#appendix">Appendix</a>.</p>
</div>
<div class="section" id="background">
<h1><a class="toc-backref" href="#id13">2&nbsp;&nbsp;&nbsp;Background</a></h1>
<p>Before diving into the details about TriBITS in the following sections, first
some background is in order.  First, a discussion of <a class="reference internal" href="#tribits-developer-and-user-roles">TriBITS Developer and
User Roles</a> for TriBITS is provided to help the reader identify their own
roles and to help guide the reader to the appropriate documentation.  Then,
section <a class="reference internal" href="#cmake-language-overview-and-gotchas">CMake Language Overview and Gotchas</a> tries to orient readers with
little to no CMake knowledge or experience on where to start and provide some
warnings about non-obvious CMake behavior that often trip up new users of
TriBITS.</p>
<div class="section" id="tribits-developer-and-user-roles">
<h2><a class="toc-backref" href="#id14">2.1&nbsp;&nbsp;&nbsp;TriBITS Developer and User Roles</a></h2>
<p>There are approximately five different types roles with respect to TriBITS.
These different roles require different levels of expertise and knowlege of
CMake and knowledge of the TriBITS system.  The primary roles are 1) <em>TriBITS
Project User</em>, 2) <em>TriBITS Project Developer</em>, 3) <em>TriBITS Project Architect</em>,
4) <em>TriBITS System Developer</em>, and 5) <em>TriBITS System Architect</em>.  Each of
these roles builds on the necessary knolwege of the lower-level roles.</p>
<p>The first role is that of a <strong>TriBITS Project User</strong> who only needs to be able
to configure, build, and test a project that uses TriBITS as its build system.
A person acting in this role needs to know little about CMake other than
basics about how to run the <tt class="docutils literal">cmake</tt> and <tt class="docutils literal">ctest</tt> exectuables, how to set
CMake cache variables, and the basics of building software and running tests
with <tt class="docutils literal">ctest</tt>.  The proper reference for a TriBITS Project User is the
<a class="reference internal" href="#project-specific-build-quick-reference">Project-Specific Build Quick Reference</a>.  Also, the <a class="reference external" href="../overview/TribitsOverview.pdf">TriBITS
Overview</a> document may be of some help
also.  A TriBITS project user does not need to know anything about the CMake
langauge itself or any of the TriBITS macros or functions described in
<a class="reference internal" href="#tribits-macros-and-functions">TriBITS Macros and Functions</a> or really anything else described in this
current document.</p>
<p>A <strong>TriBITS Project Developer</strong> is someone who contributes to a software
project that uses TriBITS.  They will add source files, libraries and
exectuables, test executables and define tests run with <tt class="docutils literal">ctest</tt>.  They have
to configure and build the project code in order to be able to develop and run
tests and therefore this role includes all of the necessary knowledge and
functions of a TriBITS Project User.  A casual TriBITS Project Developer
typically does not need to know a lot about CMake and really only need to know
a subset of the <a class="reference internal" href="#tribits-macros-and-functions">TriBITS Macros and Functions</a> defined in this document in
addition to the genertic <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html">TriBITS Build Quick Reference</a> document.  A slightly more
sophsiticated TriBITS Project Developer will also add new packages, add new
package dependencies, and define new TPLs.  This current TriBITS Developers
Guide and Reference document should supply everything such a developer needs
to know and more.  Only a smaller part of this document needs to be understood
and accessed by people assuming this role.</p>
<p>The next level of roles is a <strong>TriBITS Project Architect</strong>.  This is someone
(perhaps only one person on a project development team) that knows the usage
and functioning of TriBITS in great detail.  They understand how to set up a
TriBITS project from scrach, how to set up automated testing using the TriBITS
system, and know how to use TriBITS to implement the overall software
development process.  A person in this role is also likely to be the one who
makes the initial technical decision for their project to adopt TriBITS as is
native build and test system.  This document (along with detailed
CMake/CTest/CDash documentation provided by Kitware and the larger community)
should provide most of what a person in this role needs to know.  A person
assuming this role is the primary audience for this document.</p>
<p>The last two roles <strong>TriBITS System Developer</strong> and <strong>TriBITS System
Architect</strong> are for those individuals that actually extend and modify the
TriBITS system itself.  A TriBITS System Developer needs to know how to add
new functionlity while maintaining backward compatibility, how to add new unit
tests to the TriBITS system, and perform other related tasks.  Such a
developer needs to be very knowledgeable of the basic functioning of CMake and
know how TriBITS is implemented in the CMake language.  A TriBITS System
Architect is someone who must be consusted on almost all non-trivial changes
or additions to the TriBITS system.  A TriBITS System Architect in addition
needs to know the entire TriBITS system, the design philosophy that provides
the foundation for TriBIITS and be an expert in CMake, CTest, and CDash.
Everything that needs to be known by a TriBITS System Developer and a TriBITS
System Architect is not contained in this document.  Instead, the primary
documentation will be in the TriBITS CMake source code and various unit tests
itself.  At the time of this writing, there is currently there is only one
TriBITS System Architect (who also happens to be the primary author of this
document).</p>
<p>An explicit goal of this document is to make new TriBITS Project System
Archetects (i.e. those would make the decision to adopt TriBITS), and new
TriBITS System Developers to help extend and maintain the system.  As TriBITS
matures and its development stabilizes, the need for a TriBITS System
Architect will be diminished.</p>
<p>So depending on the particular role that a reader falls into, this documnet
may or may not be necessary but instead the TriBITS Overview or the
&lt;Project&gt;BuildQuickRef documents may be more appropriate.</p>
</div>
<div class="section" id="cmake-language-overview-and-gotchas">
<h2><a class="toc-backref" href="#id15">2.2&nbsp;&nbsp;&nbsp;CMake Language Overview and Gotchas</a></h2>
<p>TriBITS removes a lot of the boiler plate code needed to write a CMake
project.  As a result, many people can come into a project that uses TriBITS
and quickly start to contribute by adding new source files, adding new
libraries, adding new tests, and even adding new TriBITS packages and TPLs;
all without really having learned anything about CMake.  One just needs to
copy-and-paste existing example CMake code and files as basically &quot;monkey see,
monkey do&quot;.  As long as nothing out of the ordinary happens, many people can
get along just fine in this mode for a time.</p>
<p>However, we have observed that most mistakes that people make when using
TriBITS, and most of the problems they have when using the sytem, are due to a
basic lack of knowlege of the CMake language.  One can find basic tutorials
and references on the CMake language in various locations online for free.
One can also purchase the <a class="reference external" href="http://www.cmake.org/cmake/help/book.html">offical CMake reference book</a>.  Also, documenation
for any built-in CMake command is available locally by running:</p>
<pre class="literal-block">
$ cmake --help-command &lt;CMAKE_COMMAND&gt;
</pre>
<p>Because tutorials and detailed documentation for the CMake language already
exists, this document will not even attempt to provide a first reference to
CMake (which is a large topic in itself).  However, what we try to provide
below is a short overivew of the more quarky or supprising aspects of the
CMake language that an programmer experienced in another language might get
tripped up by or surprised by.  Some of the more unique features of the
language are described in order to help avoid some of these common mistakes
and provide greater understanding of how TriBITS works.</p>
<p>The CMake language that is used to write CMake projects with TriBITS (and that
core TriBITS itself is implemented in) is a fairly simply programming languge
with fairly simple rules (for the most part).  However, compared to other
programming lanuages, there are a few peculiar aspects to the CMake language
like strange varible scoping rules, arguments to macros and function, that can
make working with it difficult if you don't understand these.  Also, CMake has
some interesting gotchas.  In order to effectively use TriBITS (or just raw
CMake) to construct and maintain a project's CMake files, one must know the
basic rules of CMake.</p>
<p>The first thing to understand about the CMake language is that everthing line
of CMake code is just a command taking a string (or an array of strings) and
functions that operate on strings.  An array argument is just a single with
elements separated by semi-colons <tt class="docutils literal"><span class="pre">&quot;&lt;str0&gt;;&lt;str1&gt;;...&quot;</span></tt>.  CMake is a bit odd
in how it deals with these arrays (which just represented as a string with
elements separated with semi-colons <tt class="docutils literal">';'</tt>).  For example, all of the
following are equivalent and pass in a CMake array with 3 elements [<tt class="docutils literal">A</tt>],
[<tt class="docutils literal">B</tt>], and [<tt class="docutils literal">C</tt>]:</p>
<pre class="literal-block">
SOME_FUNC(A B C)
SOME_FUNC(&quot;A&quot; &quot;B&quot; &quot;C&quot;)
SOME_FUNC(&quot;A;B;C&quot;)
</pre>
<p>However, the above is <em>not</em> the same as:</p>
<pre class="literal-block">
SOME_FUNC(&quot;A B C&quot;)
</pre>
<p>which just passes in a single element with value [<tt class="docutils literal">A B C</tt>].  Raw quotes in
CMake basically escapes the interpetation of space characters as array element
boundaries.  Quotes around arguments with no spaces does nothing (as seen
above).  In order to get a quote char [<tt class="docutils literal">&quot;</tt>] into string, you must escape it
as:</p>
<pre class="literal-block">
SOME_FUNC(\&quot;A\&quot;)
</pre>
<p>which passes an array with the single argument [<tt class="docutils literal">\&quot;A\&quot;</tt>].</p>
<p>Varibles are set using a built-in CMke function that just takes string
arguments like:</p>
<pre class="literal-block">
SET(SOME_VARIABLE &quot;some_value&quot;)
</pre>
<p>In CMake, the above is idential, in every way, to:</p>
<pre class="literal-block">
SET(SOME_VARIABLE some_value)
SET(&quot;SOME_VARIABLE;&quot;some_value&quot;)
SET(&quot;SOME_VARIABLE;some_value&quot;)
</pre>
<p>The function <tt class="docutils literal">SET()</tt> simply interprets the first argument to as the name of
a varible to set in the local scope.  Many other built-in and user-defined
CMake functions work the same way.  That is some of the string argumnets are
interpreted as the names of variables.</p>
<p>However, CMake appears to parse arguments differently for built-in CMake
control structure functions like <tt class="docutils literal">FOREACH()</tt> and <tt class="docutils literal">IF()</tt> and does not just
interpret them as a string array.  For example:</p>
<pre class="literal-block">
FOREACH (SOME_VAR &quot;a;b;c&quot;)
  MESSAGE(&quot;SOME_VAR='${SOME_VAR}'&quot;)
ENDFOREACH()
</pre>
<p>prints <tt class="docutils literal"><span class="pre">`SOME_VAR='a;b;c'</span></tt> instead of printing <tt class="docutils literal"><span class="pre">SOME_VAR='a'</span></tt> followed by
<tt class="docutils literal"><span class="pre">SOME_VAR='b'</span></tt>, etc., as you would otherwise expect.  Therefore, this simple
rule for the handling of function arguments as string arrays does not hold for
CMake logic control commands.  Just follow the CMake documentation for these
control structures..</p>
<p>CMake offers a rich assortment of built-in functions for doing all sorts of
things.  As part of these functions are the built-in <tt class="docutils literal">MACRO()</tt> and the
<tt class="docutils literal">FUNCTION()</tt> functions which allow you to create user-defined macros and
functions (which is what TriBITS is built on).  All of these built-in and
user-defined macros and functions work exactly the same way; they take in an
array of string arguments.  Some functions take in positional arguments but
most actually take a combination of positional and keyword arguments (see
<a class="reference internal" href="#parse-arguments">PARSE_ARGUMENTS()</a>).</p>
<p>Varible names are translated into their stored values using
<tt class="docutils literal">${SOME_VARIABLE}</tt>.  The value that is extracted depends on if the varible
is set in the local or global (cache) scope.  The local scopes for CMake start
in the base project directory in its base <tt class="docutils literal">CMakeLists.txt</tt> file.  Any
varibles that are created by macros in that base local scope are seen across
an entire project but are <em>not</em> persistent across <tt class="docutils literal">cmake</tt> configure
invocations.</p>
<p>The handling of variables is one area where CMake is radically different from
most other languages.  First, a varible that is not defined simply returns
nothing.  What is surprising to most peoople about this is that it does not
even return an empty string!  For example, the following set statement:</p>
<pre class="literal-block">
SET(SOME_VAR a ${SOME_UNDEFINED_VAR} c)
</pre>
<p>produces <tt class="docutils literal"><span class="pre">SOME_VAR='a;c'</span></tt> and <em>not</em> <tt class="docutils literal"><span class="pre">'a;;c'</span></tt>!  The same thing occurs when
an empty varible is dereferenced such as with:</p>
<pre class="literal-block">
SET(EMPTY_VAR &quot;&quot;)
SET(SOME_VAR a ${EMPTY_VAR} c)
</pre>
<p>which produces <tt class="docutils literal"><span class="pre">SOME_VAR='a;c'</span></tt> and <em>not</em> <tt class="docutils literal"><span class="pre">'a;;c'</span></tt>.  In order to always
produce an element in the array even if the varible is empty, one must quote
the argument as with:</p>
<pre class="literal-block">
SET(EMPTY_VAR &quot;&quot;)
SET(SOME_VAR a &quot;${EMPTY_VAR}&quot; c)
</pre>
<p>which produces <tt class="docutils literal"><span class="pre">SOME_VAR='a;;c'</span></tt>, or three elements as one might assume.</p>
<p>This is a common error that people make when they call CMake functions
(built-in or TriBITS-defined) involving varibles that might be undefined or
empty.  For example, for the macro:</p>
<pre class="literal-block">
MACRO(SOME_MACRO  A_ARG  B_ARG  C_ARG)
   ...
ENDMACRO()
</pre>
<p>if someone trys to call it with:</p>
<pre class="literal-block">
SOME_MACRO(a ${SOME_OHTER_VAR} c)
</pre>
<p>and if <tt class="docutils literal"><span class="pre">SOME_OHTER_VAR=&quot;&quot;</span></tt> or if it is undefined, then CMake will error out
with the error message saying that the macro <tt class="docutils literal">SOME_MACRO()</tt> takes 3
arguments but only 2 were provided.  If a varible might be empty but that is
still a valid argument to the command, then it must be quoted as:</p>
<pre class="literal-block">
SOME_MACRO(a &quot;${SOME_OHTER_VAR}&quot; c)
</pre>
<p>Related to this problem is that if you mispell the name of a variable in a
CMake <tt class="docutils literal">IF()</tt> statement like:</p>
<pre class="literal-block">
IF (SOME_VARBLE)
  ...
ENDIF()
</pre>
<p>then it will always be false and the code inside the if statement will never
be executed!  To avoid this problem, use the utility function
<a class="reference internal" href="#assert-defined">ASSERT_DEFINED()</a> as:</p>
<pre class="literal-block">
ASSERT_DEFINED(SOME_VARBLE)
IF (SOME_VARBLE)
  ...
ENDIF()
</pre>
<p>In this case, the mispelled variable would be caught.</p>
<p>While on the subject of <tt class="docutils literal">IF()</tt> statements, CMake has a strange convention.
When you say:</p>
<pre class="literal-block">
IF (SOME_VAR)
  DO_SOMETHING()
ENDIF()
</pre>
<p>then <tt class="docutils literal">SOME_VAR` is interpreted as a variable and will be considered true and
``DO_SOMETHING()</tt> will be called if <tt class="docutils literal">${SOME_VAR}</tt> does <em>not</em> evaluate to
<tt class="docutils literal">0</tt>, <tt class="docutils literal">OFF</tt>, <tt class="docutils literal">NO</tt>, <tt class="docutils literal">FALSE</tt>, <tt class="docutils literal">N</tt>, <tt class="docutils literal">IGNORE</tt>, <tt class="docutils literal">&quot;&quot;</tt>, or ends in the
suffix <tt class="docutils literal"><span class="pre">-NOTFOUND</span></tt>.  How about that for a true/false rule!  To be safe, use
<tt class="docutils literal">ON/OFF</tt> and <tt class="docutils literal">TRUE/FASLE</tt> pairs for setting variables.  Look up native
CMake documentation on <tt class="docutils literal">IF()</tt>.</p>
<p>CMake langauge behavior with respect to case sensitivity is also strange:</p>
<ul class="simple">
<li>Calls of built-in and user-defined macros and functions is <em>case
insensitive</em>!  That is <tt class="docutils literal"><span class="pre">set(...)</span></tt>, <tt class="docutils literal"><span class="pre">SET(...)</span></tt>, <tt class="docutils literal">Set()</tt>, and all other
combinations of upper and lower case characters for 'S', 'E', 'T' all call
the bulit-in <cite>SET()`</cite> function.  The convention in TriBITS is to use all
caps for functions and macros (was adopted by following the conventions used
in the early versions of TriBITS, see <a class="reference internal" href="#history-of-tribits">History of TriBITS</a>).  The
convention in CMake literature from Kitware seems to use lower-case letters
for functions and macros.</li>
<li>The names of CMake varables (local or cache/global) are <em>case sensitive</em>!
That is, <tt class="docutils literal">SOME_VAR</tt> and <tt class="docutils literal">some_var</tt> are <em>different</em> variables.  Built-in
CMake varibles tend use all caps with underscores
(e.g. <tt class="docutils literal">CMAKE_CURRENT_SOURCE_DIR</tt>) but other built-in CMake varibles tend
to use mixed case wtih underscores (e.g. <tt class="docutils literal">CMAKE_Fortran_FLAGS</tt>).  TriBITS
tends to use a similar naming convention where most varibles have mostly
upper-case letters except for proper nouns like the project, package or TPL
name (e.g. <tt class="docutils literal">TribitsProj_TRIBITS_DIR</tt>, <tt class="docutils literal">TriBITS_SOURCE_DIR</tt>,
<tt class="docutils literal">Boost_INCLUDE_DIRS</tt>).</li>
</ul>
<p>I don't know of any other programming language that uses different case
senstivity rules for varibles verses functions.  However, because we must
parse macro and function arguments when writing user-defined macros and
functions, it is a good thing that CMake varibles are case sensitive.  Case
insenstivity would make it much harder and more expensive to parse argument
lists that take keyword-based arguments (see <a class="reference internal" href="#parse-arguments">PARSE_ARGUMENTS()</a>).</p>
<p>Other mistakes that people make result from not understanding how CMake scopes
variables and other entities.  CMake defaults a global scope (i.e. &quot;cache&quot;
varibles) and several nested local scopes that are created by
<tt class="docutils literal">ADD_SUBDIRECTORY()</tt> and entering FUNCTIONS.  See <a class="reference internal" href="#dual-scope-set">DUAL_SCOPE_SET()</a> for a
short discussion of these scoping rules.  It is not just varibles that can
have local and global scoping rules.  Other entities, like defines set with
the built-in command <tt class="docutils literal">ADD_DEFINITIONS()</tt> only apply to the local scope and
child scopes.  That means that if you call <tt class="docutils literal">ADD_DEFINITIONS()</tt> to set a
define that affects the meaning of a header-file in C or C++, for example,
that definition will <em>not</em> carry over to a peer subdirectory and those
definitions will not be set (see warning in <a class="reference internal" href="#tribits-add-library">TRIBITS_ADD_LIBRARY()</a>).</p>
<p>Now that some CMake basics and common gotchas have been reviewed, we now get
into the meat of TriBITS starting with the overall structure of a TriBITS
project.</p>
</div>
</div>
<div class="section" id="tribits-project-structure">
<h1><a class="toc-backref" href="#id16">3&nbsp;&nbsp;&nbsp;TriBITS Project Structure</a></h1>
<p>TriBITS is a framework, implemented in CMake to create CMake projects.  As a
framework, it defines the the overall structure of a CMake build system for a
project and processes project, repository, and package specific files in a
specified order.  All of this processing takes place in the
<a class="reference internal" href="#id8">TRIBITS_PROJECT()</a> macro.</p>
<div class="section" id="tribits-structural-units">
<h2><a class="toc-backref" href="#id17">3.1&nbsp;&nbsp;&nbsp;TriBITS Structural Units</a></h2>
<p>A CMake project that uses TriBITS as its build and test system is composed of
a single <em>TriBITS Project</em>, one or more <em>TriBITS Repositories</em> and one or more
<em>TriBITS Packages</em>.  In addition, a TriBITS Package can be broken up into
<em>TriBITS Subpackages</em>.  Together, the collection of TriBITS Packages and
TriBITS Subpackages are called <em>TriBITS Software Engineering Packages</em>, or
<em>TriBITS SE Packages</em> for short.</p>
<p>First, to establish the basic nomenclature, the key structural TriBITS units
are:</p>
<ul class="simple">
<li><a class="reference internal" href="#tribits-package">TriBITS Package</a>: A collection of related software that typically includes
one or more source files built into one or more libraries and has assoicated
tests to help define and protect the functionality provided by the software.
A package also typically defines a unit of documentation and testing (see
<a class="reference internal" href="#tribits-automated-testing">TriBITS Automated Testing</a>).  A TriBITS package may or may not be broken down into
multiple subpackages. Examples of TriBITS packages in
<tt class="docutils literal">TribitsExampleProject</tt> include <tt class="docutils literal">SimpleCXX</tt>, <tt class="docutils literal">MixedLanguage</tt> and
<tt class="docutils literal">PackageWithSubpackages</tt>.  (Don't confuse a TriBTS &quot;Package&quot; with a raw
CMake &quot;Package&quot; (see <a class="reference internal" href="#history-of-tribits">History of TriBITS</a>).  A raw CMake &quot;Package&quot; actually
maps to a <a class="reference internal" href="#tribits-tpl">TriBITS TPL</a>.)</li>
<li><a class="reference internal" href="#tribits-subpackage">TriBITS Subpackage</a>: A part of a parent package that also typically has
source files built into libraries and tests but is documented and tested
along with the other subpackages the parent package.  The primary purpose
for supporting subpackages to provide finer-grained of control software
dependencies.  In <tt class="docutils literal">TribitsExampleProject</tt>, <tt class="docutils literal">PackageWithSubpackages</tt> is
an example of a package with subpackages <tt class="docutils literal">SubpackaeA</tt>, <tt class="docutils literal">SubpackaeB</tt>, and
<tt class="docutils literal">SubpackageC</tt>.  The full subpackage name has the parent package name
prefixed the the subpackage name
(e.g. <tt class="docutils literal">PackageWithSubpackagesSubpackageA</tt>).  The parent package is always
implicitly dependent on its subpackages.</li>
<li><strong>TriBITS SE Package</strong>: The combined set of TriBITS packages and
subpackages. SE packages are the basis for setting dependencies in the
TriBITS system.  For example, the SE Packages provided by the example
<tt class="docutils literal">PackageWithSubpackages</tt> is (in order of increasing dependencies)
<tt class="docutils literal">PackageWithSubpackagesSubpackaeA</tt>, <tt class="docutils literal">PackageWithSubpackagesSubpackaeB</tt>,
<tt class="docutils literal">PackageWithSubpackagesSubpackageC</tt>, and <tt class="docutils literal">PackageWithSubpackages</tt>.</li>
<li><a class="reference internal" href="#tribits-tpl">TriBITS TPL</a>: The specification for a particular external dependency that
is required or can be used in one or more TriBITS SE Packages.  A TPL (a
Third Party Library) typically provides a list of libraries or a list
include directories for header files but can also be manifisted in order
ways as well.  Examples of basic TPLs include <tt class="docutils literal">BLAS</tt>, <tt class="docutils literal">LAPACK</tt>, and
<tt class="docutils literal">Boost</tt>.</li>
<li><a class="reference internal" href="#tribits-repository">TriBITS Repository</a>: A collection of one or more TriBITS packages
specified in a <tt class="docutils literal">PackagesList.cmake</tt> file.</li>
<li><a class="reference internal" href="#tribits-project">TriBITS Project</a>: A collection of TriBITS Repositories and Packages that
defines a CMake <tt class="docutils literal">PROJECT</tt> and can be configured, built, and tested.</li>
</ul>
<p>The following subsections define the major structural units of a TriBITS
project in more detail.  Each structural unit is described along with the
files and directories assoicated with each.  In addition, a key set of TriBITS
CMake variables for each are defined as well.</p>
<p>In the next major section following this one, some <a class="reference internal" href="#example-tribits-projects">Example TriBITS Projects</a>
are described.  For those who just want to jump in and learn best by example,
these exmaple projects are a good way to start.  These example projects will
be referenced in the more detailed descriptions given in this document.</p>
<p>The CMake varaibles defined by TriBITS described in the structural using below
below fall into one of two types:</p>
<ul class="simple">
<li><em>Local Fixed-Name Variables</em> are used temporarily in the processing of a
TriBITS unit.  These include variables such as <tt class="docutils literal">PROJECT_NAME</tt>,
<tt class="docutils literal">REPOSITORY_NAME</tt>, <tt class="docutils literal">PACKAGE_NAME</tt>, and <tt class="docutils literal">PARENT_PACKAGE_NAME</tt> These are
distinguished by having a fixed/constant name.  They are typically part of
TriBITS reflection system, allowing subordinate units to determine the
encapsulating unit in which they are participating.  For, example, a TriBITS
subpackage can determine its name, its parent package's name and
directories, its parent repository name and directories, and the enclosing
project's name and directories.</li>
<li><em>Namespaced Variables</em> are used to refer to properties of a named TriBITS
unit.  These include variables such as <tt class="docutils literal">${REPOSTORY_NAME}_SOURCE_DIR</tt>
(e.g. <tt class="docutils literal">TribitsExProj_SOURCE_DIR</tt>) and <tt class="docutils literal">${PACKAGE_NAME}_BINARY_DIR</tt>
(e.g. <tt class="docutils literal">SimpleCXX_BINARY_DIR</tt>).  They are available after processing the
unit, for use by downstream or subordinate units.  They are part of the
TriBITS dependency system, allowing downstream units to access properties of
their known upstream dependencies.</li>
</ul>
<p>More information about these various files is described in section <a class="reference internal" href="#processing-of-tribits-files-ordering-and-details">Processing
of TriBITS Files: Ordering and Details</a>.</p>
<div class="section" id="tribits-project">
<h3><a class="toc-backref" href="#id18">TriBITS Project</a></h3>
<ul class="simple">
<li>This defines a complete CMake project build by calling
<tt class="docutils literal"><span class="pre">PROJECT(${PROJECT_NAME}</span> <span class="pre">...)</span></tt>.</li>
<li>Consists of one or more TriBITS Repositories (see <a class="reference internal" href="#tribits-repository">TriBITS Repository</a>).</li>
<li>Defines <tt class="docutils literal">PROJECT_NAME</tt> CMake variable (defined in <tt class="docutils literal">ProjectName.cmake</tt>)</li>
<li>Defines a set of native Repositories (see below) that define packages and
TPLs.  This set of native Repositories defines the official packages list
and dependencies data-structure.  The list of native Repositories can be
empty!</li>
<li>Allows for extra Repositories to be added on before and after the set of
native Repositories (given in <tt class="docutils literal">ExtraRepositoriesList.cmake</tt> or by CMake
variables)</li>
<li>Defines a default CDash server and default project name on the server (the
project name on the CDash server must be the same as <tt class="docutils literal">${PROJECT_NAME})</tt>.</li>
</ul>
<p>For more details on the definition of a TriBITS Project, see:</p>
<ul class="simple">
<li><a class="reference internal" href="#tribits-project-core-files">TriBITS Project Core Files</a></li>
<li><a class="reference internal" href="#tribits-project-core-variables">TriBITS Project Core Variables</a></li>
</ul>
<div class="section" id="tribits-project-core-files">
<h4><a class="toc-backref" href="#id19">TriBITS Project Core Files</a></h4>
<p>The core files making up a TriBITS Project (where <tt class="docutils literal">&lt;projectDir&gt; =
${PROJECT_SOURCE_DIR}</tt>) are:</p>
<pre class="literal-block">
&lt;projectDir&gt;/
   ProjectName.cmake    # Defines PACAKGE_NAME
   CMakeLists.txt       # Base project CMakeLists.txt file
   CTestConfig.cmake    # [Optional] Needed for CDash submits
   Version.cmake        # [Optional] Dev mode, Project version, VC branch
   cmake/
     NativeRepositoriesList.cmake    # [Optional] Used for some meta-projects
     ExtraRepositoriesList.cmake     # [Optional] Lists repos and VC URLs
     ProjectDependenciesSetup.cmake  # [Optional] Project deps overrides
     CallbackDefineProjectPackaging.cmake  # [Optional] CPack settings
     tribits/    # [Optional] Or provide ${PROJECT_NAME}_TRIBITS_DIR
     ctest/
       CTestCustom.cmake.in  # [Optional] Custom ctest settings
</pre>
<p>These TriBITS Project files are documented in more detail below:</p>
<ul class="simple">
<li><a class="reference internal" href="#projectdir-projectname-cmake">&lt;projectDir&gt;/ProjectName.cmake</a></li>
<li><a class="reference internal" href="#projectdir-cmakelists-txt">&lt;projectDir&gt;/CMakeLists.txt</a></li>
<li><a class="reference internal" href="#projectdir-ctestconfig-cmake">&lt;projectDir&gt;/CTestConfig.cmake</a></li>
<li><a class="reference internal" href="#projectdir-version-cmake">&lt;projectDir&gt;/Version.cmake</a></li>
<li><a class="reference internal" href="#projectdir-cmake-nativerepositorieslist-cmake">&lt;projectDir&gt;/cmake/NativeRepositoriesList.cmake</a></li>
<li><a class="reference internal" href="#projectdir-cmake-extrarepositorieslist-cmake">&lt;projectDir&gt;/cmake/ExtraRepositoriesList.cmake</a></li>
<li><a class="reference internal" href="#projectdir-cmake-projectdependenciessetup-cmake">&lt;projectDir&gt;/cmake/ProjectDependenciesSetup.cmake</a></li>
<li><a class="reference internal" href="#projectdir-cmake-callbackdefineprojectpackaging-cmake">&lt;projectDir&gt;/cmake/CallbackDefineProjectPackaging.cmake</a></li>
<li><a class="reference internal" href="#projectdir-cmake-tribits">&lt;projectDir&gt;/cmake/tribits/</a></li>
<li><a class="reference internal" href="#projectdir-cmake-ctest-ctestcustom-cmake-in">&lt;projectDir&gt;/cmake/ctest/CTestCustom.cmake.in</a></li>
</ul>
<p id="projectdir-projectname-cmake"><strong>&lt;projectDir&gt;/ProjectName.cmake</strong>: [Required] At a minimum provides a
<tt class="docutils literal">SET()</tt> statement to set the local variable <tt class="docutils literal">PROJECT_NAME</tt>.  This file is
the first file is read by a number of tools in order to get the TriBITS
project's name.  This file is read first in every context that involves
processing the TriBITS project's files, including processes and tools that
just need to build a package and TPL dependnecy tree (see <cite>Package
Enable/Disable Logic</cite>).  Being this is the first file read in for a TriBITS
project and that it is read in first at the top level scope in every context,
this is a good file to put other universal static project options in that
affect dependency handling.  Note that this is a project, not a repository
file so no general repository-specific settings should go in this file.  A
simple example of this file is <a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">PackageName.cmake</tt>:</p>
<pre class="literal-block">
# Must set the project name as a varaible at very beginning before including anything else
SET(PROJECT_NAME TribitsExProj)

</pre>
<p id="projectdir-cmakelists-txt"><strong>&lt;projectDir&gt;/CMakeLists.txt</strong>: [Required] The top-level CMake project file.
This is the first file that the <tt class="docutils literal">cmake</tt> exectuable processes that starts
everything off and is the base level scope for local CMake variables. Due to a
number of CMake limitations and quarks, a project's top-level
<tt class="docutils literal">CMakeLists.txt</tt> file is not a clean as one might otherwise hope would be
but it is not too bad.  A simple, but representative, example is
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">CMakeLists.txt</tt>:</p>
<pre class="literal-block">
################################################################################
#                                                                              #
#                        TribitsExampleProject                                 #
#                                                                              #
################################################################################

# Make CMake set WIN32 with CYGWIN for older CMake versions.  CMake requires
# this to be in the top-level CMakeLists.txt file and not an include file :-(
SET(CMAKE_LEGACY_CYGWIN_WIN32 1 CACHE BOOL &quot;&quot; FORCE)

#
# A) Define your project name and set up major project options
#
# NOTE: Don't set options that would impact what packages get defined or
# enabled/disabled in this file as that would not impact other tools that
# don't process this file.
#

# Get PROJECT_NAME (must be in file for other parts of system to read)
INCLUDE(&quot;${CMAKE_CURRENT_SOURCE_DIR}/ProjectName.cmake&quot;)

# CMake requires that you declare the CMake project in the top-level file and
# not in an include file :-(
PROJECT(${PROJECT_NAME} NONE)

# Turn on export depenency generation for WrapExteranl package
SET(${PROJECT_NAME}_GENERATE_EXPORT_FILE_DEPENDENCIES_DEFAULT ON)

#
# B) Pull in the TriBITS system and execute
#

SET(${PROJECT_NAME}_TRIBITS_DIR  &quot;&quot;  CACHE  STRING &quot;TriBITS base directory (required!)&quot;)
INCLUDE(&quot;${${PROJECT_NAME}_TRIBITS_DIR}/TriBITS.cmake&quot;)

# CMake requires this be in the top file and not in an include file :-(
CMAKE_MINIMUM_REQUIRED(VERSION ${TRIBITS_CMAKE_MINIMUM_REQUIRED})

# Do all of the processing for this Tribits project
TRIBITS_PROJECT()

</pre>
<p>A couple of CMake and TriBITS quarks that that above example
<tt class="docutils literal">CMakeLists.txt</tt> addresses are worth some discussion.  First, to avoid
duplication, the project's <tt class="docutils literal">ProjectName.cmake</tt> file is read in with an
<tt class="docutils literal">INCLUDE()</tt> that defines the local variable <tt class="docutils literal">PROJECT_NAME</tt>.  Right after
this initial include, the built-in CMake command <tt class="docutils literal"><span class="pre">PROJECT(${PROJECT_NAME}</span>
NONE)</tt> is run.  This command must be explicitly called with <tt class="docutils literal">NONE</tt> so as to
avoid default CMake behavior for defining compilers.  The definition of
compilers comes later as part of the TriBITS system inside of the
<a class="reference internal" href="#id8">TRIBITS_PROJECT()</a> command (see ???).</p>
<p>As noted in the above example file, the only project defaults that should be
set in this top-level <tt class="docutils literal">CMakeLists.txt</tt> file are those that do not impact the
list of package enables/disables.  The latter type of defaults should set in
other files (see below).</p>
<p>In this example project, a CMake cache variable
<tt class="docutils literal">${PROJECT_NAME}_TRIBITS_DIR</tt> must be set by the user to define where the
base <tt class="docutils literal">tribits</tt> source directory is located.  With this variable set
(i.e. passed into <tt class="docutils literal">cmake</tt> command-line use
<tt class="docutils literal"><span class="pre">-DTribitsExProj_TRIBITS_DIR=&lt;someDir&gt;</span></tt>), one just includes a single file to
pull in the TriBITS system:</p>
<pre class="literal-block">
INCLUDE(&quot;${${PROJECT_NAME}_TRIBITS_DIR}/TriBITS.cmake&quot;)
</pre>
<p>With the <tt class="docutils literal">TriBITS.cmake</tt> file included, the configuration of the project
using TriBITS occurs with a single call to <a class="reference internal" href="#id8">TRIBITS_PROJECT()</a>.</p>
<p>Some projects, like Trilinos, actually snapshot the <tt class="docutils literal">tribits</tt> directory into
their source tree and therefore don't need to have this variable set.  In
Trilinos, the include line is just:</p>
<pre class="literal-block">
INCLUDE(${CMAKE_CURRENT_SOURCE_DIR}/cmake/tribits/TriBITS.cmake)
</pre>
<p>The minimum CMake version must also be delcared in the top-level
<tt class="docutils literal">CMakeLists.txt</tt> file as shown.  Explicitly setting the minimum CMake
version avoids strange errors that can occur when someone tries to build the
project using a version of CMake that is too old.  If the given project
requires a version of CMake newer than what is required by TriBITS itelf (as
defined in the variable <tt class="docutils literal">TRIBITS_CMAKE_MINIMUM_REQUIRED</tt> which was set when
the <tt class="docutils literal">TriBITS.cmake</tt> file was included), then that version can be passed
instead of using <tt class="docutils literal">${TRIBITS_CMAKE_MINIMUM_REQUIRED}</tt> (the current minimum
version of CMake required by TriBITS is given at in <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html#getting-set-up-to-use-cmake">TribitsBuildQuickRef</a>)
.  For example, the <tt class="docutils literal">VERA/CMakeLists.txt</tt> file lists as its first line:</p>
<pre class="literal-block">
SET(VERA_TRIBITS_CMAKE_MINIMUM_REQUIRED 2.8.5)
CMAKE_MINIMUM_REQUIRED(VERSION ${VERA_TRIBITS_CMAKE_MINIMUM_REQUIRED})
</pre>
<p id="projectdir-ctestconfig-cmake"><strong>&lt;projectDir&gt;/CTestConfig.cmake</strong>: [Optional] Specifies the CDash site and
project to submit results to when doing an automated build driven by CTest (it
is read by the scripting code in <tt class="docutils literal">TribitsCTestDriverCore.cmake</tt>).  This file
must only be present when the CTest driver code in
<tt class="docutils literal">TribitsCTestDriverCore.cmake</tt> is used (see ???).  This file is also
required to use the TriBITS-generated <tt class="docutils literal">dashboard</tt> target (see <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html#dashboard-submissions">Dashboard
Submissions</a>).  An
example of this file is <a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">CTestConfig.cmake</tt>:</p>
<pre class="literal-block">
INCLUDE(SetDefaultAndFromEnv)

SET(CTEST_NIGHTLY_START_TIME &quot;04:00:00 UTC&quot;) # 10 PM MDT or 9 PM MST

IF (NOT DEFINED CTEST_DROP_METHOD)
  SET_DEFAULT_AND_FROM_ENV(CTEST_DROP_METHOD &quot;http&quot;)
ENDIF()

IF (CTEST_DROP_METHOD STREQUAL &quot;http&quot;)
  SET_DEFAULT_AND_FROM_ENV(CTEST_DROP_SITE &quot;casl-dev.ornl.gov&quot;)
  SET_DEFAULT_AND_FROM_ENV(CTEST_PROJECT_NAME &quot;TribitsExProj&quot;)
  SET_DEFAULT_AND_FROM_ENV(CTEST_DROP_LOCATION &quot;/cdash/submit.php?project=TribitsExProj&quot;)
  SET_DEFAULT_AND_FROM_ENV(CTEST_TRIGGER_SITE &quot;&quot;)
  SET_DEFAULT_AND_FROM_ENV(CTEST_DROP_SITE_CDASH TRUE)
ENDIF()

</pre>
<p>All of the varibles set in this file are directly understood by raw <tt class="docutils literal">ctest</tt>
and will not be explained here further (see documentation for the standard
CMake module <tt class="docutils literal">CTest</tt>).  The usage of the function
<a class="reference internal" href="#set-default-and-from-env">SET_DEFAULT_AND_FROM_ENV()</a> allows the varaibles to be overridded both as
CMake cache variables and in the environment.  The latter is needed when
running using <tt class="docutils literal">ctest</tt> as the driver.  Given that all of these variables are
nicely namespaced, overriding them on the shell environment is not as
dangerous as might otherwise be the case but this is what had to be done to
get around limitations for older versions of CMake/CTest.</p>
<p id="projectdir-version-cmake"><strong>&lt;projectDir&gt;/Version.cmake</strong>: If defined, gives the project's version and
determines development/release mode (see <a class="reference internal" href="#project-and-repositiory-versioning-and-release-mode">Project and Repositiory Versioning
and Release Mode</a>).  This file is read in (using <tt class="docutils literal">INCLUDE()</tt>) in the
project's base-level <tt class="docutils literal"><span class="pre">&lt;projectDir&gt;/CMakeLists.txt</span></tt> file scope so local
variables set in this file are seen by the entire CMake project.  For example,
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">Version.cmake</tt>, this looks like:</p>
<pre class="literal-block">
SET(${REPOSITORY_NAME}_VERSION 1.1)
SET(${REPOSITORY_NAME}_MAJOR_VERSION 01)
SET(${REPOSITORY_NAME}_MAJOR_MINOR_VERSION 010100)
SET(${REPOSITORY_NAME}_VERSION_STRING &quot;1.1 (Dev)&quot;)
SET(${REPOSITORY_NAME}_ENABLE_DEVELOPMENT_MODE_DEFAULT ON) # Change to 'OFF' for a release

</pre>
<p>Note that the prefix <tt class="docutils literal">${REPOSITORY_NAME}_</tt> is used instead of hard-coding
the project name.  This is so that the same <tt class="docutils literal">Version.txt</tt> file can be used
as the the <a class="reference internal" href="#repodir-version-cmake">&lt;repoDir&gt;/Version.cmake</a> file and have the repository name be
flexible.  TriBITS sets <tt class="docutils literal">REPOSITORY_NAME = ${PROJECT_NAME}</tt> when it reads in
this file at the project-level scope.</p>
<p>It is strongly recommended that every TriBITS project contain a
<tt class="docutils literal">Version.cmake</tt> file, even if a release has never occured.  Otherwise, the
project needs to define the variable
<tt class="docutils literal">${PROJECT_NAME}_ENABLE_DEVELOPMENT_MODE_DEFAULT</tt> at the global project
scope (perhaps in <tt class="docutils literal"><span class="pre">&lt;projectDir&gt;/ProjectName.cmake</span></tt>) to get right development
mode of behavior (see <a class="reference internal" href="#project-name-enable-development-mode">${PROJECT_NAME}_ENABLE_DEVELOPMENT_MODE</a>).</p>
<p id="projectdir-cmake-nativerepositorieslist-cmake"><strong>&lt;projectDir&gt;/cmake/NativeRepositoriesList.cmake</strong>: [Optional] If present,
this file gives the list of native repositories to this TriBITS project.  The
file must contain a <tt class="docutils literal">SET()</tt> statement defining the variable
<tt class="docutils literal">${PROJECT_NAME}_NATIVE_REPOSITORES</tt> which is just a flat list of repository
names that must also be directory names under <tt class="docutils literal">&lt;projectDir&gt;/</tt>.  For example,
if this file contains:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_NATIVE_REPOSITORES Repo0 Repo1)
</pre>
<p>then the directories <tt class="docutils literal"><span class="pre">&lt;projectDir&gt;/Repo0</span></tt> and <tt class="docutils literal"><span class="pre">&lt;projectDir&gt;/Repo1</span></tt> must
exist and must be valid TriBITS repositories (see <cite>TriBITS Repository</cite>).</p>
<p>There are no examples for the usage of this file in any of the TriBITS
examples or test projects.  However, support for this file is maintained for
backward compatibility since there are some TriBITS projects that use it.  It
is recommended instead to define multiple repositories using the
<a class="reference internal" href="#projectdir-cmake-extrarepositorieslist-cmake">&lt;projectDir&gt;/cmake/ExtraRepositoriesList.cmake</a> file as it allows for more
flexibility in how extra repositories are specified and how they are accessed.</p>
<p>If this file <tt class="docutils literal">NativeRepositoriesList.cmake</tt> does not exist, then TriBITS
sets <tt class="docutils literal"><span class="pre">`${PROJECT_NAME}_NATIVE_REPOSITORES</span></tt> eqaual to &quot;.&quot;, or the base
project directory (i.e. <tt class="docutils literal"><span class="pre">&lt;projectDir&gt;/.</span></tt>).  In this case, the file
<tt class="docutils literal"><span class="pre">&lt;projectDir&gt;/PackagesList.cmake</span></tt> and <tt class="docutils literal"><span class="pre">&lt;projectDir&gt;/TPLsList.cmake</span></tt> must
exist.  However, if the project has no native packages or TPLs, then these
files be set up to list no packages or TPLs.  This is the case for
meta-projects like VERA that have only extra repositories specified in the
file <a class="reference internal" href="#projectdir-cmake-extrarepositorieslist-cmake">&lt;projectDir&gt;/cmake/ExtraRepositoriesList.cmake</a>.</p>
<p id="projectdir-cmake-extrarepositorieslist-cmake"><strong>&lt;projectDir&gt;/cmake/ExtraRepositoriesList.cmake</strong>: [Optional] If present,
this file defines a list of extra repositories that are added on to the
project's native repositories.  The list of repositories is defined using the
macro <a class="reference internal" href="#tribits-project-define-extra-repositories">TRIBITS_PROJECT_DEFINE_EXTRA_REPOSITORIES()</a>.  For example, the extra
repos file:</p>
<pre class="literal-block">
TRIBITS_PROJECT_DEFINE_EXTRA_REPOSITORIES(
  ExtraRepo1  &quot;&quot;  GIT  someurl.com:/ExtraRepo1  &quot;&quot;  Continuous
  ExtraRepo2  packages/SomePackage/Blah  GIT  someurl2.com:/ExtraRepo2  NOPACKAGES  Nightly
  ExtraRepo3  &quot;&quot;  HG  someurl3.com:/ExtraRepo3 &quot;&quot;  Continuous
  ExtraRepo4  &quot;&quot;  SVN  someurl4.com:/ExtraRepo4 &quot;&quot;  Nightly
  )

</pre>
<p>shows the speification of both TriBITS Repositories and non-TriBITS VC
Repositories.  In the above file, the repositories <tt class="docutils literal">ExtraRepo1</tt>,
<tt class="docutils literal">ExtraRepo3</tt>, and <tt class="docutils literal">ExtraRepo4</tt> are VC repositories that are cloned into
directories under <tt class="docutils literal">&lt;projectDir&gt;</tt> of the same names from the URLs
<tt class="docutils literal"><span class="pre">someurl.com:/ExtraRepo1</span></tt>, <tt class="docutils literal"><span class="pre">someurl3.com:/ExtraRepo3</span></tt>, and
<tt class="docutils literal"><span class="pre">someurl4.com:/ExtraRepo4</span></tt>, respectively.  However, the repository
<tt class="docutils literal">ExtraRepo2</tt> is <strong>not</strong> a <a class="reference internal" href="#tribits-repository">TriBITS Repository</a> because it is marked as
<tt class="docutils literal">NOPACKAGES</tt>.  In this case, it gets cloned as the directory:</p>
<pre class="literal-block">
&lt;projectDir&gt;/packages/SomePackage/Blah
</pre>
<p>However, the code in the tools <tt class="docutils literal"><span class="pre">checkin-test.py</span></tt> and
<tt class="docutils literal">TribitsCTetsDriverCore.cmake</tt> will consider this repository and directory
and any changes to this repository will be listed as changes to
<tt class="docutils literal">somePackage</tt>.</p>
<p id="projectdir-cmake-projectdependenciessetup-cmake"><strong>&lt;projectDir&gt;/cmake/ProjectDependenciesSetup.cmake</strong>: [Optional] If present,
this file is included a single time as part of the generation of the project
dependency data-structure (see ???).  It gets included at the top project
level scope after all of the
<a class="reference internal" href="#repodir-cmake-repositorydependenciessetup-cmake">&lt;repoDir&gt;/cmake/RepositoryDependenciesSetup.cmake</a> files have been included
but before all of the package <a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a> files
are included.  Any local variables set in this file have project-wide scope.
The primary purpose for this file is to set variables that will impact the
processing of project's package's <tt class="docutils literal">Dependencies.cmake</tt> files.</p>
<p>The typical usage of this file is to set the default CDash email base address
that will be the default for all of the defined packages (see <a class="reference internal" href="#cdash-regression-email-addresses">CDash
regression email addresses</a>).  For example, to set the default email address
for all of the packages, one would set in this file:</p>
<pre class="literal-block">
SET_DEFAULT(${PROJECT_NAME}_PROJECT_MASTER_EMAIL_ADDRESSS
    projectx-regressions&#64;somemailserver.org)
</pre>
<p>The repository email address varaibles
<tt class="docutils literal">${REPOSITORY_NAME}_REPOSITORY_EMAIL_URL_ADDRESSS_BASE</tt> and
<tt class="docutils literal">${REPOSITORY_NAME}_REPOSITORY_MASTER_EMAIL_ADDRESSS</tt> possibly set in the
just processed <a class="reference internal" href="#repodir-cmake-repositorydependenciessetup-cmake">&lt;repoDir&gt;/cmake/RepositoryDependenciesSetup.cmake</a> files can
also be overridded here.  The CASL VERA meta-project uses this file to
override several of the repository-specific email addresses for its
constituent CDash email addresses.</p>
<p>In general, variables that affect how package dependnecies are defined or
affect package and TPL enable/disable logic should be defined in this file.</p>
<p id="projectdir-cmake-callbackdefineprojectpackaging-cmake"><strong>&lt;projectDir&gt;/cmake/CallbackDefineProjectPackaging.cmake</strong>: [Optional] If
exists, defines the CPack settings for the project (see <a class="reference external" href="http://www.cmake.org/cmake/help/documentation.html">Offical CPack
Documentation</a> and
<a class="reference external" href="http://www.cmake.org/Wiki/CMake:Packaging_With_CPack">Online CPack Wiki</a>).
This file must define a macro called <tt class="docutils literal">TRIBITS_PROJECT_DEFINE_PACKAGING()</tt>
which is then invoked by TriBITS.  The file:</p>
<blockquote>
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">cmake/CallbackDefineProjectPackaging.cmake</tt></blockquote>
<p>provides a good example which is:</p>
<pre class="literal-block">
MACRO(TRIBITS_PROJECT_DEFINE_PACKAGING)

    TRIBITS_COPY_INSTALLER_RESOURCE(TribitsExProj_README
      &quot;${TribitsExProj_SOURCE_DIR}/README&quot;
      &quot;${TribitsExProj_BINARY_DIR}/README.txt&quot;)
    TRIBITS_COPY_INSTALLER_RESOURCE(TribitsExProj_LICENSE
      &quot;${TribitsExProj_SOURCE_DIR}/LICENSE&quot;
      &quot;${TribitsExProj_BINARY_DIR}/LICENSE.txt&quot;)
  
    SET(CPACK_PACKAGE_DESCRIPTION &quot;TribitsExampleProject just shows you how to use TriBITS.&quot;)
    SET(CPACK_PACKAGE_FILE_NAME &quot;tribitsexproj-setup-${TribitsExProj_VERSION}&quot;)
    SET(CPACK_PACKAGE_INSTALL_DIRECTORY &quot;TribitsExProj ${TribitsExProj_VERSION}&quot;)
    SET(CPACK_PACKAGE_REGISTRY_KEY &quot;TribitsExProj ${TribitsExProj_VERSION}&quot;)
    SET(CPACK_PACKAGE_NAME &quot;tribitsexproj&quot;)
    SET(CPACK_PACKAGE_VENDOR &quot;Sandia National Laboratories&quot;)
    SET(CPACK_PACKAGE_VERSION &quot;${TribitsExProj_VERSION}&quot;)
    SET(CPACK_RESOURCE_FILE_README &quot;${TribitsExProj_README}&quot;)
    SET(CPACK_RESOURCE_FILE_LICENSE &quot;${TribitsExProj_LICENSE}&quot;)
    SET(${PROJECT_NAME}_CPACK_SOURCE_GENERATOR_DEFAULT &quot;TGZ;TBZ2&quot;)
    SET(CPACK_SOURCE_FILE_NAME &quot;tribitsexproj-source-${TribitsExProj_VERSION}&quot;)
    SET(CPACK_COMPONENTS_ALL ${TribitsExProj_PACKAGES} Unspecified)
  
ENDMACRO()

</pre>
<p>The CPack variables that should be defined at the project-level should be
described in the <a class="reference external" href="http://www.cmake.org/cmake/help/documentation.html">Offical CPack Documentation</a>.</p>
<p>Settings that are general for all distributions (like non-package repository
files to exclude from the tarball) should be set at the in the file
<a class="reference internal" href="#repodir-cmake-callbackdefinerepositorypackaging-cmake">&lt;repoDir&gt;/cmake/CallbackDefineRepositoryPackaging.cmake</a>.</p>
<p id="projectdir-cmake-tribits"><strong>&lt;projectDir&gt;/cmake/tribits/</strong>: [Optional] The typical location of the
<tt class="docutils literal">tribits</tt> soruce tree for projects that choose to snapshot or checkout
TriBITS into their source tree.  Trilinos, for example, currently snapshots
the TriBITS source tree into this directory.</p>
<p id="projectdir-cmake-ctest-ctestcustom-cmake-in"><strong>&lt;projectDir&gt;/cmake/ctest/CTestCustom.cmake.in</strong>: [Optional] If this file
exists, it is processed using a <tt class="docutils literal">CONFIGURE_FILE()</tt> command to write the file
<tt class="docutils literal">CTestCustom.cmake</tt> in the project base build tree.  This file is picked up
automatically by <tt class="docutils literal">ctest</tt> (see <a class="reference external" href="http://www.cmake.org/Wiki/CMake/Testing_With_CTest">CTest documentation</a>).  This file is
typically used to change the maximum size of test output.  For example, the
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/cmake/ctest/CTestCustom.cmake.in`` looks like:</p>
<pre class="literal-block">
# Allow full output to go to CDash
SET(CTEST_CUSTOM_MAXIMUM_PASSED_TEST_OUTPUT_SIZE 0)
SET(CTEST_CUSTOM_MAXIMUM_FAILED_TEST_OUTPUT_SIZE 0)
# WARNING!  This could be a lot of output and could overwhelm CDash and the
# MySQL DB so this might not be a good idea!

</pre>
<p>which sets the output size for each test submitted to CDash be unlimited
(which is not really recommended).  These variables used by Trilinos at one
time were:</p>
<pre class="literal-block">
SET(CTEST_CUSTOM_MAXIMUM_PASSED_TEST_OUTPUT_SIZE 50000)
SET(CTEST_CUSTOM_MAXIMUM_FAILED_TEST_OUTPUT_SIZE 5000000)
</pre>
<p>which sets the max output for passed and failed tests to 50000k and 5000000k,
respectively.</p>
<p>For documentation of the options one can change for CTest, see <a class="reference external" href="http://www.cmake.org/Wiki/CMake/Testing_With_CTest">This Online
Wiki Page</a>.</p>
</div>
<div class="section" id="tribits-project-core-variables">
<h4><a class="toc-backref" href="#id20">TriBITS Project Core Variables</a></h4>
<p>The following local variables are defined in the top-level Project
<tt class="docutils literal">CMakeLists.txt</tt> file scople and are therefore acceessible by all files
prcessed by TriBITS:</p>
<blockquote>
<p><tt class="docutils literal">PROJECT_NAME</tt></p>
<blockquote>
The name of the TriBTS Project.  This exists to support, among other
things, the ability for subordinate units (Repositories and Packages) to
determine the Project in which is participating.  This is typically read
from a <tt class="docutils literal">SET()</tt> statement in the project's
<a class="reference internal" href="#projectdir-projectname-cmake">&lt;projectDir&gt;/ProjectName.cmake</a> file.</blockquote>
<p><tt class="docutils literal">PROJECT_SOURCE_DIR</tt></p>
<blockquote>
The absolute path to the base Project source directory.  This is set
automatically by TriBITS given the directory passed into <tt class="docutils literal">cmake</tt> at
configure time at the beginning of the <a class="reference internal" href="#id8">TRIBITS_PROJECT()</a> macro.</blockquote>
<p><tt class="docutils literal">PROJECT_BINARY_DIR</tt></p>
<blockquote>
The absolute path to the base Project binary/build directory.  This is set
automatically by TriBITS and is the directory where <tt class="docutils literal">cmake</tt> is run from
and is set at the beginning of the <a class="reference internal" href="#id8">TRIBITS_PROJECT()</a> macro</blockquote>
<p><tt class="docutils literal">${PROJECT_NAME}_SOURCE_DIR</tt></p>
<blockquote>
Set to <tt class="docutils literal">${PROJECT_SOURCE_DIR}</tt> automatically by TriBITS at the beginning
of the <a class="reference internal" href="#id8">TRIBITS_PROJECT()</a> macro.</blockquote>
<p><tt class="docutils literal">${PROJECT_NAME}_BINARY_DIR</tt></p>
<blockquote>
Set to <tt class="docutils literal">${PROJECT_BINARY_DIR}</tt> automatically by TriBITS at the beginning
of the <a class="reference internal" href="#id8">TRIBITS_PROJECT()</a> macro.</blockquote>
<p><tt class="docutils literal">${PACKAGE_NAME}_ENABLE_TESTS</tt></p>
<blockquote>
CMake cache varaibles that if set to <tt class="docutils literal">ON</tt>, then tests for all explicitly
enabled packages will be turned on.</blockquote>
<p><tt class="docutils literal">${PACKAGE_NAME}_ENABLE_EXAMPLES</tt></p>
<blockquote>
CMake cache varaibles that if set to <tt class="docutils literal">ON</tt>, then examples for all
explicitly enabled packages will be turned on.</blockquote>
</blockquote>
<p>The following internal project-scope local CMake variables are defined by
TriBITS for the project's repositoreis.:</p>
<blockquote>
<p><tt class="docutils literal">${PROJECT_NAME}_NATIVE_REPOSITORIES</tt></p>
<blockquote>
The list of Native Repositories for a given TriBITS project
(i.e. Repositories that are always present when configuring the Project
and are managed in the same VC repo typically).  If the file
<tt class="docutils literal"><span class="pre">${PROJECT_SOURCE_DIR}/NativeRepositoriesList.cmake</span></tt> exists, then the
list of native repositories will be read from that file.  If the file
<tt class="docutils literal">NativeRepositoriesList.cmake</tt> does not exist, then the project is
assumed to also be a repository and the list of native repositories is
just the local project directory <tt class="docutils literal"><span class="pre">${PROJECT_SOURCE_DIR}/.</span></tt>.  In this
case, the <tt class="docutils literal">${PROJECT_SOURCE_DIR}/</tt> must contain at a minumum a
<tt class="docutils literal">PackagesList.cmake</tt>, and a <tt class="docutils literal">TPLsList.cmake</tt> file (see <a class="reference internal" href="#tribits-repository">TriBITS
Repository</a>).</blockquote>
<p><tt class="docutils literal">${PROJECT_NAME}_EXTRA_REPOSITORIES</tt></p>
<blockquote>
The list of Extra Repositories that the project is being configured with.
The packages in these repositories are <em>not</em> listed in the main project
dependency files but are listed in the dependenicy files in other
contexts.  This list of repositories either comes from the project's
<tt class="docutils literal">ExtraRepositoriesList.cmake</tt> file or comes from the CMake variables
${PROJECT_NAME}_EXTRA_REPOSITORIES.  See <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html#enabling-extra-repositories-with-add-on-packages">Enabling extra repositories
with add-on packages</a>
for details.</blockquote>
<p><tt class="docutils literal">${PROJECT_NAME}_ALL_REPOSITORIES</tt></p>
<blockquote>
Concatenation of all the repos listed in
<tt class="docutils literal">${PROJECT_NAME}_NATIVE_REPOSITORIES</tt> and
<tt class="docutils literal">${PROJECT_NAME}_EXTRA_REPOSITORIES</tt> in the order that the project is
being configured with.</blockquote>
</blockquote>
</div>
</div>
<div class="section" id="tribits-repository">
<h3><a class="toc-backref" href="#id21">TriBITS Repository</a></h3>
<p>A TriBITS Repository is the basic unit of ready-made composition between
different collections of software that use the TriBITS CMake build and system.</p>
<p>In short, a TriBITS Repository:</p>
<ul class="simple">
<li>Is a named collection of related TriBITS Packages and TPLs (defined in
<a class="reference internal" href="#repodir-packageslist-cmake">&lt;repoDir&gt;/PackagesList.cmake</a> and <a class="reference internal" href="#repodir-tplslist-cmake">&lt;repoDir&gt;/TPLsList.cmake</a>
respectively)</li>
<li>Defines the base source and binary directories for the Repository
<tt class="docutils literal">${REPOSITORY_NAME}_SORUCE_DIR</tt> and <tt class="docutils literal">${REPOSITORY_NAME}_BINARY_DIR</tt>.</li>
<li>[Optional] Defines a common set of initializations and other hooks for a all
the packages in the repository.</li>
</ul>
<p>For more details on the definition of a TriBITS Repository, see:</p>
<ul class="simple">
<li><a class="reference internal" href="#tribits-repository-core-files">TriBITS Repository Core Files</a></li>
<li><a class="reference internal" href="#tribits-repository-core-variables">TriBITS Repository Core Variables</a></li>
</ul>
<div class="section" id="tribits-repository-core-files">
<h4><a class="toc-backref" href="#id22">TriBITS Repository Core Files</a></h4>
<p>The core files making up a TriBITS Repository (where <tt class="docutils literal">&lt;reposDir&gt; =
<span class="pre">${${REPOSITORY_NAME}_SOURCE_DIR}</span></tt>) are:</p>
<pre class="literal-block">
&lt;repoDir&gt;/
  PackagesList.cmake
  TPLsList.cmake
  Copyright.txt  # [Optional] Only needed if creating version header file
  Version.cmake  # [Optional] Info inserted into ${REPO_NAME}_version.h
  cmake/
     RepositoryDependenciesSetup.cmake # [Optional]
     CallbackSetupExtraOptions.cmake # [Optional] Called after tribits options
     CallbackDefineRepositoryPackaging.cmake # [Optioinal] CPack packaging
</pre>
<p>These TriBITS Repository files are documented in more detail below:</p>
<ul class="simple">
<li><a class="reference internal" href="#repodir-packageslist-cmake">&lt;repoDir&gt;/PackagesList.cmake</a></li>
<li><a class="reference internal" href="#repodir-tplslist-cmake">&lt;repoDir&gt;/TPLsList.cmake</a></li>
<li><a class="reference internal" href="#repodir-copyright-txt">&lt;repoDir&gt;/Copyright.txt</a></li>
<li><a class="reference internal" href="#repodir-version-cmake">&lt;repoDir&gt;/Version.cmake</a></li>
<li><a class="reference internal" href="#repodir-cmake-repositorydependenciessetup-cmake">&lt;repoDir&gt;/cmake/RepositoryDependenciesSetup.cmake</a></li>
<li><a class="reference internal" href="#repodir-cmake-callbacksetupextraoptions-cmake">&lt;repoDir&gt;/cmake/CallbackSetupExtraOptions.cmake</a></li>
<li><a class="reference internal" href="#repodir-cmake-callbackdefinerepositorypackaging-cmake">&lt;repoDir&gt;/cmake/CallbackDefineRepositoryPackaging.cmake</a></li>
</ul>
<p id="repodir-packageslist-cmake"><strong>&lt;repoDir&gt;/PackagesList.cmake</strong>: [Required] Provides the list of top-level
packages defined by the repository.  This file typically just calls the macro
<a class="reference internal" href="#tribits-define-repository-packages">TRIBITS_DEFINE_REPOSITORY_PACKAGES()</a> to define the list of packages along
with their directories and other properties.  For example, the file
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">PackagesList.cmake</tt> looks like:</p>
<pre class="literal-block">
TRIBITS_DEFINE_REPOSITORY_PACKAGES(
  SimpleCxx               packages/simple_cxx                 PT
  MixedLanguage           packages/mixed_language             PT
  PackageWithSubpackages  packages/package_with_subpackages   PT
  WrapExternal            packages/wrap_external              PT
  )

TRIBITS_DISABLE_PACKAGE_ON_PLATFORMS(WrapExternal Windows)

</pre>
<p>Other comamnds that are appropriate to use this file are
<a class="reference internal" href="#tribits-disable-package-on-platforms">TRIBITS_DISABLE_PACKAGE_ON_PLATFORMS()</a>.  If the binary directory for any
package <tt class="docutils literal">&lt;packageName&gt;</tt> needs to be changed from the default, then the
variable <tt class="docutils literal">&lt;packageName&gt;_SPECIFIED_BINARY_DIR</tt> can be set.  One can see an
example of this in the file <tt class="docutils literal">tribits/PackageList.cmake</tt> which shows</p>
<pre class="literal-block">
TRIBITS_DEFINE_REPOSITORY_PACKAGES(
  TriBITS  .    PT
  )

# Must create subdir for binary dir for the TriBITS package
SET(TriBITS_SPECIFIED_BINARY_DIR tribits)

</pre>
<p>It is perfectly legal for a TriBITS repjository to define no packages at all
with:</p>
<pre class="literal-block">
TRIBITS_DEFINE_REPOSITORY_PACKAGES()
</pre>
<p>and this would be the case for a TribITS meta-project that has no native
packages, only extra repositories.  ToDo: Point to example meta-project.</p>
<p id="repodir-tplslist-cmake"><strong>&lt;repoDir&gt;/TPLsList.cmake</strong>: [Required] Provides the list of TPLs that are
listed as TPLs in the repository's SE packages
<a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a> files (see <cite>TriBITS TPL</cite>).  This file
typically just calls the macro <a class="reference internal" href="#tribits-define-repository-tpls">TRIBITS_DEFINE_REPOSITORY_TPLS()</a> to define
the TPLs along with their find modules and other properties.  See an example
from <a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">TPLsList.cmake</tt> which shows:</p>
<pre class="literal-block">
TRIBITS_DEFINE_REPOSITORY_TPLS(
  MPI  &quot;${${PROJECT_NAME}_TRIBITS_DIR}/tpls/FindTPLMPI.cmake&quot;   PT
  )

</pre>
<p>It is perfectly fine to specify no TPLs for a repository with:</p>
<pre class="literal-block">
TRIBITS_DEFINE_REPOSITORY_TPLS()
</pre>
<p>but the macro <tt class="docutils literal">TRIBITS_DEFINE_REPOSITORY_TPLS()</tt> has to be called, even if
there are no TPLs.  See <a class="reference internal" href="#tribits-define-repository-tpls">TRIBITS_DEFINE_REPOSITORY_TPLS()</a> for further
details.</p>
<p id="repodir-copyright-txt"><strong>&lt;repoDir&gt;/Copyright.txt</strong>: [Optional] Gives the default copyright and
license declaration for all of the software in the TriBITS repository
<tt class="docutils literal">&lt;repoDir&gt;</tt>.  This file is read into a string and then used to configure the
repository's version file (see <a class="reference internal" href="#project-and-repositiory-versioning-and-release-mode">Project and Repositiory Versioning and Release
Mode</a>).</p>
<p id="repodir-version-cmake"><strong>&lt;repoDir&gt;/Version.cmake</strong>: Contains version information for the repository
(and the project also if this is also the base project).  For example,
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">Version.cmake</tt>, this looks like:</p>
<pre class="literal-block">
SET(${REPOSITORY_NAME}_VERSION 1.1)
SET(${REPOSITORY_NAME}_MAJOR_VERSION 01)
SET(${REPOSITORY_NAME}_MAJOR_MINOR_VERSION 010100)
SET(${REPOSITORY_NAME}_VERSION_STRING &quot;1.1 (Dev)&quot;)
SET(${REPOSITORY_NAME}_ENABLE_DEVELOPMENT_MODE_DEFAULT ON) # Change to 'OFF' for a release

</pre>
<p>Note that the prefix <tt class="docutils literal">${REPOSITORY_NAME}_</tt> is used instead of hard-coding
the repository's name to allow flexibility in what a meta-project names a
given TriBITS repository.</p>
<p>The local variables in these set statements are processed in the base project
directory's local scope and are therefore seen by the entire CMake project.
When this file is read in repository mode, the variable
<tt class="docutils literal">${REPOSITORY_NAME}_ENABLE_DEVELOPMENT_MODE_DEFAULT</tt> is ignored.</p>
<p id="repodir-cmake-repositorydependenciessetup-cmake"><strong>&lt;repoDir&gt;/cmake/RepositoryDependenciesSetup.cmake</strong>: [Optional] If present,
this file is included a single time as part of the generation of the project
dependency data-structure (see ???).  It gets included at the top project
level scope in order with the other repositories listed in
<tt class="docutils literal">${PROJECT_NAME}_ALL_REPOSITORIES</tt>.  Any local variables set in this file
have project-wide scope.  The primary purpose for this file is to set
variables that will impact the processing of project's package's
<tt class="docutils literal">Dependencies.cmake</tt> files and take care of other enable/disable issues that
are not clearly handled by the TriBITS system automatically.</p>
<p>The typical usage of this file is to set the default CDash email base address
that will be the default for all of the defined packages (see <a class="reference internal" href="#cdash-regression-email-addresses">CDash
regression email addresses</a>).  For example, to set the default email address
for all of the packages in this repository, one would set in this file:</p>
<pre class="literal-block">
SET_DEFAULT(${REPOSITORY_NAME}_REPOSITORY_MASTER_EMAIL_ADDRESSS
    repox-regressions&#64;somemailserver.org)
</pre>
<p id="repodir-cmake-callbacksetupextraoptions-cmake"><strong>&lt;repoDir&gt;/cmake/CallbackSetupExtraOptions.cmake</strong>: [Optional] If defined,
this file is processed (included) for each repo in order right after the basic
TriBITS options are defined in the macro
<tt class="docutils literal">TRIBITS_DEFINE_GLOBAL_OPTIONS_AND_DEFINE_EXTRA_REPOS()</tt>.  This file must
define the macro <tt class="docutils literal">TRIBITS_REPOSITORY_SETUP_EXTRA_OPTIONS()</tt> which is then
called by the TriBITS system.  This file is only processed when doing a basic
configuration of the project and <strong>not</strong> when it is just building up the
dependency data-structures as part of other tools (like <tt class="docutils literal"><span class="pre">checkin-test.py</span></tt>,
<tt class="docutils literal">TribitsCTestDriverCore.cmake</tt>, etc.).  Any local variables set in this file
or macro have project-wide scope.</p>
<p>A few additional variables are defined by the time this file is procesed and
can be ued in the logic in these files.  The variables that should already be
defined, in addition to all of the basic user TriBITS cache variables, include
<tt class="docutils literal">CMAKE_HOST_SYSTEM_NAME</tt>, <tt class="docutils literal">${PROJECT_NAME}_HOSTNAME</tt>, and
<tt class="docutils literal">PYTHON_EXECUTABLE</tt>.  The types of logic to put in this file includes:</p>
<ul class="simple">
<li>Setting additional user cache variable options that are used by multiple
packages into the TriBITS Repository.  For example, Trilinos defines a
<tt class="docutils literal">Trilinos_DATA_DIR</tt> user cache varaible that several Trilinos packages
use.</li>
<li>Disabling packages in the TriBITS Repository when conditions will not allow
them to be enabled.  For example, Trilinos disables the package ForTrilinos
when Fortran is disabled and disables PyTrilinos when Python support is
disabled.</li>
</ul>
<p>An example of this file is:</p>
<blockquote>
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">/cmake/CallbackSetupExtraOptions.cmake</tt></blockquote>
<p>which currently looks like:</p>
<pre class="literal-block">
MACRO(TRIBITS_REPOSITORY_SETUP_EXTRA_OPTIONS)

  ASSERT_DEFINED(${PROJECT_NAME}_ENABLE_EXPORT_MAKEFILES)
  ASSERT_DEFINED(${PROJECT_NAME}_ENABLE_INSTALL_CMAKE_CONFIG_FILES)

  IF (${PROJECT_NAME}_ENABLE_EXPORT_MAKEFILES OR 
    ${PROJECT_NAME}_ENABLE_INSTALL_CMAKE_CONFIG_FILES
    )
    MESSAGE(
      &quot;\n***&quot;
      &quot;\n*** Warning: Setting ${PROJECT_NAME}_ENABLE_WrapExternal=OFF&quot;
      &quot; because ${PROJECT_NAME}_ENABLE_EXPORT_MAKEFILES or&quot;
      &quot; ${PROJECT_NAME}_ENABLE_INSTALL_CMAKE_CONFIG_FILES is on!&quot;
      &quot;\n***\n&quot;
      )
    SET(${PROJECT_NAME}_ENABLE_WrapExternal OFF)
  ENDIF()

ENDMACRO()

</pre>
<p id="repodir-cmake-callbackdefinerepositorypackaging-cmake"><strong>&lt;repoDir&gt;/cmake/CallbackDefineRepositoryPackaging.cmake</strong>: [Optional] If
this file exists, then this file defines extra CPack-related options that are
specific to the TriBITS Repository.  This file must define the macro
<tt class="docutils literal">TRIBITS_REPOSITORY_DEFINE_PACKAGING()</tt> which is called by TriBITS.  This
file is procdessed as the top project-level scope so any local variables set
have project-wide effect.  This file is processed before the project's
<a class="reference internal" href="#projectdir-cmake-callbackdefineprojectpackaging-cmake">&lt;projectDir&gt;/cmake/CallbackDefineProjectPackaging.cmake</a> so any options
defined in the repositories file are overridden by the project.  This file
typically this just involves setting extra excludes to remove files from the
tarball.  The file:</p>
<blockquote>
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">cmake/CallbackDefineRepositoryPackaging.cmake</tt></blockquote>
<p>provides a good example which is:</p>
<pre class="literal-block">
MACRO(TRIBITS_REPOSITORY_DEFINE_PACKAGING)

  ASSERT_DEFINED(${REPOSITORY_NAME}_SOURCE_DIR)
  APPEND_SET(CPACK_SOURCE_IGNORE_FILES
    &quot;${${REPOSITORY_NAME}_SOURCE_DIR}/cmake/ctest/&quot;
    )
  
ENDMACRO()

</pre>
</div>
<div class="section" id="tribits-repository-core-variables">
<h4><a class="toc-backref" href="#id23">TriBITS Repository Core Variables</a></h4>
<p>The following local variables are defined automatically by TriBITS before
processing a given TriBITS repositories files (e.g. <tt class="docutils literal">PackagesList.cmake</tt>,
<tt class="docutils literal">TPLsList.cmake</tt>, etc.):</p>
<blockquote>
<p><tt class="docutils literal">REPOSITORY_NAME</tt></p>
<blockquote>
The name of the current TriBITS repository.</blockquote>
<p><tt class="docutils literal">REPOSITORY_DIR</tt></p>
<blockquote>
Path of the current Repository relative to the Project directory.  This is
typically just the repository name but can be an arbitrary directory if
specified through a <tt class="docutils literal">ExtraRepositoriesList.cmake</tt> file.</blockquote>
</blockquote>
<p>The following base project-scope local variables are available once the list
of TriBITS repositories are defined:</p>
<blockquote>
<p><tt class="docutils literal">${REPOSITORY_NAME}_SOURCE_DIR</tt></p>
<blockquote>
The absolute path to the base of a given Repository source directory.
CMake code, for example in a packages's <tt class="docutils literal">CMakeLists.txt</tt> file, typically
refers to this by the raw name like <tt class="docutils literal">RepoX_SOURCE_DIR</tt>.  This makes such
CMake code independent of where the various TriBITS repos are in relation
to each other or the Project.</blockquote>
<p><tt class="docutils literal">${REPOSITORY_NAME}_BINARY_DIR</tt></p>
<blockquote>
The absolute path to the base of a given Repository binary directory.
CMake code, for example in packages, refer to this by the raw name like
<tt class="docutils literal">RepoX_SOURCE_DIR</tt>.  This makes such CMake code independent of where the
various TriBITS repos are in relation to each other or the Project.</blockquote>
</blockquote>
</div>
</div>
<div class="section" id="tribits-package">
<h3><a class="toc-backref" href="#id24">TriBITS Package</a></h3>
<p>A TriBITS Package:</p>
<ul class="simple">
<li>Typically defines a set of libraries and/or header files and/or executables
and/or tests with CMake build targets for building these and exports the
list of include directories, libraries, and targets that are created (along
with CMake dependencies).</li>
<li>Is declared in its parent repository's <a class="reference internal" href="#repodir-packageslist-cmake">&lt;repoDir&gt;/PackagesList.cmake</a> file.</li>
<li>Defines dependencies on upstream TPLs and/or other SE packages by just
naming the dependencies in the file
<a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a>..</li>
<li>Can optionally have subpackages listed in the argument
<tt class="docutils literal">SUBPACKAGES_DIRS_CLASSIFICATIONS_OPTREQS</tt> to
<a class="reference internal" href="#tribits-define-package-dependencies">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a>.</li>
<li>Is the fundamental unit of software partitioning and aggregation and must
have a unique packae name that is globally unique, not only within its
defined repository, but cross all possible repositories that might be
coupled together some day using TriBITS.</li>
<li>Is the unit of testing as drived by <tt class="docutils literal">TribitsCTestDriverCore.cmake</tt> and
displayed on CDash.</li>
</ul>
<p><strong>WARNING:</strong> As noted above, one must be very careful to pick package names
that will be globally unique</p>
<p>For more details on the definition of a TriBITS Package (or subpackage), see:</p>
<ul class="simple">
<li><a class="reference internal" href="#tribits-package-core-files">TriBITS Package Core Files</a></li>
<li><a class="reference internal" href="#tribits-package-core-variables">TriBITS Package Core Variables</a></li>
</ul>
<div class="section" id="tribits-package-core-files">
<h4><a class="toc-backref" href="#id25">TriBITS Package Core Files</a></h4>
<p>The core files that make up TriBITS Package (where <tt class="docutils literal">&lt;packageDir&gt; =
<span class="pre">${${PACKAGE_NAME}_SOURCE_DIR}</span></tt>) are:</p>
<pre class="literal-block">
&lt;packageDir&gt;/
  CMakeLists.txt  # Only processed if the package is enabled
  cmake/
    Dependencies.cmake  # Always processed if the package is listed in the
                         # enclosing Repository
</pre>
<p><strong>NOTE:</strong> Before a TriBITS Package's files are described in more detail, it is
important to note that all of the package's files that define its behavior and
tests should strictly be contained under the package's base source directory
<tt class="docutils literal">&lt;packageDir&gt;/</tt> if at all possible.  While this is not a requirement for the
basic TriBITS build system, the approach for automatically detecting when a
package has changed by looking at what files have changed (which is used in
<tt class="docutils literal"><span class="pre">checkin-test.py</span></tt> and <tt class="docutils literal">TribitsCTestDriverCore.cmake</tt>) requires that the
package's files be listed under <tt class="docutils literal">&lt;packageDir&gt;/</tt> (see <a class="reference internal" href="#pre-push-testing-using-checkin-test-py">Pre-push Testing using
checkin-test.py</a>).  Without this, these development tetsing tools will not be
able to effectively determine what needs to be rebuilt and retested which can
clean to pushing broken software.</p>
<p>These TriBITS Package files are documented in more detail below:</p>
<ul class="simple">
<li><a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a></li>
<li><a class="reference internal" href="#packagedir-cmakelists-txt">&lt;packageDir&gt;/CMakeLists.txt</a></li>
</ul>
<p id="packagedir-cmake-dependencies-cmake"><strong>&lt;packageDir&gt;/cmake/Dependencies.cmake</strong>: [Required] Defines the dependencies
of a given SE package using the macro
<a class="reference internal" href="#tribits-define-package-dependencies">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a>.  This file is processed at the
top-level project scope (using an <tt class="docutils literal">INCLUDE()</tt>) so any local variables set
will be seen by the entire project.  This file is always processed, including
when just building the project's <a class="reference internal" href="#project-packagedependencies-xml">&lt;Project&gt;PackageDependencies.xml</a> file.</p>
<p>An example of a <tt class="docutils literal">Dependencies.cmake</tt> file for a package with optional and
required dependencies is for the mock <tt class="docutils literal">Panzer</tt> package in <a class="reference internal" href="#mocktrilinos">MockTrilinos</a>:</p>
<pre class="literal-block">
TRIBITS_DEFINE_PACKAGE_DEPENDENCIES(
  LIB_REQUIRED_PACKAGES Teuchos Sacado Phalanx Intrepid Thyra
    Tpetra Epetra EpetraExt
  LIB_OPTIONAL_PACKAGES Stokhos
  TEST_OPTIONAL_PACKAGES Stratimikos
  LIB_REQUIRED_TPLS MPI Boost
  )

</pre>
<p>An example of a package with subpackages is <tt class="docutils literal">PackageWithSubpackages</tt> in
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a> with the <tt class="docutils literal">Dependencies.cmake</tt> file:</p>
<pre class="literal-block" id="package-with-subpackages-cmake-dependencies-cmake">
TRIBITS_DEFINE_PACKAGE_DEPENDENCIES(
  SUBPACKAGES_DIRS_CLASSIFICATIONS_OPTREQS
    SubpackageA   A   PT  REQUIRED
    SubpackageB   B   PT  REQUIRED
    SubpackageC   C   PT  REQUIRED
  )

</pre>
<p>The last case defines three subpackages which creates three new SE packages
with names <tt class="docutils literal">PackageWithSubpackagesSubpackageA</tt>,
<tt class="docutils literal">PackageWithSubpackagesSubpackageB</tt>, and
<tt class="docutils literal">PackageWithSubpackagesSubpackageC</tt>.</p>
<p id="packagedir-cmakelists-txt"><strong>&lt;packageDir&gt;/CMakeLists.txt</strong>: [Required] The package's top-level
<tt class="docutils literal">CMakeLists.txt</tt> file that defines the libraries, include directories, and
contains the tests for the package.</p>
<p>The basic structure of this file for a <strong>package without subpackages</strong> is
shown in:</p>
<blockquote>
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">packages/simple_cxx/CMakeLists.txt</tt></blockquote>
<p>which is:</p>
<pre class="literal-block">
#
# A) Define the package
#
TRIBITS_PACKAGE( SimpleCxx  ENABLE_SHADOWING_WARNINGS  CLEANED )

#
# B) Platform-specific checks
#
INCLUDE(CheckFor__int64)
CHECK_FOR___INT64(HAVE_SIMPLECXX___INT64)

#
# C) Set up package-specific options
#
TRIBITS_ADD_DEBUG_OPTION()
TRIBITS_ADD_SHOW_DEPRECATED_WARNINGS_OPTION()

#
# D) Add the libraries, tests, and examples
#
ADD_SUBDIRECTORY(src)
TRIBITS_ADD_TEST_DIRECTORIES(test)
#TRIBITS_ADD_EXAMPLE_DIRECTORIES(example)

#
# E) Do standard postprocessing
#
TRIBITS_PACKAGE_POSTPROCESS()

</pre>
<p>The first command at the top of the file in <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a> where the
package name is passed in in addition to a few other options.  TriBITS
obviously already knows the package name.  The purpose for repeating it is as
documentation for the developer's sake.  Then a set of platform confgiure-time
tests is typically performed (if there are any).  In this example, the
existance of the C++ <tt class="docutils literal">__int64</tt> data-type is checked using the module
<cite>CheckFor__int64.cmake`</cite> (which is in the <tt class="docutils literal">cmake/</tt> directory of this
package.  (CMake has great support for configure-time tests, see
<a class="reference internal" href="#configure-time-system-tests">Configure-time System Tests</a>.)  This is followed by package-specific
options.  In this case, the standard TriBITS options for debug checking and
deprecated warnings are added using the standard macros
<a class="reference internal" href="#tribits-add-debug-option">TRIBITS_ADD_DEBUG_OPTION()</a> and
<a class="reference internal" href="#tribits-add-show-deprecated-warnings-option">TRIBITS_ADD_SHOW_DEPRECATED_WARNINGS_OPTION()</a>.  After all of this up front
stuff (which will be present in any moderately complex CMake-configured
project) the source and the test subdirectories are added that actually define
the library and the tests.  In this case, the standard
<a class="reference internal" href="#tribits-add-test-directories">TRIBITS_ADD_TEST_DIRECTORIES()</a> macro is used which only conditionally adds
the tests for the package.</p>
<p>The final command in the package's <tt class="docutils literal">CMakeLists.txt</tt> file must always be
<a class="reference internal" href="#tribits-package-postprocess">TRIBITS_PACKAGE_POSTPROCESS()</a>.  This is needed in order to perform some
necessary post-processing by TriBITS.</p>
<p>It is also possible to for the package's top-level <tt class="docutils literal">CMakeLists.txt</tt> to be
the only such file in a package.  Such an example can be see in the example
project <cite>TribitsHelloWorld</cite>.</p>
<p>When a TriBITS package is broken up into subpackages (see <a class="reference internal" href="#tribits-subpackage">TriBITS
Subpackage</a>), its <tt class="docutils literal">CMakeLists.txt</tt> file looks a little different.  The
basic structure of this file for a <strong>package with subpackages</strong> is shown in:</p>
<blockquote>
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">packages/package_with_subpackages/CMakeLists.txt</tt></blockquote>
<p>which contains:</p>
<pre class="literal-block">
#
# A) Forward declare the package so that certain options are also defined for
# subpackages
#
TRIBITS_PACKAGE_DECL(PackageWithSubpackages)

#
# B) Define the common options for the package first so they can be used by
# subpackages as well.
#
TRIBITS_ADD_DEBUG_OPTION()

#
# C) Process the subpackages
#
TRIBITS_PROCESS_SUBPACKAGES()

#
# D) Define the package now and perform standard postprocessing
#
TRIBITS_PACKAGE_DEF()
TRIBITS_PACKAGE_POSTPROCESS()

</pre>
<p>What is different about <tt class="docutils literal">CMakeLists.txt</tt> files for packages without
subpackages is that the <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a> command is broken up into two
parts <a class="reference internal" href="#tribits-package-decl">TRIBITS_PACKAGE_DECL()</a> and <a class="reference internal" href="#tribits-package-def">TRIBITS_PACKAGE_DEF()</a>.  In between
these two comamnds, the parent package can define the common package options
and then calls the commnand <a class="reference internal" href="#tribits-process-subpackages">TRIBITS_PROCESS_SUBPACKAGES()</a> which fully
processes the packages.  If the parent package has libraries and/or
tests/example of its own, it can define those after calling
<a class="reference internal" href="#tribits-package-def">TRIBITS_PACKAGE_DEF()</a>, just like with a regular package.  However, it is
rare for a package broken up into subpackages to have its own libraries and/or
tests and examples.  As always, the final command called inside of the
<tt class="docutils literal">CMakeLists.txt</tt> is <a class="reference internal" href="#tribits-package-postprocess">TRIBITS_PACKAGE_POSTPROCESS()</a>.</p>
</div>
<div class="section" id="tribits-package-core-variables">
<h4><a class="toc-backref" href="#id26">TriBITS Package Core Variables</a></h4>
<p>The following locally scoped varaibles are defined when the files for a given
TriBITS Package (or any SE packaeg for that matter) are being processed:</p>
<blockquote>
<p><tt class="docutils literal">PACKAGE_NAME</tt></p>
<blockquote>
The name of the current TriBITS SE package.  This is set automatically by
TriBITS before the packages's <tt class="docutils literal">CMakeLists.txt</tt> file is processed.
<strong>WARNING:</strong> The TriBITS packae name must be globally unique cross all
possible repositories that might be coupled together at some point using
TriBITS!</blockquote>
<p><tt class="docutils literal">PACKAGE_SOURCE_DIR</tt></p>
<blockquote>
The absolute path to the base package's base source directory.  This is
set automatically by TriBITS in the macro <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a>.</blockquote>
<p><tt class="docutils literal">PACKAGE_BINARY_DIR</tt></p>
<blockquote>
The absolute path to the base package's base binary/build directory.  This
is set automatically by TriBITS in the macro <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a>.</blockquote>
<p><tt class="docutils literal">PACKAGE_NAME_UC</tt></p>
<blockquote>
This is set to the upper-case versionof <tt class="docutils literal">${PACKAGE_NAME}</tt>.  This is set
automatically by TriBITS in the macro <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a>.</blockquote>
</blockquote>
<p>Once all of the TriBITS SE package's <tt class="docutils literal">Dependencies.cmake</tt> files have been
processed, the following top-level (non-cache) local varaibles are defined:</p>
<blockquote>
<p><tt class="docutils literal">${PACKAGE_NAME}_SOURCE_DIR</tt></p>
<blockquote>
The absolute path to the base of a given package's source directory.
CMake code, for example in other packages, refer to this by the raw name
like <tt class="docutils literal">PackageX_SOURCE_DIR</tt>.  This makes such CMake code independent of
where the package is in relation to other packages.  This variable is
defined for all processed packages, independent of whether they are
enabled.</blockquote>
<p><tt class="docutils literal">${PACKAGE_NAME}_BINARY_DIR</tt></p>
<blockquote>
The absolute path to the base of a given package's binary directory.
CMake code, for example in other packages, refer to this by the raw name
like <tt class="docutils literal">PackageX_BINARY_DIR</tt>.  This makes such CMake code independent of
where the package is in relation to other packages.  This variable is only
defined if the package is enabled.</blockquote>
<p><tt class="docutils literal">${PACKAGE_NAME}_PARENT_REPOSITORY</tt></p>
<blockquote>
The name of the package's parent repository.  This can be used by a
package to access information about its parent repository.  For example,
the variable <tt class="docutils literal"><span class="pre">${${PACKAGE_NAME}_PARENT_REPOSITORY}_SOURCE_DIR</span></tt> can be
dereferenced.</blockquote>
</blockquote>
<p>In addition, the following user-settable cache varibles are defined before an
SE Package's <tt class="docutils literal">CMakeLists.txt</tt> file is processed:</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">${PROJECT_NAME}_ENABLE_${PACKAGE_NAME}</span></tt></p>
<blockquote>
Set to <tt class="docutils literal">ON</tt> if the package is to be enabled.</blockquote>
<p><tt class="docutils literal">${PACKAGE_NAME}_ENABLE_TESTS</tt></p>
<blockquote>
Set to <tt class="docutils literal">ON</tt> if the package's tests are to be enabled.  This will enable
a package's tests and all of its subpackage's tests.</blockquote>
<p><tt class="docutils literal">${PACKAGE_NAME}_ENABLE_EXAMPLES</tt></p>
<blockquote>
Set to <tt class="docutils literal">ON</tt> if the package's examples are to be enabled.  This will
enable a package's examples and all of its subpackage's examples.</blockquote>
</blockquote>
<p>The above varaibles can be set by the user or may be set automatically as part
of the <a class="reference internal" href="#package-dependencies-and-enable-disable-logic">Package Dependencies and Enable/Disable Logic</a>.</p>
<p>Currently, a Package can refer to its containing Repository and refer to its
source and binary directories.  This is so that it can refer to
repository-level resources (e.g. like the <tt class="docutils literal">Trilinos_version.h</tt> file for
Trilinos packages).  This may be undesirable because it will make it very hard
to pull a package out of one Repository and place it in another repository for
a different use.  However, a package can indirectly refer to its own
repository without concern for what it is call by reading the variable
<tt class="docutils literal">${PACKAGE_NAME}_PARENT_REPOSITORY</tt>.</p>
</div>
</div>
<div class="section" id="tribits-subpackage">
<h3><a class="toc-backref" href="#id27">TriBITS Subpackage</a></h3>
<p>A TriBITS Subpackage:</p>
<ul class="simple">
<li>Typically defines a set of libraries and/or header files and/or executables
and/or tests with CMake build targets for building these and exports the
list of include directories, libraries, and targets that are created (along
with CMake dependencies).</li>
<li>Is declared in its parent packages's
<a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a> file in a call to
<a class="reference internal" href="#tribits-define-package-dependencies">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a> using the argument
<tt class="docutils literal">SUBPACKAGES_DIRS_CLASSIFICATIONS_OPTREQS</tt>.</li>
<li>Defines dependencies on upstream TPLs and/or other SE packages by just
naming the dependencies in the file <tt class="docutils literal">cmake/Dependencies.cmake</tt> using the
macro <a class="reference internal" href="#tribits-define-package-dependencies">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a>.</li>
<li>Can <strong>NOT</strong> have its own subpackages defined (only top-level packages can
have subpackages).</li>
<li>Is enabled or disabled along with all other subpackages in the parent
package automatically if it's parent package is enabled or disabled with
<tt class="docutils literal"><span class="pre">${PROJECT_NAME}_ENABLE_${PARENT_PACKAGE_NAME}</span></tt> set to <tt class="docutils literal">ON</tt> or <tt class="docutils literal">OFF</tt>
respectively.</li>
<li>Has tests turned on automatically if
<tt class="docutils literal"><span class="pre">${PARENT_PACKAGE_NAME}_ENABLE_TESTS==ON</span></tt>.</li>
</ul>
<p>The contents of a TriBITS Subpackage are almost idential to those of a TriBITS
Package.  The differences are described below.</p>
<p>For more details on the definition of a TriBITS Package (or subpackage), see:</p>
<ul class="simple">
<li><a class="reference internal" href="#tribits-subpackage-core-files">TriBITS Subpackage Core Files</a></li>
<li><a class="reference internal" href="#tribits-subpackage-core-variables">TriBITS Subpackage Core Variables</a></li>
</ul>
<div class="section" id="tribits-subpackage-core-files">
<h4><a class="toc-backref" href="#id28">TriBITS Subpackage Core Files</a></h4>
<p>The set of core files for a subpackage are identical to the <a class="reference internal" href="#tribits-package-core-files">TriBITS Package
Core Files</a>.  The core files that make up a TriBITS Subpackage (where
<tt class="docutils literal">&lt;packageDir&gt; = <span class="pre">${${PARENT_PACKAGE_NAME}_SOURCE_DIR}</span></tt> and <tt class="docutils literal">&lt;spkgDir&gt;</tt> is
the subpackage directory listed in the
<tt class="docutils literal">SUBPACKAGES_DIRS_CLASSIFICATIONS_OPTREQS</tt> to
<a class="reference internal" href="#tribits-define-package-dependencies">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a>) are:</p>
<pre class="literal-block">
&lt;packageDir&gt;/&lt;spkgDir&gt;/
  CMakeLists.txt  # Only processed if this subpackage is enabled
  cmake/
    Dependencies.cmake  # Always processed if the parent package
                          # is listed in the enclosing Repository
</pre>
<p>These TriBITS Subpackage files are documented in more detail below:</p>
<ul class="simple">
<li><a class="reference internal" href="#packagedir-spkgdir-cmake-dependencies-cmake">&lt;packageDir&gt;/&lt;spkgDir&gt;/cmake/Dependencies.cmake</a></li>
<li><a class="reference internal" href="#packagedir-spkgdir-cmakelists-txt">&lt;packageDir&gt;/&lt;spkgDir&gt;/CMakeLists.txt</a></li>
<li><a class="reference internal" href="#how-is-tribits-subpackage-is-different-from-a-tribits-package">How is TriBITS Subpackage is different from a TriBITS Package?</a></li>
</ul>
<p id="packagedir-spkgdir-cmake-dependencies-cmake"><strong>&lt;packageDir&gt;/&lt;spkgDir&gt;/cmake/Dependencies.cmake</strong>: The contents of this file
for subpackages is idential as for top-level packages.  It just contains a
call to the macro <a class="reference internal" href="#tribits-define-package-dependencies">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a> to define this SE
package's upstream TPL and SE package dependencies.  A simple example is for
<tt class="docutils literal">SubpackageB</tt> declared in
<a class="reference internal" href="#package-with-subpackages-cmake-dependencies-cmake">package_with_subpackages/cmake/Dependencies.cmake</a> shown shown in:</p>
<blockquote>
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">packages/package_with_subpackages/B/cmake/Dependneices.cmake</tt></blockquote>
<p>which is:</p>
<pre class="literal-block">
TRIBITS_DEFINE_PACKAGE_DEPENDENCIES(
  LIB_REQUIRED_PACKAGES PackageWithSubpackagesSubpackageA
  )

</pre>
<p>What this shows is that subpackages must list their dependenices on each other
(if such dependencies exist) using the full SE package name
<tt class="docutils literal"><span class="pre">${PARENT_PACKAGE_NAME}${SUBPACKGE_NAME}</span></tt> or in this case
<tt class="docutils literal">PackageWithSubpackages</tt> + <tt class="docutils literal">SubpackageA</tt> =
<tt class="docutils literal">PackageWithSubpackagesSubpackageA</tt>.</p>
<p>Note that the parent SE package depends on its subpackages, not the other way
around.  For example, the <tt class="docutils literal">PackageWithSubpackages</tt> parent SE package depends
its SE subpackages <tt class="docutils literal">PackageWithSubpackagesSubpackageA</tt>,
<tt class="docutils literal">PackageWithSubpackagesSubpackageC</tt>, and
<tt class="docutils literal">PackageWithSubpackagesSubpackageC</tt>.  As such all (direct) dependencies for
a subpackage must be listed in its own <tt class="docutils literal">Dependencies.cmake</tt> file.  For
example, the <tt class="docutils literal">PackageWithSubpackages</tt> subpackage <tt class="docutils literal">SubpackageA</tt> depends on
the <tt class="docutils literal">SimpleCxx</tt> package and is declared as such as shown in:</p>
<blockquote>
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">packages/package_with_subpackages/A/cmake/Dependneices.cmake</tt></blockquote>
<p>which is:</p>
<pre class="literal-block">
TRIBITS_DEFINE_PACKAGE_DEPENDENCIES(
  LIB_REQUIRED_PACKAGES SimpleCxx
  )

</pre>
<p>What this means is that any TPL or library depencenices listed in the parent
package's <a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a> file are <strong>NOT</strong>
dependencies of its subpackages.  For example, if
<a class="reference internal" href="#package-with-subpackages-cmake-dependencies-cmake">package_with_subpackages/cmake/Dependencies.cmake</a> where changed to be:</p>
<pre class="literal-block">
TRIBITS_DEFINE_PACKAGE_DEPENDENCIES(
  LIB_REQUIRED_TPLS Boost
  SUBPACKAGES_DIRS_CLASSIFICATIONS_OPTREQS
    SubpackageA   A   PT  REQUIRED
    ...
  )
</pre>
<p>then the <tt class="docutils literal">Boost</tt> TPL would <strong>NOT</strong> be a dependency of the SE package
<tt class="docutils literal">PackageWithSubpackagesSubpackageA</tt> but instead would be listed as a
dependency of the parent SE package <tt class="docutils literal">PackageWithSubpackages</tt>.  (And in this
case, this TPL dependency is pretty worthless since the SE package
<tt class="docutils literal">PackageWithSubpackages</tt> does not even define any libraries or tests of its
own.)</p>
<p id="packagedir-spkgdir-cmakelists-txt"><strong>&lt;packageDir&gt;/&lt;spkgDir&gt;/CMakeLists.txt</strong>: [Required] The subpackage's
top-level <tt class="docutils literal">CMakeLists.txt</tt> file that defines the libraries, include
directoies, and contains the tests for the subpackage.  The contents of a
subpackage's top-level <tt class="docutils literal">CMakeLists.txt</tt> is almost indentical to a top-level
package's <a class="reference internal" href="#packagedir-cmakelists-txt">&lt;packageDir&gt;/CMakeLists.txt</a> file.  The primary difference is that
the commmands <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a> and <a class="reference internal" href="#tribits-package-postprocess">TRIBITS_PACKAGE_POSTPROCESS()</a> and
replaced with <a class="reference internal" href="#id9">TRIBITS_SUBPACKAGE()</a> and <a class="reference internal" href="#tribits-subpackage-postprocess">TRIBITS_SUBPACKAGE_POSTPROCESS()</a>
as shown in the file:</p>
<blockquote>
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>/<tt class="docutils literal">packages/package_with_subpackages/A/CMakeLists.txt</tt></blockquote>
<p>which contains:</p>
<pre class="literal-block">
#
# A) Define the subpackage
#
TRIBITS_SUBPACKAGE(SubpackageA)

#
# B) Set up subpackage-specific options
#
# Typically there are none or are few as must are picked up from the parent
# package's CMakeLists.txt file!

#
# C) Add the libraries, tests, and examples
#

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})
TRIBITS_ADD_LIBRARY(pws_a
  SOURCES A.cpp
  HEADERS A.hpp
  NOINSTALLHEADERS 
)

TRIBITS_ADD_TEST_DIRECTORIES(tests)

#
# D) Do standard postprocessing
#
TRIBITS_SUBPACKAGE_POSTPROCESS()

</pre>
<p>Unlike <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a>, <a class="reference internal" href="#id9">TRIBITS_SUBPACKAGE()</a> does not take any extra
arguments.  Those extra settings are assumed to be defined by the top-level
parent package.  Like top-level packages, subpackages are free to define
user-setable options and configure-time tests but typically don't.  The idea
is that subpackages should be lighter weight than top-level packages.  OTher
than using <a class="reference internal" href="#id9">TRIBITS_SUBPACKAGE()</a> and <a class="reference internal" href="#tribits-subpackage-postprocess">TRIBITS_SUBPACKAGE_POSTPROCESS()</a>, a
subpackage can be layed out just like any other package and can call on any
other commands to add libraries, add executables, add test, etc.</p>
</div>
<div class="section" id="tribits-subpackage-core-variables">
<h4><a class="toc-backref" href="#id29">TriBITS Subpackage Core Variables</a></h4>
<p>The core varaibles assoicated with a subpackage are identicial to the <a class="reference internal" href="#tribits-package-core-variables">TriBITS
Package Core Variables</a>.  The only difference is that a subpackage may need
to refer to its parent package where a top-level package does not have a
parent package.  The extra varaibles that are defined when processing a
subpackages files are:</p>
<blockquote>
<p><tt class="docutils literal">PARENT_PACKAGE_NAME</tt></p>
<blockquote>
The name of the parent package.</blockquote>
<p><tt class="docutils literal">PARENT_PACKAGE_SOURCE_DIR</tt></p>
<blockquote>
The absolute path to the parent package's source directory.  This this
only defined for a subpackage.</blockquote>
<p><tt class="docutils literal">PARENT_PACKAGE_BINARY_DIR</tt></p>
<blockquote>
The absolute path to the parent package's binary directory.  This this
only defined for a subpackage.</blockquote>
</blockquote>
</div>
<div class="section" id="how-is-tribits-subpackage-is-different-from-a-tribits-package">
<h4><a class="toc-backref" href="#id30">How is TriBITS Subpackage is different from a TriBITS Package?</a></h4>
<p>A common question this is natural to ask is how a TriBITS Subpackage is
different from a TriBITS Package?  They contain the same basic files (i.e. a
<tt class="docutils literal">cmake/Dependencies.cmake</tt>, a top-level <tt class="docutils literal">CMakeList.txt</tt> file, source
files, test files, etc.).  They both are included in the list of TriBITS SE
Packages and therefore can both be enabled/disabled by the user or in
automatica dependnecy logic.  The primary difference is that a subpackage is
meant to involve less overhead in defining and is to be used to partition the
parent package's software into chunks according to software engineering
packaging principles.  Also, the dependency logic treats a parent package's
subpackages as part of itself so when the parent package is explicitly enabled
or disabled, it is identical to explicitly enabling or disabling all of its
subpackages.  Other differences and issues between packages as subpackages are
discussed throughout this guide.</p>
<!-- ToDo: List out the basic SE packaging design principles from "Agile
Software Design". -->
<!-- ToDo: Finish this section! -->
</div>
</div>
<div class="section" id="tribits-tpl">
<h3><a class="toc-backref" href="#id31">TriBITS TPL</a></h3>
<p>A TriBITS TPL:</p>
<ul class="simple">
<li>Defines a set of pre-built libraries and/or header files and/or executables
and/or some other resoruces used by one or more TriBITS Packages.</li>
<li>Is listed as an explicit optional or required dependency in one or more
TriBiTS SE package's <tt class="docutils literal">Dependencies.cmake</tt> files using the macro
<a class="reference internal" href="#tribits-define-package-dependencies">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a>.</li>
<li>Publishes the include directories and/or libraries and/or executables
provided by the TPL.</li>
</ul>
<p>Using a TriBITS TPL is to be preferred over using a raw CMake
<tt class="docutils literal"><span class="pre">FIND_PACKAGE(&lt;someCMakePackage&gt;)</span></tt> because the TriBITS system guarantees
that only a single unique version of TPL will be used by multiple packages and
by declaring a TPL using TriBITS, automatical enable/disable logic will be
applied as described in <a class="reference internal" href="#package-dependencies-and-enable-disable-logic">Package Dependencies and Enable/Disable Logic</a>.</p>
<p>For each TPL referenced in a <tt class="docutils literal">TPLsList.cmake</tt> file using the macro
<a class="reference internal" href="#tribits-define-repository-tpls">TRIBITS_DEFINE_REPOSITORY_TPLS()</a>, there should exist a file, typically
called <tt class="docutils literal"><span class="pre">FindTPL${TPL_NAME}.cmake</span></tt>, that once processed, produces the
variables <tt class="docutils literal">${TPL_NAME}_LIBRARIES</tt> and <tt class="docutils literal">${TPL_NAME}_INCLUDE_DIRS</tt>.  Most
<tt class="docutils literal"><span class="pre">FindTPL${TPL_NAME}.cmake</span></tt> files just use the the function
<a class="reference internal" href="#tribits-tpl-declare-libraries">TRIBITS_TPL_DECLARE_LIBRARIES()</a> the define the TriBITS TPL.  A simple
example of such a file is the standard <tt class="docutils literal">FindTPLPETSC.cmake</tt> module which is:</p>
<pre class="literal-block">
INCLUDE(TribitsTplDeclareLibraries)

TRIBITS_TPL_DECLARE_LIBRARIES( PETSC
  REQUIRED_HEADERS petsc.h
  REQUIRED_LIBS_NAMES petsc 
  )

</pre>
<p>Some concrete <tt class="docutils literal"><span class="pre">FindTPL${TPL_NAME}.cmake</span></tt> files actually do use
<tt class="docutils literal">FIND_PACKAGE()</tt> and a standard CMake package find modulue to fill in the
guts of finding at TPL.</p>
<p>Note that the TriBITS system does not require the usage of of the function
<a class="reference internal" href="#tribits-tpl-declare-libraries">TRIBITS_TPL_DECLARE_LIBRARIES()</a> and does not even care about the TPL module
name <tt class="docutils literal"><span class="pre">FindTPL${TPL_NAME}.cmake</span></tt>.  All that is required is that some CMake
file fragment exist that once included, will define the varaibles
<tt class="docutils literal">${TPL_NAME}_LIBRARIES</tt> and <tt class="docutils literal">${TPL_NAME}_INCLUDE_DIRS</tt>.  However, to be
user friendly, such a CMake file should respond to the same variables as
accepted by the standard <a class="reference internal" href="#tribits-tpl-declare-libraries">TRIBITS_TPL_DECLARE_LIBRARIES()</a> funtion.</p>
<p>The only core variables related to an enabled TPL <tt class="docutils literal">${TPL_NAME}_LIBRARIES</tt>
and <tt class="docutils literal">${TPL_NAME}_INCLUDE_DIRS</tt> as defined in
<a class="reference internal" href="#tribits-tpl-declare-libraries">TRIBITS_TPL_DECLARE_LIBRARIES()</a> need to be defined.  For more details, see
<a class="reference internal" href="#tribits-define-repository-tpls">TRIBITS_DEFINE_REPOSITORY_TPLS()</a>.</p>
</div>
</div>
<div class="section" id="processing-of-tribits-files-ordering-and-details">
<h2><a class="toc-backref" href="#id32">3.2&nbsp;&nbsp;&nbsp;Processing of TriBITS Files: Ordering and Details</a></h2>
<p>One of the most important things to know about TriBITS is what files it
processes, in what order, and in what context.  This is critical to being able
to understand what impact (if any) setting a variable or otherwise changing
the CMake runtime state will have on configuring a CMake project which uses
TriBITS.  While the different files that make up a TriBITS Project, TriBITS
Repository, TriBITS Package, and TriBITS TPL were defined in the section
<a class="reference internal" href="#tribits-project-structure">TriBITS Project Structure</a>, is was not fully described in what context and
what order these files are processed by the TriBITS framework as driven from
inside of the <a class="reference internal" href="#id8">TRIBITS_PROJECT()</a> macro.</p>
<p>The TriBITS system processes the project's files in one of two contexts.  The
first context is in the basic configuration of the project with a standard
<tt class="docutils literal">cmake</tt> command invocation in order to set up the build files in the binary
directory.  The second context is in reading the project's dependency-related
files in order to build a package dependency datastructure (e.g. the
<a class="reference internal" href="#project-packagedependencies-xml">&lt;Project&gt;PackageDependencies.xml</a> file).  The second task of reading the
project's dependency files is largely a subset of the first which invloves
configuring the entire project.</p>
<p>Another factor that is important to understand is the scoping in which the
various files are processed.  This scoping has a large impact on the
configuration of the project and what effect the processing of files and
setting varaibles have on the project as a whole.  Some of the strange scoping
rules for CMake are discussed in <a class="reference internal" href="#cmake-language-overview-and-gotchas">CMake Language Overview and Gotchas</a>.  Many
of the basic files are processed in the base project
<a class="reference internal" href="#projectdir-cmakelists-txt">&lt;projectDir&gt;/CMakeLists.txt</a> scope and therefore any local variables set are
accessible to the entire CMake project.  Other files get processed inside of
functions which have their own local scope and therefore only impact the rest
of the project in more purposeful ways.</p>
<p>ToDo: Fill in!</p>
<p>In order to aid in debugging problems with configuration, TriBITS defines the
CMake cache option <tt class="docutils literal">${PROJECT_NAME}_TRACE_FILE_PROCESSING</tt>.  When enabled,
TriBITS will print out when any of the project-related, repository-related, or
package-related file is being processed by TriBITS.  When
<tt class="docutils literal">${PROJECT_NAME}_TRACE_FILE_PROCESSING=ON</tt>, lines starting with <tt class="docutils literal"><span class="pre">&quot;--</span> File
Trace:&quot;</tt> are printed in the <tt class="docutils literal">cmake</tt> STDOUT for files that TriBITS
automatically processes where there may be any confusion about what files are
processed and when.</p>
<p>For example, for <a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>, the configure file trace for ???
looks something like:</p>
<pre class="literal-block">
File Trace: PROJECT    INCLUDE    [...]/TribitsExampleProject/Version.cmake&quot;
File Trace: REPOSITORY INCLUDE    [...]/TribitsExampleProject/./PackagesList.cmake&quot;
File Trace: REPOSITORY INCLUDE    [...]/TribitsExampleProject/./TPLsList.cmake&quot;
File Trace: PACKAGE    INCLUDE    [...]/TribitsExampleProject/packages/simple_cxx/cmake/Dependencies.cmake&quot;
File Trace: PACKAGE    INCLUDE    [...]/TribitsExampleProject/packages/mixed_language/cmake/Dependencies.cmake&quot;
File Trace: PACKAGE    INCLUDE    [...]/TribitsExampleProject/packages/package_with_subpackages/cmake/Dependencies.cmake&quot;
File Trace: PACKAGE    INCLUDE    [...]/TribitsExampleProject/packages/package_with_subpackages/A/cmake/Dependencies.cmake&quot;
File Trace: PACKAGE    INCLUDE    [...]/TribitsExampleProject/packages/package_with_subpackages/B/cmake/Dependencies.cmake&quot;
File Trace: PACKAGE    INCLUDE    [...]/TribitsExampleProject/packages/package_with_subpackages/C/cmake/Dependencies.cmake&quot;
File Trace: PACKAGE    INCLUDE    [...]/TribitsExampleProject/packages/wrap_external/cmake/Dependencies.cmake&quot;
File Trace: REPOSITORY READ       [...]/TribitsExampleProject/./Copyright.txt&quot;
File Trace: REPOSITORY INCLUDE    [...]/TribitsExampleProject/./Version.cmake&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/simple_cxx/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/simple_cxx/test/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/mixed_language/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/mixed_language/test/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/package_with_subpackages/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/package_with_subpackages/A/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/package_with_subpackages/A/tests/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/package_with_subpackages/B/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/package_with_subpackages/B/tests/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/package_with_subpackages/C/CMakeLists.txt&quot;
File Trace: PACKAGE    ADD_SUBDIR [...]/TribitsExampleProject/packages/package_with_subpackages/C/tests/CMakeLists.txt&quot;
</pre>
<p>However, every file that TriBITS processes is not printed in this file trace
if it should be obvious that the file is being processed.  For example, the
package's configured header file created using <cite>TRIBITS_CONFIGURE_FILE()</cite> does
not result in a file trace print statment because that is an unconditional
command that is explicitly called in one of the the package's
<tt class="docutils literal">CMakeLists.txt</tt> files so it should be clear that this file is being
processed.</p>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="coexisting-projects-repositories-and-packages">
<h2><a class="toc-backref" href="#id33">3.3&nbsp;&nbsp;&nbsp;Coexisting Projects, Repositories, and Packages</a></h2>
<p>Certain simplifications area allowed when defining TriBITS projects,
repositories and packages.  The known allowed simplifications are described
below.</p>
<p><strong>TriBITS Repository == TriBITS Project</strong>: It is allowed for a TriBITS Project
and a TriBITS Repository to be the same source directory.  In this case, the
repository name and the project name are the same as well.  This is quite
common.  This is the case, for example, with the the Trilinos and the
<a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a> projects and repositories.  In this case, the
Project's and the Repository's <tt class="docutils literal">Version.cmake</tt> and <tt class="docutils literal">Copyright.txt</tt> files
are one and the same, as they should be (see <a class="reference internal" href="#project-and-repositiory-versioning-and-release-mode">Project and Repositiory
Versioning and Release Mode</a>).</p>
<p><strong>TriBITS Package == TriBITS Repository</strong>: It is also allowed for a TriBITS
Repository to have only one package and to have that package be the base
repository directory and have the same names.  The TriBITS Pepository and the
single TriBITS Package would typically have the same name in this case (but
that is actually not required but is confusing if one does not make it so).
For example, in the TriBITS test project <tt class="docutils literal">MockTrilinos</tt>, the repostory and
package <tt class="docutils literal">extraRepoOnePackage</tt> are one in the same.  In this case, the file
<tt class="docutils literal">extraRepoOnePackage/PackagesList.cmake</tt> looks like:</p>
<pre class="literal-block">
TRIBITS_DEFINE_REPOSITORY_PACKAGES(
  extraRepoOnePackage   .     ST
  )

</pre>
<p>This is used in the real TriBITS repository <a class="reference external" href="https://github.com/CNERG/DataTransferKit">DataTransferKit</a>.</p>
<p>However, to maximize flexibility, it is recommended that a TriBITS package and
TriBITS repository not share the same directory.</p>
<p><strong>TriBITS Package, TriBITS Repository, TriBITS Package sharing the same source
directory</strong>: In the extreme, it is posisble to collapase a single TriBITS
dackage, repository, and project into the same base source directory.
However, in this case, the TriBITS Project name and the TriBITS Package name
can not be the same and some modifications and tricks are needed to allow this
to work.  One example of this is the TriBITS project and TriBITS package
themselves, which are both rooted in the base <tt class="docutils literal">tribits</tt> directory.  There
are a few restructions and modifications needed to get this to work:</p>
<ul class="simple">
<li>The Project and Package names can not be the same: In the case of TriBTS,
the project name is <tt class="docutils literal">TriBITSProj</tt> (as defined in
<tt class="docutils literal">tribits/ProjectName.cmake</tt>) and the package name is <tt class="docutils literal">TriBITS</tt> (as
defined in <tt class="docutils literal">tribits/PackagesList.cmake</tt>).</li>
<li>The base <tt class="docutils literal">CMakeLists.txt</tt> file must me modified to allow it to be
processed both as the base project file and as the package file: In the case
of <tt class="docutils literal">tribits/CMakeLists.txt</tt>, a big if statement based in the local
variable <tt class="docutils literal">TriBITS_PROCESSED_BASED_PROJECT</tt> is used.</li>
<li>The TriBITS package's binary directory must be modified.  Because of
directory level targets like <tt class="docutils literal">${PROJECT_NAME}_libs</tt> and
<tt class="docutils literal">${PACKAGE_NAME}_libs</tt>, a subdirectory for package's the binary directory
must be created.  This is simply done by overriding the binary directory
name <tt class="docutils literal">${PACKAGE_NAME}_SPECIFIED_BINARY_DIR</tt>.  In the case of TriBITS, this
is set to <tt class="docutils literal">tribits</tt> in the <tt class="docutils literal">tribits/PackagesList.cmake</tt> file.</li>
</ul>
<p>Other than those modifications, a TriBITS project, repository, and package can
all be rooted in the same source directory.  However, to do so is a little
messing and is not recommended.  It was only done this way with the base
TriBITS directory in order to maintain backward compatibility.</p>
<p>However, one possible use case for collapsing a project, repository, and
package into a single base source directory would be to support the
stand-alone build of a TriBITS package as its own entity that uses and
installation of the TriBITS CMake modules.  If a given upstream TriBITS
package has no required upstream TriBITS package dependencies and minimal TPL
dependencies (or only uses &quot;standard&quot; TriBITS TPLs already defined in the
<tt class="docutils literal">tribits/tpls/</tt> directory), then creating a stand-alone project build of a
loan TriBITS package requires fairly little extra overhead.</p>
</div>
<div class="section" id="standard-tribits-tpls">
<h2><a class="toc-backref" href="#id34">3.4&nbsp;&nbsp;&nbsp;Standard TriBITS TPLs</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="where-to-set-variables">
<h2><a class="toc-backref" href="#id35">3.5&nbsp;&nbsp;&nbsp;Where to set variables?</a></h2>
<p>A TriBITS project, repository, package have a number of files in which
varaibles can be set and commands can be called in order to affect how the
project is defined and configured.  With so many files that can be included by
TriBITS, it can be difficult to know where the right place is to set a given
set of variables.  The primary considerations for where to set a variable
depend on:</p>
<p>ToDo: Describe considerations on where to set variables ...</p>
</div>
</div>
<div class="section" id="example-tribits-projects">
<h1><a class="toc-backref" href="#id36">4&nbsp;&nbsp;&nbsp;Example TriBITS Projects</a></h1>
<p>In this section, a few different example TriBITS projects and packages are
previewed.  All of these examples exist in the TriBITS source tree directory
<tt class="docutils literal">tribits</tt> itself so they are available to all users of TriBITS.  These
examples also provide a means to test the TriBITS system itself.</p>
<p>The first example covered in detail is <a class="reference internal" href="#tribitsexampleproject">TribitsExampleProject</a>.  This first
example covers all the basics for setting up a simple multi-package TriBITS
project.  The second example outlined is <cite>MockTrilinos</cite> which mostly exists to
test the TirBITS system itself.  The last example mentioned is the the
<tt class="docutils literal">TriBITS</tt> package itself which allows the TriBITS system to be tested and
installed from any TriBITS project that lists it, including the
<tt class="docutils literal">TriBITSProj</tt> project itself (see <a class="reference internal" href="#coexisting-projects-repositories-and-packages">Coexisting Projects, Repositories, and
Packages</a>).</p>
<p>The <tt class="docutils literal">tribits/doc/examples/</tt> directory contains some other example TriBITS
projects and repositories as well that are refered to in this and other
documents.</p>
<div class="section" id="tribitshelloworld">
<h2><a class="toc-backref" href="#id37">4.1&nbsp;&nbsp;&nbsp;TribitsHelloWorld</a></h2>
<p>This is the simplest possible TriBITS project that you can imagine.  It
contains only a single TriBITS package and no frills at all.  However, it does
show how minimal a <a class="reference internal" href="#tribits-project">TriBITS Project</a> (which is also a <a class="reference internal" href="#tribits-repository">TriBITS Repository</a>)
and a <a class="reference internal" href="#tribits-package">TriBITS Package</a> can be and still show the value of TriBITS over raw
CMake.  For example, this can be embedded in to a larger TriBITS metra-project
and be seamlessly built along with any other such TriBITS-based software (see
the example meta-project in ???).</p>
</div>
<div class="section" id="tribitsexampleproject">
<h2><a class="toc-backref" href="#id38">4.2&nbsp;&nbsp;&nbsp;TribitsExampleProject</a></h2>
<p>Here, the example project TribitsExampleProject that is provided with the
TriBITS directory tree is outlined.  From this simple example, one can quickly
see how the basic structural elements a TriBITS example project are put
together.</p>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="mocktrilinos">
<h2><a class="toc-backref" href="#id39">4.3&nbsp;&nbsp;&nbsp;MockTrilinos</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="the-tribits-package-itself">
<h2><a class="toc-backref" href="#id40">4.4&nbsp;&nbsp;&nbsp;The TriBITS Package Itself</a></h2>
<p>ToDo: Fill in!</p>
</div>
</div>
<div class="section" id="package-dependencies-and-enable-disable-logic">
<h1><a class="toc-backref" href="#id41">5&nbsp;&nbsp;&nbsp;Package Dependencies and Enable/Disable Logic</a></h1>
<p>ToDo: Fill in!</p>
<p>The following TriBITS repository-related variables alter what packages in a
given TriBITS repository get enabled implicitly or not:</p>
<blockquote>
<p><tt class="docutils literal">${REPOSITORY_NAME}_NO_IMPLICIT_PACKAGE_ENABLE</tt></p>
<blockquote>
If set to <tt class="docutils literal">ON</tt>, then the packages in Repository <tt class="docutils literal">${REPOSITORY_NAME}</tt>
will not be implicitly enabled in any of the package adjustment logic.</blockquote>
<p><tt class="docutils literal">${REPOSITORY_NAME}_NO_IMPLICIT_PACKAGE_ENABLE_EXCEPT</tt></p>
<blockquote>
List of packages in the Repository <tt class="docutils literal">${REPOSITORY_NAME}</tt> that will be
allowed to be implicitly enabled.  Only checked if
<tt class="docutils literal">${REPOSITORY_NAME}_NO_IMPLICIT_PACKAGE_ENABLE</tt> is true.</blockquote>
</blockquote>
<p>The above variables typically are defined in the outer TriBITS Project's
<tt class="docutils literal">PackageName.cmake</tt> file in order to adjust how its listed repositories are
handled.</p>
<p>ToDo: Fill in!</p>
<div class="section" id="project-packagedependencies-xml">
<h2><a class="toc-backref" href="#id42">5.1&nbsp;&nbsp;&nbsp;&lt;Project&gt;PackageDependencies.xml</a></h2>
<p>ToDo: Fill in!</p>
</div>
</div>
<div class="section" id="tribits-automated-testing">
<h1><a class="toc-backref" href="#id43">6&nbsp;&nbsp;&nbsp;TriBITS Automated Testing</a></h1>
<p>Much of the value provided by the TriBITS system is related to the support of
testing of a complex project.  Many different types of testing is required in
a complex project and development effort.  In addition a large project with
lots of repositories and packages provides a number of testing and developmetn
challanges but also provides a number of opportunities to do testing in an
efficient way; expecially pre-push and post-push continuous integration (CI)
testing.  In addition, a number of post-push automated nightly test cases must
be managed.  TriBITS takes full advantage of the features of raw CMake, CTest,
and CDash in support of testing and where gaps exist, TriBITS provides tools
and customizations.</p>
<p>The following subsections describe several aspects to the TriBITS support for
testing.  ToDo: outline the following subsections.</p>
<div class="section" id="testing-categories-for-repositories-packages-and-tests">
<h2><a class="toc-backref" href="#id44">6.1&nbsp;&nbsp;&nbsp;Testing categories for Repositories, Packages, and Tests</a></h2>
<p>ToDo: Define repo category Continuous, Nightly, and Experimental which also map to CDash tracks</p>
<p>ToDo: Define SE package test group PT, ST, and EX</p>
<p>ToDo: Define test category BASIC, CONTINUOUS, NIGHTLY, WEEKLY, and PERFORMANCE</p>
<p>ToDo: Discuss the propery usage of these test categories and why NIGHTLY
testing should be the default.</p>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="pre-push-testing-using-checkin-test-py">
<h2><a class="toc-backref" href="#id45">6.2&nbsp;&nbsp;&nbsp;Pre-push Testing using checkin-test.py</a></h2>
<p>ToDo: Describe the checkin-test.py script</p>
<p>ToDo: Describe the system for mapping changed files to changed packages.</p>
</div>
<div class="section" id="tribits-package-by-package-ctest-dash-driver">
<h2><a class="toc-backref" href="#id46">6.3&nbsp;&nbsp;&nbsp;TriBITS Package-by-Package CTest/Dash Driver</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="tribits-cdash-customizations">
<h2><a class="toc-backref" href="#id47">6.4&nbsp;&nbsp;&nbsp;TriBITS CDash Customizations</a></h2>
<p>ToDo: Fill in!</p>
<div class="section" id="cdash-regression-email-addresses">
<h3><a class="toc-backref" href="#id48">CDash regression email addresses</a></h3>
<p>Every TriBITS Package has a regression email address associated with it that
gets uploaded to a CDash project on a CDash server that is used to determine
what email address to use when a package has configure, build, or test
failures.  Because of the complex organizational nature of different projects
and different integration models, a single static email address for a given
package in every project build is not practical.</p>
<p>The TriBITS system allows for a Package's regression email to be specified in
the following order of precedence:</p>
<p>1) <strong>${REPOSITORY_NAME}_REPOSITORY_OVERRIDE_PACKAGE_EMAIL_LIST</strong> (typically
defined in <a class="reference internal" href="#projectdir-cmake-projectdependenciessetup-cmake">&lt;projectDir&gt;/cmake/ProjectDependenciesSetup.cmake</a>): Defines a
single email address for all packages for the repository
<tt class="docutils literal">${REPOSITORY_NAME}</tt> and overrides all other package email regression
specification varaibles.  This is typically used by a meta-project to
redefined the regression email addresses for the packages in an externally
developed repository.</p>
<p>2) <strong>REGRESSION_EMAIL_LIST</strong> (defined in
<a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a>): Package-specific email address
specified in the packages's <tt class="docutils literal">Dependencies.cmake</tt> file using
<a class="reference internal" href="#tribits-define-package-dependencies">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a>.</p>
<p>3) <strong>${REPOSITORY_NAME}_REPOSITORY_EMAIL_URL_ADDRESSS_BASE</strong> (set in
<a class="reference internal" href="#repodir-cmake-repositorydependenciessetup-cmake">&lt;repoDir&gt;/cmake/RepositoryDependenciesSetup.cmake</a>): A base email address
specified at the Repository level creating package-specific email addresses
(e.g. <tt class="docutils literal"><span class="pre">&lt;lower-case-package-name&gt;-regression&#64;some.repo.gov</span></tt>, where
<tt class="docutils literal">${REPOSITORY_NAME}_REPOSITORY_EMAIL_URL_ADDRESSS_BASE=some.repo.gov</tt>).
This variable is used, for example, by the Trilinos project to provide
automatic regression email addresses for packages.</p>
<p>4) <strong>${REPOSITORY_NAME}_REPOSITORY_MASTER_EMAIL_ADDRESSS</strong> (set in
<a class="reference internal" href="#repodir-cmake-repositorydependenciessetup-cmake">&lt;repoDir&gt;/cmake/RepositoryDependenciesSetup.cmake</a>): A single email address
for all packages specified at the Repository level
(e.g. <tt class="docutils literal"><span class="pre">my-repo-regression&#64;some.repo.gov</span></tt>).  This varaible is used for
smaller repositories with smaller development groups who just want all
regression emails for the repository's packages going to a single email
address.  This reduces the overhead of managing a bunch of individual package
email addresses but at the expense of spamming too many people with CDash
failure emails.</p>
<p>5) <strong>${PROJECT_NAME}_PROJECT_EMAIL_URL_ADDRESSS_BASE</strong> (set in
<a class="reference internal" href="#projectdir-cmake-projectdependenciessetup-cmake">&lt;projectDir&gt;/cmake/ProjectDependenciesSetup.cmake</a>): A base email address
specified at the Project level creating package-specific email addresses
(e.g. <tt class="docutils literal"><span class="pre">&lt;lower-case-package-name&gt;-regression&#64;some.project.gov</span></tt>, where
<tt class="docutils literal">${PROJECT_NAME}_PROJECT_EMAIL_URL_ADDRESSS_BASE=some.project.gov</tt>).  If not
already set, this variable will be set to
<tt class="docutils literal">${REPOSITORY_NAME}_REPOSITORY_EMAIL_URL_ADDRESSS_BASE</tt> for the first
repostory processed that has this set. This behavior is used, for example by
the Trilinos project to automatically assign email addresses for add-on
packages and was added to maintain backward compatibility.</p>
<p>6) <strong>${PROJECT_NAME}_PROJECT_MASTER_EMAIL_ADDRESSS</strong> (set in
<a class="reference internal" href="#projectdir-cmake-projectdependenciessetup-cmake">&lt;projectDir&gt;/cmake/ProjectDependenciesSetup.cmake</a>): A single default email
address for all packages specified at the Project level
(e.g. <tt class="docutils literal"><span class="pre">my-project-regression&#64;some.project.gov</span></tt>).  If not already set, this
variable will be set to
<tt class="docutils literal">${REPOSITORY_NAME}_REPOSITORY_MASTER_EMAIL_ADDRESSS</tt> for the first
repostory processed that has this set.  Every meta-project should set this
varaible so that it will be the defualt email address for any new package
added.</p>
<p>WARNING: If any of the email lists or URL string variables listed above are
set to <tt class="docutils literal">&quot;OFF&quot;</tt> or <tt class="docutils literal">&quot;FALSE&quot;</tt> (or some other value that CMake interprests as
false, see <tt class="docutils literal">CMake Language Overivew and Gotchas</tt>) then the varaibles are
treated as empty and not set.</p>
<p>If a TriBITS project does not use CDash, then no email address needed to be
assigned to packages at all (which will be the case if none of the above
variables are set).</p>
<p>As a general rule, repository-level settings override project-level settings
and package-level settings override both.  Also, a project can redefine a
reposiotry's regression email list settings by resetting the varibles in the
project's <a class="reference internal" href="#projectdir-cmake-projectdependenciessetup-cmake">&lt;projectDir&gt;/cmake/ProjectDependenciesSetup.cmake</a> file.</p>
<p>All of the email dependency managment logic must be accessable by just running
the macro:</p>
<pre class="literal-block">
TRIBITS_READ_PACKAGES_PROCESS_DEPENDENCIES_WRITE_XML()
</pre>
<p>The above email address configuration variables are read from the Repository
and Project files <a class="reference internal" href="#repodir-cmake-repositorydependenciessetup-cmake">&lt;repoDir&gt;/cmake/RepositoryDependenciesSetup.cmake</a> and
<a class="reference internal" href="#projectdir-cmake-projectdependenciessetup-cmake">&lt;projectDir&gt;/cmake/ProjectDependenciesSetup.cmake</a>, respectively.  The
<tt class="docutils literal">RepositoryDependenciesSetup.cmake</tt> files are read first in the specified
repository order followed up by reading the <tt class="docutils literal">ProjectDependenciesSetup.cmake</tt>
file.  In this way, the project can override any of the repository settings.</p>
<p>Here is a short review of the precedence order for how regression email
addresses are selected for a given package:</p>
<p>1) Package-specific email list is selected if defined (unless an override is
in place).</p>
<ol class="arabic simple" start="2">
<li>Repository-level option is selected over a project-level option.</li>
</ol>
<p>3) Default email form with repository or project address base is selected over
single repository or project email address.</p>
<ol class="arabic simple" start="4">
<li>If none of the above are selected, then no email address is assigned.</li>
</ol>
<p>What the above setup does is it results in the TriBITS system (in the
<tt class="docutils literal">TribitsCTestDriverCore.cmake</tt> file called under <tt class="docutils literal">ctest</tt>) creating a file
called <tt class="docutils literal">CDashSubprojectDependencies.xml</tt> that gets sent to the CDash
server. CDash then takes this file and creates, or updates, a set of CDash
users and sets up a mapping of Labels (which are used for TriBITS package
names) to CDash user emails addresses. CDash is automatically set up to
process this XML file and create and updates CDash users. It is not, however,
set up to remove labels from existing users.  Therefore, if you change a
TriBITS package's CDash regression email list (using one of the methods
described above), then you need to manually remove the associated labels from
the old email address.  CDash will not remove them for you.</p>
<p>Therefore, to change the mapping of CDash regression email addresses to
TriBITS packages, you must perform the actions:</p>
<p>1) Change the TriBITS CMake files as described above that will result in the
desired email addresses in the <tt class="docutils literal">CDashSubprojectDependeinces.xml</tt> file. You
can debug this by running the <tt class="docutils literal"><span class="pre">checkin-test.py</span></tt> (see ???) script and seeing
what gets written in the generated <tt class="docutils literal">${PROJECT_NAME}PackageDependencies.xml</tt>
(see ???)  file in the <tt class="docutils literal">CHECKIN</tt> directory.</p>
<p>2) Log onto the CDash server using an administrator account and then remove
the auto-generated account for the CDash user email address for which labels
are being removed (i.e. no longer associated with a TriBITS package).  This is
needed since CDash seems to be unable to remove labels from an existing CDash
user (however this might be fixed in a current version of CDash).</p>
<p>3) The next time a CDash submit is performed by the
<tt class="docutils literal">TribitsCTestDriverCore.cmake</tt> script, the CDash user associated with the
mail list with labels being removed will get automatically recreated with the
right list of labels (according to the current
<tt class="docutils literal">CDashSubprojectDependencies.xml</tt> file).  Also, any new CDash users for new
email addresses will be created.</p>
<p>Hopefully that should be enough clues to manage the mapping of CDash
regression email lists to TriBITS packages.</p>
</div>
</div>
</div>
<div class="section" id="multi-repository-support">
<h1><a class="toc-backref" href="#id49">7&nbsp;&nbsp;&nbsp;Multi-Repository Support</a></h1>
<p>ToDo: Discuss 'egdist', ExtraRepositoriesList.cmake, and the rep clone script.</p>
<div class="section" id="multi-repository-almost-continuous-integration">
<h2><a class="toc-backref" href="#id50">7.1&nbsp;&nbsp;&nbsp;Multi-Repository Almost Continuous Integration</a></h2>
<p>ToDo: Fill in!</p>
</div>
</div>
<div class="section" id="development-workflows">
<h1><a class="toc-backref" href="#id51">8&nbsp;&nbsp;&nbsp;Development Workflows</a></h1>
<div class="section" id="basic-development-workflow">
<h2><a class="toc-backref" href="#id52">8.1&nbsp;&nbsp;&nbsp;Basic Development Workflow</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="multi-repository-development-workflow">
<h2><a class="toc-backref" href="#id53">8.2&nbsp;&nbsp;&nbsp;Multi-Repository Development Workflow</a></h2>
<p>ToDo: Fill in!</p>
</div>
</div>
<div class="section" id="howtos">
<h1><a class="toc-backref" href="#id54">9&nbsp;&nbsp;&nbsp;Howtos</a></h1>
<p>ToDo: Fill in!</p>
<div class="section" id="how-to-add-a-new-tribits-package">
<h2><a class="toc-backref" href="#id55">9.1&nbsp;&nbsp;&nbsp;How to Add a new TriBITS Package</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="how-to-add-a-new-tribits-package-with-subpackages">
<h2><a class="toc-backref" href="#id56">9.2&nbsp;&nbsp;&nbsp;How to Add a new TriBITS Package with Subpackages</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="how-to-add-a-new-tribits-tpl">
<h2><a class="toc-backref" href="#id57">9.3&nbsp;&nbsp;&nbsp;How to Add a new TriBITS TPL</a></h2>
<p>ToDo: Fill in!</p>
</div>
</div>
<div class="section" id="additional-topics">
<h1><a class="toc-backref" href="#id58">10&nbsp;&nbsp;&nbsp;Additional Topics</a></h1>
<p>In this section, a number of miscellaneous topics and TriBITS features are
discussed.  These features and topics are either not considered primary
fetures of TriBITS (but can be very useful in many situations) or don't neatly
fit into one of the other sections.</p>
<div class="section" id="tribits-system-project-dependencies">
<h2><a class="toc-backref" href="#id59">10.1&nbsp;&nbsp;&nbsp;TriBITS System Project Dependencies</a></h2>
<p>The basic TriBITS system itself which is used to configure, built, test,
create tarballs, and install software that uses the TriBITS system has no
dependencies other than a basic installation of CMake (which typically
includes the exectuables <tt class="docutils literal">cmake</tt>, <tt class="docutils literal">ctest</tt>, and <tt class="docutils literal">cpack</tt>).  Great effort
has been expended to implement all of the core functionality of TriBITS just
using raw CMake.  That means that anyone who needs to configure, build, and
install the software just needs a compable CMake implementation.  TriBITS is
purposfully maintained to require an older version of CMake.  At the time of
this writing, the mimimum required version of CMake needed to use TriBITS is
CMake 2.8.1 (relasesed in March 2010, see <a class="reference external" href="http://www.cmake.org/Wiki/CMake_Released_Versions">CMake Release Wiki</a>).  CMake is becoming
iniquitous enough that many clients will already have a current-enough version
of CMake installed by default on their systems and will therefore not need to
download or install any extra software when building and installing a project
that uses TriBITS (assuming the necessary compilers etc. required by the
project are also installed).  If a current-enough version of CMake is not
installed on a given system, it is easy to download the source code and all it
needs is a basic C++ compiler to build and install.</p>
<p>However, note that a specific TriBITS project is free to use any newer CMake
features it wants and therefore these projects will require newer versions of
CMake than what is required by TriBITS (see discussion of
<tt class="docutils literal">CMAKE_MINIMUM_REQUIRED()</tt> in <a class="reference internal" href="#projectdir-cmakelists-txt">&lt;projectDir&gt;/CMakeLists.txt</a>).  But also
note that specific TriBITS projects and packages will also require additional
tools like compilers, Python, Perl, or many other such dependencies.  It is
just that TriBITS itself does not require any of these.  The goal of TriBITS
is not to amke the portability of software that uses it any worse than it
already is but instead to make it easier in most cases (that after all is the
whole goal of CMake).</p>
<p>While the core TriBITS functionality is just written using raw CMake, the more
sophisticated development tools needed to implement the full TriBITS
development environment requires Python 2.4 (or higher, but not Python 3.x).
Python is needed for tools like <tt class="docutils literal"><span class="pre">checkin-test.py</span></tt> and <tt class="docutils literal">egdist</tt>.  In
addition, these python tools are used in <tt class="docutils literal">TribitsCTestDriverCore.cmake</tt> to
drive automated testing and submittals to CDash.  In addition, git is the
chosen version control tool for TriBITS and all of the VC related
functionality requires git support.  But none of this is required for doing
the most basic building, testing, or installation of a TriBITS project.</p>
</div>
<div class="section" id="project-specific-build-quick-reference">
<h2><a class="toc-backref" href="#id60">10.2&nbsp;&nbsp;&nbsp;Project-Specific Build Quick Reference</a></h2>
<p>If a project that uses TriBITS is going to have a significnat user base that
will configure, build, and test the project, then having some documentation
that explains how to do this would be useful.  For this purpose, TriBITS
provides a mechanism to quickly create a project-specific build quick
reference document in restructured text (RST) format and with HTML and
LaTeX/PDF outputs.  These documents are generally created in the base project
source tree and given then name <tt class="docutils literal"><span class="pre">&lt;Project&gt;BuildQuickRef.[rst,html,pdf]</span></tt>.
This document consists of two parts.  One part is a generic template document:</p>
<pre class="literal-block">
tribits/doc/build_quick_ref/TribitsBuildQuickRefBody.rst
</pre>
<p>provided in the TriBITS source tree that uses the place-holder <tt class="docutils literal">&lt;Project&gt;</tt>
for the for the real project name.  The second part is a project-specific
template file:</p>
<pre class="literal-block">
&lt;projectBaseDir&gt;/cmake/&lt;Project&gt;BuildQuickRefTemplate.rst
</pre>
<p>which provides the outer RST doucment (with title, authors, abstract,
introduction, other introductory sections).  From these two files, the
script:</p>
<pre class="literal-block">
tribits/doc/build_quick_ref/create-project-build-quickref.py
</pre>
<p>is used to replace <tt class="docutils literal">&lt;Project&gt;</tt> in the <tt class="docutils literal">TribitsBuildQuickRefBody.rst</tt> file
with the real project name (read from the project's <tt class="docutils literal">ProjectName.cmake</tt> file
by default) and then generates the read-only files:</p>
<pre class="literal-block">
&lt;projectBaseDir&gt;/
  &lt;Project&gt;BuildQuickRef.rst
  &lt;Project&gt;BuildQuickRef.html
  &lt;Project&gt;BuildQuickRef.pdf
</pre>
<p>To see a simple example of this, see:</p>
<pre class="literal-block">
tribits/doc/examples/TribitsExampleProject/cmake/create-build-quickref.sh
</pre>
<p>A project-indepenent version of this file is provided in the
<a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html">TribitsBuildQuickRef.[rsts,html,pdf]</a> which is referred to many
times in this developers guide.</p>
</div>
<div class="section" id="project-and-repositiory-versioning-and-release-mode">
<h2><a class="toc-backref" href="#id61">10.3&nbsp;&nbsp;&nbsp;Project and Repositiory Versioning and Release Mode</a></h2>
<p>TriBITS has built-in support for project and repository versioning and release
mode control.  When the project contains the file
<a class="reference internal" href="#projectdir-version-cmake">&lt;projectDir&gt;/Version.cmake</a>, it is used to define the project's offical
version.  The idea is that when it is time to branch for a release, the only
file that needs to be changed is the file is <a class="reference internal" href="#projectdir-version-cmake">&lt;projectDir&gt;/Version.cmake</a></p>
<p>Each TriBITS repository can also contain a <a class="reference internal" href="#repodir-version-cmake">&lt;repoDir&gt;/Version.cmake</a> file
that sets varaibles which TriBITS packages in that repository can use to
derive development and release version information.  If the TriBITS repository
also contains a <a class="reference internal" href="#repodir-copyright-txt">&lt;repoDir&gt;/Copyright.txt</a> file, then the information in
<tt class="docutils literal"><span class="pre">&lt;repoDir&gt;/Version.cmake</span></tt> and <tt class="docutils literal"><span class="pre">&lt;repoDir&gt;/Copyright.txt</span></tt> are used to
configure a repository version header file:</p>
<pre class="literal-block">
${${REPOSITORY_NAME}_BINARY_DIR}/${REPOSITORY_NAME}_version.h
</pre>
<p>The configured header file <tt class="docutils literal">${REPOSITORY_NAME}_version.h</tt> gives the
repository version number in several formats, which allows C/C++ code (or any
software that uses the C preprocessor) to write conditional code like:</p>
<pre class="literal-block">
#if Trilinos_MAJOR_MINOR_VERSION &gt; 100200
  /* Contains feature X */
  ...
#else
  /* Does not contain feature X */
  ...
#endif
</pre>
<p>Of course when the TriBITS project and the TriBITS repository are the same
directory, the <tt class="docutils literal"><span class="pre">&lt;projectDir&gt;/Version.cmake</span></tt> and <tt class="docutils literal"><span class="pre">&lt;repoDir&gt;/Version.cmake</span></tt>
files are the same file, which works just fine.</p>
</div>
<div class="section" id="configure-time-system-tests">
<h2><a class="toc-backref" href="#id62">10.4&nbsp;&nbsp;&nbsp;Configure-time System Tests</a></h2>
<p>CMake has very nice support for defining configure-time checks of the system
to help inconfiguring the project.  One can check for whether a header file
exists or not, if the compiler supports a given data-type or language feature
or perform almost any other type of check that one can imagine that can be
done using the configured compilers, libraries, system tools, etc.</p>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="creating-source-distributions">
<h2><a class="toc-backref" href="#id63">10.5&nbsp;&nbsp;&nbsp;Creating Source Distributions</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="regulated-backward-compatibility-and-deprecated-code">
<h2><a class="toc-backref" href="#id64">10.6&nbsp;&nbsp;&nbsp;Regulated Backward Compatibility and Deprecated Code</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="wrapping-exterally-configured-built-software-as-a-tribits-package">
<h2><a class="toc-backref" href="#id65">10.7&nbsp;&nbsp;&nbsp;Wrapping Exterally Configured/Built Software as a TriBITS Package</a></h2>
<p>ToDo: Fill in!</p>
</div>
<div class="section" id="tribits-dashboard-driver">
<h2><a class="toc-backref" href="#id66">10.8&nbsp;&nbsp;&nbsp;TriBITS Dashboard Driver</a></h2>
<p>ToDo: Fill in!</p>
</div>
</div>
<div class="section" id="references">
<h1><a class="toc-backref" href="#id67">11&nbsp;&nbsp;&nbsp;References</a></h1>
<p id="scale"><strong>SCALE</strong> <a class="reference external" href="http://scale.ornl.gov/">http://scale.ornl.gov/</a></p>
</div>
<div class="section" id="tribits-detailed-reference-documentation">
<h1><a class="toc-backref" href="#id68">12&nbsp;&nbsp;&nbsp;TriBITS Detailed Reference Documentation</a></h1>
<p>The following subsections contain detailed reference documentation for the
various TriBITS variables and functions and macros that are used by TriBITS.</p>
<div class="section" id="tribits-global-project-settings">
<h2><a class="toc-backref" href="#id69">12.1&nbsp;&nbsp;&nbsp;TriBITS Global Project Settings</a></h2>
<p>TriBITS defines a number of global project-level settings that can be set by
the user and can have their default determined by each individual TriBITS
project.  If a given TriBITS project does not define its own default, a
reasonble default is set by the TriBITS system automatically.  These options
are defined and are set, for the most part, in the internal TriBITS function
<tt class="docutils literal">TRIBITS_DEFINE_GLOBAL_OPTIONS_AND_DEFINE_EXTRA_REPOS()</tt> in the TriBITS
CMake code file <tt class="docutils literal">TribitsGlobalMacros.cmake</tt> which gets called inside of the
<tt class="docutils literal">TRIBITS_PROJECT()</tt> macro.  That function and that file are the definitive
source the options that a TriBITS project takes and what the default values
are but we strive to document them here as well.  Many of these global options
(i.e. cache variables) such as <tt class="docutils literal">${PROJECT_NAME}_&lt;SOME_OPTION&gt;</tt> allow the
project to define a default by setting a local varible
<tt class="docutils literal">${PROJECT_NAME}_&lt;SOME_OPTION&gt;_DEFAULT</tt> as:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_&lt;SOME_OPTION&gt;_DEFAULT &lt;someDefault&gt;)
</pre>
<p>either in its top-level <tt class="docutils literal">CMakeLists.txt</tt> file or in its
<tt class="docutils literal">ProjectName.cmake</tt> file.  If <tt class="docutils literal">${PROJECT_NAME}_&lt;SOME_OPTION&gt;_DEFAULT</tt> is
not set by the project, then TriBITS provides a reasonable default value.  The
TriBITS code for this looks like:</p>
<pre class="literal-block">
IF (&quot;${${PROJECT_NAME}_&lt;SOME_OPTION&gt;_DEFAULT}&quot; STREQUAL &quot;&quot;)
  SET(${PROJECT_NAME}_&lt;SOME_OPTION&gt;_DEFAULT &lt;someDefault&gt;)
ENDIF()

ADVANCED_SET( ${PROJECT_NAME}_&lt;SOME_OPTION&gt;
  ${PROJECT_NAME}_&lt;SOME_OPTION&gt;_DEFAULT}
  CACHE BOOL &quot;[documentation].&quot;
  )
</pre>
<p>where <tt class="docutils literal">&lt;SOME_OPTION&gt;</tt> is the option name like <tt class="docutils literal">TEST_CATEGORIES</tt> and
<tt class="docutils literal">&lt;someDefault&gt;</tt> is the default set by TriBITS if the project does not define
a default.  In this way, if the project sets the variable
<tt class="docutils literal">${PROJECT_NAME}_&lt;SOME_OPTION&gt;_DEFAULT</tt> before this code exeutates, then
<tt class="docutils literal"><span class="pre">${${PROJECT_NAME}_&lt;SOME_OPTION&gt;_DEFAULT}</span></tt> will be used as the default for
the cache varible <tt class="docutils literal">${PROJECT_NAME}_&lt;SOME_OPTION&gt;</tt> which, of course, can be
overridden by the user when calling <tt class="docutils literal">cmake</tt> in a number of ways.</p>
<p>Most of these global options that can be overridden externally by setting the
cache variable <tt class="docutils literal">${PROJECT_NAME}_&lt;SOME_OPTION&gt;</tt> should be documented in the
<a class="reference internal" href="#project-specific-build-quick-reference">Project-Specific Build Quick Reference</a> document.  A generic version of this
document is found in <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html">TribitsBuildQuickRef.[rsts,html,pdf]</a>.  Some of the more unusual
options that might only be of interest to developers mentioned below may not
be documented in <tt class="docutils literal"><span class="pre">&lt;Project&gt;BuildQuickRef.[rst,html,pdf]</span></tt>.</p>
<p>The global project-level TriBITS options for which defaults can be provided by
a given TriBITS project are:</p>
<ul class="simple">
<li><a class="reference internal" href="#project-name-disable-enabled-forward-dep-packages">${PROJECT_NAME}_DISABLE_ENABLED_FORWARD_DEP_PACKAGES</a></li>
<li><a class="reference internal" href="#project-name-enable-fortran">${PROJECT_NAME}_ENABLE_Fortran</a></li>
<li><a class="reference internal" href="#project-name-install-libraries-and-headers">${PROJECT_NAME}_INSTALL_LIBRARIES_AND_HEADERS</a></li>
<li><a class="reference internal" href="#project-name-enable-export-makefiles">${PROJECT_NAME}_ENABLE_EXPORT_MAKEFILES</a></li>
<li><a class="reference internal" href="#project-name-enable-install-cmake-config-files">${PROJECT_NAME}_ENABLE_INSTALL_CMAKE_CONFIG_FILES</a></li>
<li><a class="reference internal" href="#project-name-generate-export-file-dependencies">${PROJECT_NAME}_GENERATE_EXPORT_FILE_DEPENDENCIES</a></li>
<li><a class="reference internal" href="#project-name-elevate-st-to-pt">${PROJECT_NAME}_ELEVATE_ST_TO_PT</a></li>
<li><a class="reference internal" href="#project-name-enable-cpack-packaging">${PROJECT_NAME}_ENABLE_CPACK_PACKAGING</a></li>
<li><a class="reference internal" href="#project-name-exclude-disabled-subpackages-from-distribution">${PROJECT_NAME}_EXCLUDE_DISABLED_SUBPACKAGES_FROM_DISTRIBUTION</a></li>
<li><a class="reference internal" href="#project-name-cpack-source-generator">${PROJECT_NAME}_CPACK_SOURCE_GENERATOR</a></li>
<li><a class="reference internal" href="#project-name-test-categories">${PROJECT_NAME}_TEST_CATEGORIES</a></li>
<li><a class="reference internal" href="#mpi-exec-max-numprocs">MPI_EXEC_MAX_NUMPROCS</a></li>
</ul>
<p>These options are described below.</p>
<p id="project-name-disable-enabled-forward-dep-packages"><strong>${PROJECT_NAME}_DISABLE_ENABLED_FORWARD_DEP_PACKAGES</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_DISABLE_ENABLED_FORWARD_DEP_PACKAGES</tt> is <tt class="docutils literal">ON</tt> (the
TriBITS default value), then any explicitly enabled packages that have
disabled upstream required packages or TPLs will be disabled.  If <tt class="docutils literal">OFF</tt>,
then an configure error will occur (for more details see
<a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html">TribitsBuildQuickRef.*</a>).
A project define a different default value by setting:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_DISABLE_ENABLED_FORWARD_DEP_PACKAGES_DEFAULT FALSE)
</pre>
</blockquote>
<p id="project-name-enable-fortran"><strong>${PROJECT_NAME}_ENABLE_Fortran</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_ENABLE_Fortran</tt> is <tt class="docutils literal">ON</tt>, then Fortran support for the
project will be enabled and the Fortran compiler(s) must be found.  By
default, TriBITS sets this to <tt class="docutils literal">ON</tt> for non-Windows systems (i.e. <tt class="docutils literal">WIN32</tt>
is not set by CMake) but is <tt class="docutils literal">OFF</tt> for a Windows system.  A project always
requires Fortran, for example, it can set the default:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_ENABLE_Fortran_DEFAULT TRUE)
</pre>
<p>If a project does not have any native Fortran code a good default would be:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_ENABLE_Fortran_DEFAULT OFF)
</pre>
<p>NOTE: It is usually not a good idea to always force off Fortran, or any
compiler, because extra repositories and packages might be added by someone
that might require the compiler and we don't want to unnecessarily limit the
generality of a given TriBITS build.  Setting the default for all platforms
should be sufficient.</p>
</blockquote>
<p id="project-name-install-libraries-and-headers"><strong>${PROJECT_NAME}_INSTALL_LIBRARIES_AND_HEADERS</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_INSTALL_LIBRARIES_AND_HEADERS</tt> is set to <tt class="docutils literal">ON</tt>, then
any defined libraries or header files that are listed in calls to
<a class="reference internal" href="#tribits-add-library">TRIBITS_ADD_LIBRARY()</a> will be installed (unless options are passed into
<a class="reference internal" href="#tribits-add-library">TRIBITS_ADD_LIBRARY()</a> that disable installs).  If set to <tt class="docutils literal">OFF</tt>, then
headers and librareis will be installed by default and only <tt class="docutils literal">INSTALLABLE</tt>
executables added with <a class="reference internal" href="#tribits-add-executable">TRIBITS_ADD_EXECUTABLE()</a> will be installed.
However, as described in <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html">TribitsBuildQuickRef.*</a>, shared libraries will
still be always be installed if enabled since they are needed by the
installed executables.  The TriBITS default is to set this to <tt class="docutils literal">ON</tt>.</p>
<p>For a TriBITS project that primarily is delivering libraries (e.g. Trilinos),
then it makes sense to leave the TriBITS default or explicitly set:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_INSTALL_LIBRARIES_AND_HEADERS_DEFAULT ON)
</pre>
<p>For a TriBITS project that is primarily delivering executablers (e.g. VERA),
then it makes sense to set the default to:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_INSTALL_LIBRARIES_AND_HEADERS_DEFAULT OFF)
</pre>
</blockquote>
<p id="project-name-enable-export-makefiles"><strong>${PROJECT_NAME}_ENABLE_EXPORT_MAKEFILES</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_ENABLE_EXPORT_MAKEFILES</tt> is <tt class="docutils literal">ON</tt>, then
<tt class="docutils literal"><span class="pre">Makefile.export.&lt;PACKAGE_NAME&gt;</span></tt> will get created at configure time in the
build tree and installed into the install tree.  See <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html">TribitsBuildQuickRef.*</a> for details.  The TriBITS
default is <tt class="docutils literal">ON</tt> but a project can decide to turn this off by default by
setting:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_ENABLE_EXPORT_MAKEFILES_DEFAULT OFF)
</pre>
<p>A project might want to disable the generation of export makefiles by default
if its main purpose is to provide executables.  There is no reason to provide
an export makefile if libraies and headers are not actaully installed (see
<a class="reference internal" href="#project-name-install-libraries-and-headers">${PROJECT_NAME}_INSTALL_LIBRARIES_AND_HEADERS</a>)</p>
</blockquote>
<p id="project-name-enable-install-cmake-config-files"><strong>${PROJECT_NAME}_ENABLE_INSTALL_CMAKE_CONFIG_FILES</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_ENABLE_INSTALL_CMAKE_CONFIG_FILES</tt> is set to <tt class="docutils literal">ON</tt>,
then <tt class="docutils literal">&lt;PACKAGE_NAME&gt;Config.cmake</tt> files are created at configure time in
the build tree and installed into the install tree.  These files are used by
external CMkae projects to pull in the list of compilers, compiler options,
include directories and libraries.  The TriBITS default is <tt class="docutils literal">ON</tt>.  A
project can change the default by setting, for example:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_ENABLE_INSTALL_CMAKE_CONFIG_FILES_DEFAULT OFF)
</pre>
<p>A project would want to turn off the creation and installation of
<tt class="docutils literal">&lt;PACKAGE_NAME&gt;Config.cmake</tt> files if it was only installing and providing
executables. See <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html">TribitsBuildQuickRef.*</a> for details.</p>
</blockquote>
<p id="project-name-generate-export-file-dependencies"><strong>${PROJECT_NAME}_GENERATE_EXPORT_FILE_DEPENDENCIES</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_GENERATE_EXPORT_FILE_DEPENDENCIES</tt> is <tt class="docutils literal">ON</tt>, then the
data-structures needed to generate <tt class="docutils literal"><span class="pre">Makefile.export.&lt;PACKAGE_NAME&gt;</span></tt> and
<tt class="docutils literal">&lt;PACKAGE_NAEM&gt;Config.cmake</tt> are created.  These data structures are also
needed in order to generate export makefiles on demand using the function
<a class="reference internal" href="#tribits-write-flexible-package-client-export-files">TRIBITS_WRITE_FLEXIBLE_PACKAGE_CLIENT_EXPORT_FILES()</a>.  The default in
TriBITS is to turn this <tt class="docutils literal">ON</tt> automatically by default if
<tt class="docutils literal">${PROJECT_NAME}_ENABLE_EXPORT_MAKEFILES</tt> or
<tt class="docutils literal">${PROJECT_NAME}_ENABLE_INSTALL_CMAKE_CONFIG_FILES</tt> are <tt class="docutils literal">ON</tt>.  Else, by
default, TriBITS sets this to <tt class="docutils literal">OFF</tt>.  The only reason for the project to
override the default is to set it to <tt class="docutils literal">ON</tt> as with:</p>
<blockquote>
SET(${PROJECT_NAME}_GENERATE_EXPORT_FILE_DEPENDENCIES_DEFAULT ON)</blockquote>
<p>is so that the necessary data-structures are generated in order to use the
function <a class="reference internal" href="#tribits-write-flexible-package-client-export-files">TRIBITS_WRITE_FLEXIBLE_PACKAGE_CLIENT_EXPORT_FILES()</a>.</p>
</blockquote>
<p id="project-name-elevate-st-to-pt"><strong>${PROJECT_NAME}_ELEVATE_ST_TO_PT</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_ELEVATE_ST_TO_PT</tt> is set to <tt class="docutils literal">ON</tt>, then all <tt class="docutils literal">ST</tt> SE
packages will be elevated to <tt class="docutils literal">PT</tt> packages.  The TriBITS default is
obviously <tt class="docutils literal">OFF</tt>.  The default can be changed by setting:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_ELEVATE_ST_TO_PT_DEFAULT ON)
</pre>
<p>There are projects, especially meta-projects, where the distiction between
<tt class="docutils literal">PT</tt> and <tt class="docutils literal">ST</tt> code is not helpful or the assignment of <tt class="docutils literal">PT</tt> and <tt class="docutils literal">ST</tt>
packages in a repository is not appropriate.  An example project like this
CASL VERA.  Changing the default to <tt class="docutils literal">ON</tt> allows any packages to be
considered in pre-push testing.</p>
</blockquote>
<p id="project-name-enable-cpack-packaging"><strong>${PROJECT_NAME}_ENABLE_CPACK_PACKAGING</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_ENABLE_CPACK_PACKAGING</tt> is <tt class="docutils literal">ON</tt>, then CPack support
is enabled and some TriBITS code is avoided that is needed to set up
data-structures that are used by the built-in CMake target
<tt class="docutils literal">package_source</tt>.  The TriBITS default is <tt class="docutils literal">OFF</tt> with the idea that the
average developer or user will not be wanting to create source distributions
with CPack.  However, this default can be changed by setting:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_ENABLE_CPACK_PACKAGING ON)
</pre>
</blockquote>
<p id="project-name-exclude-disabled-subpackages-from-distribution"><strong>${PROJECT_NAME}_EXCLUDE_DISABLED_SUBPACKAGES_FROM_DISTRIBUTION</strong></p>
<blockquote>
<p>If <tt class="docutils literal">${PROJECT_NAME}_EXCLUDE_DISABLED_SUBPACKAGES_FROM_DISTRIBUTION</tt> is
<tt class="docutils literal">TRUE</tt>, then the directories for subpackages that are not enabled are left
out of the source tarball.  This reduces the size of the tarball as much as
possible but does require that the TriBITS packages and subpackages be
properly set up to allow disabled subpackages from being excluded.  The
TriBITS default is <tt class="docutils literal">TRUE</tt> but this can be changed by setting:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_EXCLUDE_DISABLED_SUBPACKAGES_FROM_DISTRIBUTION_DEFAULT FALSE)
</pre>
</blockquote>
<p id="project-name-cpack-source-generator"><strong>${PROJECT_NAME}_CPACK_SOURCE_GENERATOR</strong></p>
<blockquote>
<p>The variable <tt class="docutils literal">${PROJECT_NAME}_CPACK_SOURCE_GENERATOR</tt> determines the CPack
source generation types that are created when the <tt class="docutils literal">package_source</tt> target
is run.  The TriBITS default is set to <tt class="docutils literal">TGZ</tt>.  However, this default can
be overridded by setting, for example:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_CPACK_SOURCE_GENERATOR_DEFAULT &quot;TGZ;TBZ2&quot;)
</pre>
<p>This variable should generally be set in the file:</p>
<pre class="literal-block">
&lt;projectDir&gt;/cmake/CallbackDefineProjectPackaging.cmake
</pre>
<p>instead of in the base-level <tt class="docutils literal">CMakeLists.txt</tt> file so that it goes along
with rest of the project-specific CPack packaging options.</p>
</blockquote>
<p id="project-name-test-categories"><strong>${PROJECT_NAME}_TEST_CATEGORIES</strong></p>
<blockquote>
<p>The cache varaible <tt class="docutils literal">${PROJECT_NAME}_TEST_CATEGORIES</tt> detemines what tests
defined using <a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> and <a class="reference internal" href="#tribits-add-advanced-test">TRIBITS_ADD_ADVANCED_TEST()</a> will
be added for <tt class="docutils literal">ctest</tt> to run (see <cite>TriBITS Automated Testing</cite>) for
discussion of test categories).  The TriBITS default is <tt class="docutils literal">NIGHTLY</tt> for a
standard local build.  The <tt class="docutils literal"><span class="pre">checkin-test.py</span></tt> script sets this to
<tt class="docutils literal">BASIC</tt>.  A TriBITS project can override the default for a basic configure
using, for example:</p>
<pre class="literal-block">
SET(${PROJECT_NAME}_TEST_CATEGORIES BASIC)
</pre>
<p>The justification for having the default test category be <tt class="docutils literal">NIGHTLY</tt>
instead of <tt class="docutils literal">BASIC</tt> is that when someone is enabling a package to develop
on it or install it, we want them by default to be seeing the full version
of the test suite (shy of the <tt class="docutils literal">WEEKLY</tt> tests which can be very expensive)
for the packages they are explictly enabling.  Typically they will not be
enabling forward (downstream) dependent packages so the cost of running the
test suite should not be too prohibitive.  This all depends on how good of a
job the development teams do in making their test suites run fast and
keeping the cost of running the tests down.  See the section <a class="reference internal" href="#tribits-automated-testing">TriBITS
Automated Testing</a> for a more detailed discussion.</p>
</blockquote>
<p id="project-name-enable-development-mode"><strong>${PROJECT_NAME}_ENABLE_DEVELOPMENT_MODE</strong></p>
<blockquote>
The variable <tt class="docutils literal">${PROJECT_NAME}_ENABLE_DEVELOPMENT_MODE</tt> switches the
TriBITS project from development mode to release mode.  The default for this
variable <tt class="docutils literal">${PROJECT_NAME}_ENABLE_DEVELOPMENT_MODE_DEFAULT</tt> should be set
in the project's <a class="reference internal" href="#projectdir-version-cmake">&lt;projectDir&gt;/Version.cmake</a> file and switched from <tt class="docutils literal">ON</tt>
to <tt class="docutils literal">OFF</tt> when creating a release (see <a class="reference internal" href="#project-and-repositiory-versioning-and-release-mode">Project and Repositiory Versioning
and Release Mode</a>).  When <tt class="docutils literal">${PROJECT_NAME}_ENABLE_DEVELOPMENT_MODE = ON</tt>,
several other variables are given defaults appropriate for development mode.
For example, <tt class="docutils literal">${PROJECT_NAME}_ASSERT_MISSING_PACKAGES</tt> is set to <tt class="docutils literal">ON</tt> by
default in development mode but is set to <tt class="docutils literal">OFF</tt> by default in release
mode.  In addition, strong compiler warnings are enabled by default in
development mode but are disabled by default in release mode.  Thsi variable
also affects the behavior of <a class="reference internal" href="#tribits-set-st-for-dev-mode">TRIBITS_SET_ST_FOR_DEV_MODE()</a>.</blockquote>
<p id="mpi-exec-max-numprocs"><strong>MPI_EXEC_MAX_NUMPROCS</strong></p>
<blockquote>
<p>The varaible <tt class="docutils literal">MPI_EXEC_MAX_NUMPROCS</tt> gives the maximum number of processes
for an MPI test that will be allowed as defined by <a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> and
<a class="reference internal" href="#tribits-add-advanced-test">TRIBITS_ADD_ADVANCED_TEST()</a>.  The TriBITS default is set to be <tt class="docutils literal">4</tt> (for
no good reason really but it needs to stay that way for backward
compatibility).  This default can be changed by setting:</p>
<pre class="literal-block">
SET(MPI_EXEC_MAX_NUMPROCS_DEFAULT &lt;newDefaultMax&gt;)
</pre>
<p>While this default can be changed for the project as a whole on all
platforms, it is likely better to change this default on a
machine-by-machine basis to correspond to the loat that can be accomidated
by a given machine (or class of machines).  For example if a given machine
has 64 cores, a reasonble number for <tt class="docutils literal">MPI_EXEC_MAX_NUMPROCS_DEFAULT</tt> is
64.</p>
</blockquote>
</div>
<div class="section" id="tribits-macros-and-functions">
<h2><a class="toc-backref" href="#id70">12.2&nbsp;&nbsp;&nbsp;TriBITS Macros and Functions</a></h2>
<p>The following subsections give detailed documentation for the CMake macros and
functions that make up the core TriBITS system.  These are what are used by
TriBITS project developers in their <tt class="docutils literal">CMakeLists.txt</tt> and other files.  All
of these functions and macros should be available when processing the
project's and package's variables files if used properly.  Therefore, no
explicit <tt class="docutils literal">INCLUDE()</tt> statements should be needed other than the initial
include of the <tt class="docutils literal">TribitsProject.cmake</tt> file in the top-level
<a class="reference internal" href="#projectdir-cmakelists-txt">&lt;projectDir&gt;/CMakeLists.txt</a> file so the command <a class="reference internal" href="#id8">TRIBITS_PROJECT()</a> can be
executed.</p>
<!-- WARNING: The file TribitsDetailedMacroFunctionDoc.rst is autogenerated from -->
<!-- the file TribitsDetailedMacroFunctionDocTemplate.rst in the script -->
<!-- generate-dev-guide.sh.  Only the file TribitsDetailedMacroFunctionDoc.rst -->
<!-- should be directly modified! -->
<div class="section" id="tribits-add-advanced-test">
<h3><a class="toc-backref" href="#id71">TRIBITS_ADD_ADVANCED_TEST()</a></h3>
<p>Function that creates an advanced test defined by stringing together one or
more executables and/or commands that is run as a separate CMake -P script
with very flixible pass/fail criteria.</p>
<p>This function allows you to add a single CTest test as a single unit that is
actually a sequence of one or more separate commands strung together in some
way to define the final pass/fail.  You will want to use this function to
add a test instead of <tt class="docutils literal">TRIBITS_ADD_TEST()</tt> when you need to run more than
one command, or you need more sophisticated checking of the test result
other than just greping STDOUT (i.e. by running programs to examine output
files).</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_ADVANCED_TEST(
  &lt;testName&gt;
  TEST_0 (EXEC &lt;execTarget0&gt; | CMND &lt;cmndExec0&gt;) ...
  [TEST_1 (EXEC &lt;execTarget1&gt; | CMND &lt;cmndExec1&gt;) ...]
  ...
  [TEST_N (EXEC &lt;execTargetN&gt; | CMND &lt;cmndExecN&gt;) ...]
  [OVERALL_WORKING_DIRECTORY (&lt;overallWorkingDir&gt; | TEST_NAME)]
  [FAIL_FAST]
  [KEYWORDS &lt;keyword1&gt; &lt;keyword2&gt; ...]
  [COMM [serial] [mpi]]
  [OVERALL_NUM_MPI_PROCS &lt;overallNumProcs&gt;]
  [CATEGORIES &lt;category0&gt; &lt;category1&gt; ...]
  [HOST &lt;host0&gt; &lt;host1&gt; ...]
  [XHOST &lt;host0&gt; &lt;host1&gt; ...]
  [HOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...]
  [XHOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...]
  [FINAL_PASS_REGULAR_EXPRESSION &lt;regex&gt; | FINAL_FAIL_REGULAR_EXPRESSION &lt;regex&gt;]
  [ENVIRONMENT &lt;var1&gt;=&lt;value1&gt; &lt;var2&gt;=&lt;value2&gt; ...]
  )
</pre>
<p>Each atomic test case is either a package-built executable or just a basic
command.  An atomic test command block of arguments takes the form:</p>
<pre class="literal-block">
TEST_&lt;idx&gt;
   (EXEC &lt;exeRootName&gt; [NOEXEPREFIX] [NOEXESUFFIX] [ADD_DIR_TO_NAME]
          [DIRECTORY &lt;dir&gt;]
      | CMND &lt;cmndExec&gt;)
   [ARGS &lt;arg1&gt; &lt;arg2&gt; ... &lt;argn&gt;]
   [MESSAGE &quot;&lt;message&gt;&quot;]
   [WORKING_DIRECTORY &lt;workingDir&gt;]
   [NUM_MPI_PROCS &lt;numProcs&gt;]
   [OUTPUT_FILE &lt;outputFile&gt;]
   [NO_ECHO_OUTPUT]]
   [PASS_ANY
     | PASS_REGULAR_EXPRESSION &quot;&lt;regex&gt;&quot;
     | PASS_REGULAR_EXPRESSION_ALL &quot;&lt;regex1&gt;&quot; &quot;&lt;regex2&gt;&quot; ... &quot;&lt;regexn&gt;&quot;
     | FAIL_REGULAR_EXPRESSION &quot;&lt;regex&gt;&quot;
     | STANDARD_PASS_OUTPUT
     ]
</pre>
<p>By default, each and every atomic test or command needs to pass (as defined below) in
order for the overall test to pass.</p>
<p><em>Sections:</em></p>
<ul class="simple">
<li><a class="reference internal" href="#overall-arguments-tribits-add-advanced-test">Overall Arguments (TRIBITS_ADD_ADVANCED_TEST())</a></li>
<li><a class="reference internal" href="#test-idx-test-blocks-and-arguments-tribits-add-advanced-test">TEST_&lt;idx&gt; Test Blocks and Arguments (TRIBITS_ADD_ADVANCED_TEST())</a></li>
<li><a class="reference internal" href="#overall-pass-fail-tribits-add-advanced-test">Overall Pass/Fail (TRIBITS_ADD_ADVANCED_TEST())</a></li>
<li><a class="reference internal" href="#argument-parsing-and-ordering-tribits-add-advanced-test">Argument Parsing and Ordering (TRIBITS_ADD_ADVANCED_TEST())</a></li>
<li><a class="reference internal" href="#implementation-details-tribits-add-advanced-test">Implementation Details (TRIBITS_ADD_ADVANCED_TEST())</a></li>
<li><a class="reference internal" href="#setting-additional-test-properties-tribits-add-advanced-test">Setting Additional Test Properties (TRIBITS_ADD_ADVANCED_TEST())</a></li>
<li><a class="reference internal" href="#disabling-tests-externally-tribits-add-advanced-test">Disabling Tests Externally (TRIBITS_ADD_ADVANCED_TEST())</a></li>
<li><a class="reference internal" href="#debugging-and-examining-test-generation-tribits-add-advanced-test">Debugging and Examining Test Generation (TRIBITS_ADD_ADVANCED_TEST())</a></li>
</ul>
<p id="overall-arguments-tribits-add-advanced-test"><strong>Overall Arguments (TRIBITS_ADD_ADVANCED_TEST())</strong></p>
<p>Below are given some overall arguments.  Remaining overall arguments that
control overall pass/fail are described in <a class="reference internal" href="#overall-pass-fail-tribits-add-advanced-test">Overall Pass/Fail
(TRIBITS_ADD_ADVANCED_TEST())</a>.  (NOTE: All of these arguments must be
listed outside of the <tt class="docutils literal">TEST_&lt;idx&gt;</tt> blocks, see <a class="reference internal" href="#argument-parsing-and-ordering-tribits-add-advanced-test">Argument Parsing and
Ordering (TRIBITS_ADD_ADVANCED_TEST())</a>).</p>
<blockquote>
<p><tt class="docutils literal">&lt;testName&gt;</tt></p>
<blockquote>
The name of the test (which will have <tt class="docutils literal">${PACKAGE_NAME}_</tt> prepended to
the name) that will be used to name the output CMake script file as well
as the CTest test name passed into <tt class="docutils literal">ADD_TEST()</tt>.  This must be the
first argument.</blockquote>
<p><tt class="docutils literal">OVERALL_WORKING_DIRECTORY &lt;overallWorkingDir&gt;</tt></p>
<blockquote>
If specified, then the working directory <tt class="docutils literal">&lt;overallWorkingDir&gt;</tt> will be
created and all of the test commands by default will be run from within
this directory.  If the value <tt class="docutils literal"><span class="pre">&lt;overallWorkingDir&gt;=TEST_NAME</span></tt> is
given, then the working directory will be given the name
<tt class="docutils literal">${PACKAGE_NAME}_&lt;testName&gt;</tt>.  If the directory
<tt class="docutils literal">&lt;overallWorkingDir&gt;</tt> exists before the test runs, it will be deleted
and created again.  Therefore, if you want to preserve the contents of
this directory between test runs you need to copy the files it somewhere
else.  This is a good option to use if the commands create intermediate
files and you want to make sure they get deleted before a set of test
cases runs again.</blockquote>
<p><tt class="docutils literal">FAIL_FAST</tt></p>
<blockquote>
If specified, then the remaining test commands will be aborted when any
test command fails.  Otherwise, all of the test cases will be run.</blockquote>
<p><tt class="docutils literal">RUN_SERIAL</tt></p>
<blockquote>
If specified then no other tests will be allowed to run while this test
is running.  This is useful for devices(like cuda cards) that require
exclusive access for processes/threads.  This just sets the CTest test
property <tt class="docutils literal">RUN_SERIAL</tt> using the built-in CMake function
<tt class="docutils literal">SET_TESTS_PROPERTIES()</tt>.</blockquote>
<p><tt class="docutils literal">COMM [serial] [mpi]</tt></p>
<blockquote>
If specified, selects if the test will be added in serial and/or MPI
mode.  See the <tt class="docutils literal">COMM</tt> argument in the script
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> for more details.</blockquote>
<p><tt class="docutils literal">OVERALL_NUM_MPI_PROCS &lt;overallNumProcs&gt;</tt></p>
<blockquote>
If specified, gives the default number of processes that each executable
command runs on.  If <tt class="docutils literal">&lt;numProcs&gt;</tt> is greater than
<tt class="docutils literal">${MPI_EXEC_MAX_NUMPROCS}</tt> then the test will be excluded.  If not
specified, then the default number of processes for an MPI build will be
<tt class="docutils literal">${MPI_EXEC_DEFAULT_NUMPROCS}</tt>.  For serial builds, this argument is
ignored.</blockquote>
<p><tt class="docutils literal">CATEGORIES &lt;category0&gt; &lt;category1&gt; ...</tt></p>
<blockquote>
Gives the test categories for which this test will be added.  See
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> for more details.</blockquote>
<p><tt class="docutils literal">HOST &lt;host0&gt; &lt;host1&gt; ...</tt></p>
<blockquote>
The list of hosts for which to enable the test (see <a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>).</blockquote>
<p><tt class="docutils literal">XHOST &lt;host0&gt; &lt;host1&gt; ...</tt></p>
<blockquote>
The list of hosts for which <strong>not</strong> to enable the test (see
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>).</blockquote>
<p><tt class="docutils literal">HOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...</tt></p>
<blockquote>
The list of host types for which to enable the test (see
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>).</blockquote>
<p><tt class="docutils literal">XHOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...</tt></p>
<blockquote>
The list of host types for which <strong>not</strong> to enable the test (see
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>).</blockquote>
<p><tt class="docutils literal">ENVIRONMENT <span class="pre">&lt;var1&gt;=&lt;value1&gt;</span> <span class="pre">&lt;var2&gt;=&lt;value2&gt;</span> ..</tt>.</p>
<blockquote>
If passed in, the listed environment varaibles will be set before
calling the test.  This is set using the built-in test property
<tt class="docutils literal">ENVIRONMENT</tt>.</blockquote>
</blockquote>
<p id="test-idx-test-blocks-and-arguments-tribits-add-advanced-test"><strong>TEST_&lt;idx&gt; Test Blocks and Arguments (TRIBITS_ADD_ADVANCED_TEST())</strong></p>
<p>Each test command block <tt class="docutils literal">TEST_&lt;idx&gt;</tt> runs either a package-built test
executable or some general command executable and is defined as either
<tt class="docutils literal">EXEC &lt;exeRootName&gt;</tt> or <tt class="docutils literal">CMND &lt;cmndExec&gt;</tt> with the arugments:</p>
<blockquote>
<p><tt class="docutils literal">EXEC &lt;exeRootName&gt; [NOEXEPREFIX] [NOEXESUFFIX] [ADD_DIR_TO_NAME] [DIRECTORY &lt;dir&gt;]</tt></p>
<blockquote>
If specified, then <tt class="docutils literal">&lt;exeRootName&gt;</tt> gives the root name of an
executable target that will be run as the command.  The full executable
name and path is determined in exactly the same way it is in the
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> function (see <a class="reference internal" href="#determining-the-exectuable-or-command-to-run-tribits-add-test">Determining the Exectuable or
Command to Run (TRIBITS_ADD_TEST())</a>).  If this is an MPI build, then
the executable will be run with MPI using <tt class="docutils literal">NUM_MPI_PROCS &lt;numProcs&gt;</tt>
or <tt class="docutils literal">OVERALL_NUM_MPI_PROCS &lt;overallNumProcs&gt;</tt> (if <tt class="docutils literal">NUM_MPI_PROCS</tt> is
not set for this test case).  If the number of maximum MPI processes
allowed is less than this number of MPI processes, then the test will
<em>not</em> be run.  Note that <tt class="docutils literal">EXEC &lt;exeRootName&gt;</tt> when <tt class="docutils literal">NOEXEPREFIX</tt> and
<tt class="docutils literal">NOEXESUFFIX</tt> are specified is basically equivalent to <tt class="docutils literal">CMND
&lt;cmndExec&gt;</tt> except that in an MPI build, <tt class="docutils literal">&lt;exeRootName&gt;</tt> is always
run using MPI.  In this case, you can pass in <tt class="docutils literal">&lt;exeRootName&gt;</tt> to any
command you would like and it will get run with MPI in MPI mode just
link any other command.</blockquote>
<p><tt class="docutils literal">CMND &lt;cmndExec&gt;</tt></p>
<blockquote>
If specified, then <tt class="docutils literal">&lt;cmndExec&gt;</tt> gives the executable for a command to
be run.  In this case, MPI will never be used to run the executable even
when configured in MPI mode (i.e. TPL_ENABLE_MPI=ON).  If you want to
run an arbitrary command using MPI, use <tt class="docutils literal">EXEC &lt;fullPathToCmndExec&gt;
NOPREFIX NOEXESUFFIX</tt> instead.</blockquote>
</blockquote>
<p>By default, the output (stdout/stderr) for each test command is captured and
is then echoed to stdout for the overall test.  This is done in order to be
able to grep the result to determine pass/fail.</p>
<p>Other miscellaneous arguments for each <tt class="docutils literal">TEST_&lt;idx&gt;</tt> block include:</p>
<blockquote>
<p><tt class="docutils literal">DIRECTORY &lt;dir&gt;</tt></p>
<blockquote>
If specified, then the executable is assumed to be in the directory
given by relative &lt;dir&gt;.  See <a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>.</blockquote>
<p><tt class="docutils literal">MESSAGE &quot;&lt;message&gt;&quot;</tt></p>
<blockquote>
If specified, then the string in <tt class="docutils literal">&quot;&lt;message&gt;&quot;</tt> will be print before
this test command is run.  This allows adding some documentation about
each individual test invocation to make the test output more
understandable.</blockquote>
<p><tt class="docutils literal">WORKING_DIRECTORY &lt;workingDir&gt;</tt></p>
<blockquote>
If specified, then the working directory <tt class="docutils literal">&lt;workingDir&gt;</tt> will be
created and the test will be run from within this directory.  If the
value <tt class="docutils literal">&lt;workingDir&gt; = TEST_NAME</tt> is given, then the working directory
will be given the name <tt class="docutils literal">${PACKAGE_NAME}_&lt;testName&gt;</tt>.  If the directory
&lt;workingDir&gt; exists before the test runs, it will be deleted and created
again.  Therefore, if you want to preserve the contents of this
directory between test runs you need to copy it somewhere else.  Using
<tt class="docutils literal">WORKING_DIRECTORY` for individual test commands allows creating
independent working directories for each test case.&nbsp; This would be
useful if a single ``OVERALL_WORKING_DIRECTORY</tt> was not sufficient for
some reason.</blockquote>
<p><tt class="docutils literal">NUM_MPI_PROCS &lt;numProcs&gt;</tt></p>
<blockquote>
If specified, then &lt;<tt class="docutils literal">numProcs&gt;</tt> is the number of processors used for MPI
executables.  If not specified, this will default to <tt class="docutils literal">&lt;overallNumProcs&gt;</tt>
from <tt class="docutils literal">OVERALL_NUM_MPI_PROCS &lt;overallNumProcs&gt;</tt>.</blockquote>
<p><tt class="docutils literal">OUTPUT_FILE &lt;outputFile&gt;</tt></p>
<blockquote>
If specified, then stdout and stderr for the test case will be sent to
<tt class="docutils literal">&lt;outputFile&gt;</tt>.</blockquote>
<p><tt class="docutils literal">NO_ECHO_OUTPUT</tt></p>
<blockquote>
If specified, then the output for the test command will not be echoed to
the output for the entire test command.</blockquote>
</blockquote>
<p>By default, an atomic test line is assumed to pass if the executable returns
a non-zero value.  However, a test case can also be defined to pass based
on:</p>
<blockquote>
<p><tt class="docutils literal">PASS_ANY</tt></p>
<blockquote>
If specified, the test command 'i' will be assumed to pass reguardless
of the return value or any other output.  This would be used when a
command that is to follow will determine pass or fail based on output
from this command in some way.</blockquote>
<p><tt class="docutils literal">PASS_REGULAR_EXPRESSION &quot;&lt;regex&gt;&quot;</tt></p>
<blockquote>
If specified, the test command 'i' will be assumed to pass if it matches
the given regular expression.  Otherwise, it is assumed to fail.</blockquote>
<p><tt class="docutils literal">PASS_REGULAR_EXPRESSION_ALL &quot;&lt;regex1&gt;&quot; &quot;&lt;regex2&gt;&quot; ... &quot;&lt;regexn&gt;&quot;</tt></p>
<blockquote>
If specified, the test command 'i' will be assumed to pas if the output
matches all of the provided regular expressions.  Note that this is not
a capability of raw ctest and represents an extension provided by
TriBITS.</blockquote>
<p><tt class="docutils literal">FAIL_REGULAR_EXPRESSION &quot;&lt;regex&gt;&quot;</tt></p>
<blockquote>
If specified, the test command 'i' will be assumed to fail if it matches
the given regular expression.  Otherwise, it is assumed to pass.</blockquote>
<p><tt class="docutils literal">STANDARD_PASS_OUTPUT</tt></p>
<blockquote>
If specified, the test command 'i' will be assumed to pass if the string
expression &quot;Final Result: PASSED&quot; is found in the ouptut for the test.</blockquote>
</blockquote>
<p>All of the arguments for a test block <tt class="docutils literal">TEST_&lt;idx&gt;</tt> must appear directly
below their <tt class="docutils literal">TEST_&lt;idx&gt;</tt> argument and before the next test block (see
<a class="reference internal" href="#argument-parsing-and-ordering-tribits-add-advanced-test">Argument Parsing and Ordering (TRIBITS_ADD_ADVANCED_TEST())</a>).</p>
<p id="overall-pass-fail-tribits-add-advanced-test"><strong>Overall Pass/Fail (TRIBITS_ADD_ADVANCED_TEST())</strong></p>
<p>By default, the overall test will be assumed to pass if it prints:</p>
<pre class="literal-block">
&quot;OVERALL FINAL RESULT: TEST PASSED&quot;
</pre>
<p>However, this can be changed by setting one of the following optional arguments:</p>
<blockquote>
<p><tt class="docutils literal">FINAL_PASS_REGULAR_EXPRESSION &lt;regex&gt;</tt></p>
<blockquote>
If specified, the test will be assumed to pass if the output matches
&lt;regex&gt;.  Otherwise, it will be assumed to fail.</blockquote>
<p><tt class="docutils literal">FINAL_FAIL_REGULAR_EXPRESSION &lt;regex&gt;</tt></p>
<blockquote>
If specified, the test will be assumed to fail if the output matches
&lt;regex&gt;.  Otherwise, it will be assumed to fail.</blockquote>
</blockquote>
<p id="argument-parsing-and-ordering-tribits-add-advanced-test"><strong>Argument Parsing and Ordering (TRIBITS_ADD_ADVANCED_TEST())</strong></p>
<p>The basic tool used for parsing the arguments to this function is the macro
<a class="reference internal" href="#parse-arguments">PARSE_ARGUMENTS()</a> which has a certain set of behaviors.  The parsing
using <a class="reference internal" href="#parse-arguments">PARSE_ARGUMENTS()</a> is actually done in two phases.  There is a
top-level parsing listing the &quot;overall&quot; arguments listed in <a class="reference internal" href="#overall-arguments-tribits-add-advanced-test">Overall
Arguments (TRIBITS_ADD_ADVANCED_TEST())</a> that also pulls out the test
blocks and then there is a second level of parsing using <cite>PARSE_ARGUMENTS()</cite>
for each of the <tt class="docutils literal">TEST_&lt;idx&gt;</tt> blocks.  Becuase of this usage, there are a
few restructions that one needs to be aware of when using
<tt class="docutils literal">TRIBITS_ADD_ADVANCED_TEST()</tt>.  This short sections tries to explain the
behaviors and what is allowed and what is not allowed.</p>
<p>For the most part, the overall argument and the arguments inside of any
individual <tt class="docutils literal">TEST_&lt;idx&gt;</tt> block can be listed can appear in any order but
there are restructions related to the grouping of overall arguments and
<tt class="docutils literal">TEST_&lt;idx&gt;</tt> blocks which are as follows:</p>
<ul class="simple">
<li>The <tt class="docutils literal">&lt;testName&gt;</tt> argument must be the first listed (it is the only
positional argument).</li>
<li>The test cases <tt class="docutils literal">TEST_&lt;idx&gt;</tt> must be listed in order (i.e. <tt class="docutils literal">TEST_0
... TEST_1 ...</tt>) and the test cases must be consecutive integers (i..e
can't jump from <tt class="docutils literal">TEST_5</tt> to <tt class="docutils literal">TEST_7</tt>).</li>
<li>All of the arguments for a test case must appear directly below its
<tt class="docutils literal">TEST_&lt;idx&gt;</tt> keyword and before the next <tt class="docutils literal">TEST_&lt;idx+1&gt;</tt> keyword or
before any trailing overall keyword arguments.</li>
<li>None of the overall arguments (e.g. <tt class="docutils literal">CATEGORIES</tt>) can be inside listed
inside of a <tt class="docutils literal">TEST_&lt;idx&gt;</tt> block but otherwise can be listed before or
after all of the <tt class="docutils literal">TEST_&lt;idx&gt;</tt> blocks.</li>
</ul>
<p>Other than that, the keyword argumnets and options can appear in any order.</p>
<p>ToDo: Add some examples of bad argument ordering and what will happen.</p>
<p id="implementation-details-tribits-add-advanced-test"><strong>Implementation Details (TRIBITS_ADD_ADVANCED_TEST())</strong></p>
<p>Since raw CTest does not support the features provided by this function, the
way an advanced test is implemented is that a CMake script with the name
<tt class="docutils literal"><span class="pre">${PACKAGE_NAME}_&lt;testName&gt;.cmake</span></tt> gets created in the current binary
directory that then gets added to CTest using:</p>
<pre class="literal-block">
ADD_TEST(${PACKAGE_NAME}_&lt;testName&gt;
  cmake [other options] -P ${PACKAGE_NAME}_&lt;testName&gt;.cmake)
</pre>
<p>This CMake script then runs the various test cases and checks the pass/fail
for each case to determine overall pass/fail and implement other
functionality.</p>
<p id="setting-additional-test-properties-tribits-add-advanced-test"><strong>Setting Additional Test Properties (TRIBITS_ADD_ADVANCED_TEST())</strong></p>
<p>After this function returns, if the test gets added using <tt class="docutils literal">ADD_TEST()</tt>
then additional properties can be set and changed using
<tt class="docutils literal"><span class="pre">SET_TEST_PROPERTIES(${PACKAGE_NAME}_&lt;testName&gt;</span> <span class="pre">...)</span></tt>.  Therefore, any
tests properties that are not directly supported by this function and passed
through the argument list to this wrapper function can be set in the outer
<tt class="docutils literal">CMakeLists.txt</tt> file after the call to <tt class="docutils literal">TRIBITS_ADD_ADVANCED_TEST()</tt>.</p>
<p id="disabling-tests-externally-tribits-add-advanced-test"><strong>Disabling Tests Externally (TRIBITS_ADD_ADVANCED_TEST())</strong></p>
<p>The test can be disabled externally by setting the CMake cache variable
<tt class="docutils literal">${FULL_TEST_NAME}_DISABLE=TRUE</tt>.  This allows tests to be disable on a
case-by-case basis.  This is the <em>exact</em> name that shows up in 'ctest -N'
when running the test.</p>
<p id="debugging-and-examining-test-generation-tribits-add-advanced-test"><strong>Debugging and Examining Test Generation (TRIBITS_ADD_ADVANCED_TEST())</strong></p>
<p>In order to see if the test gets added and to debug some issues in test
creation, one can set the cache variable
<tt class="docutils literal">${PROJECT_NAME}_VERBOSE_CONFIGURE=ON</tt>.  This will result in the printout
of some information about the test getting added or not.</p>
<p>Likely the best way to debugging test generation using this function is to
examine the generated file <tt class="docutils literal"><span class="pre">${PACKAGE_NAME}_&lt;testName&gt;.cmake</span></tt> in the
current binary directory (see <a class="reference internal" href="#implementation-details-tribits-add-advanced-test">Implementation Details
(TRIBITS_ADD_ADVANCED_TEST())</a>).</p>
</div>
<div class="section" id="tribits-add-debug-option">
<h3><a class="toc-backref" href="#id72">TRIBITS_ADD_DEBUG_OPTION()</a></h3>
<p>Add the standard option <tt class="docutils literal">${PACKGE_NAME}_ENABLE_DEBUG</tt> for the package.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_DEBUG_OPTION()
</pre>
<p>This option is given the default <tt class="docutils literal"><span class="pre">${${PROJECT_NAME}_ENABLE_DEBUG}</span></tt> and if
true, will set the variable <tt class="docutils literal"><span class="pre">HAVE_${PACKAGE_NAME_UC}_DEBUG</span></tt> (to be used in
the package's configured header file).</p>
</div>
<div class="section" id="tribits-add-example-directories">
<h3><a class="toc-backref" href="#id73">TRIBITS_ADD_EXAMPLE_DIRECTORIES()</a></h3>
<p>Macro called to conditionally add a set of example directories for an SE
package.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_EXAMPLE_DIRECTORIES(&lt;dir1&gt; &lt;dir2&gt; ...)
</pre>
<p>This macro only needs to be called from the top most CMakeList.txt file for
which all subdirectories are all &quot;examples&quot;.</p>
<p>This macro can be called several times within a package and it will have the
right effect.</p>
<p>Currently, really all it does macro does is to call
<tt class="docutils literal"><span class="pre">ADD_SUBDIRECTORY(&lt;diri&gt;)</span></tt> if <tt class="docutils literal">${PACKAGE_NAME}_ENABLE_EXAMPLES</tt> or
<tt class="docutils literal">${PARENT_PACKAGE_NAME}_ENABLE_EXAMPLES</tt> are true. However, this macro may
be extended in the futgure in order to modify behavior related to adding
tests and examples in a uniform way..</p>
</div>
<div class="section" id="tribits-add-executable">
<h3><a class="toc-backref" href="#id74">TRIBITS_ADD_EXECUTABLE()</a></h3>
<p>Function used to create an executable (typically for a test or example),
using the built-in CMake command <tt class="docutils literal">ADD_EXECUTABLE()</tt>.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_EXECUTABLE(
  &lt;exeRootName&gt;  [NOEXEPREFIX]  [NOEXESUFFIX]  [ADD_DIR_TO_NAME]
  SOURCES &lt;src0&gt; &lt;src1&gt; ...
  [CATEGORIES &lt;category0&gt;  &lt;category1&gt; ...]
  [HOST &lt;host0&gt; &lt;host1&gt; ...]
  [XHOST &lt;host0&gt; &lt;host1&gt; ...]
  [HOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...]
  [XHOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...]
  [DIRECTORY &lt;dir&gt;]
  [DEPLIBS &lt;lib0&gt; &lt;lib1&gt; ...]
  [COMM [serial] [mpi]]
  [LINKER_LANGUAGE (C|CXX|Fortran)]
  [DEFINES -D&lt;define0&gt; -D&lt;define1&gt; ...]
  [INSTALLABLE]
  )
</pre>
<p><em>Sections:</em></p>
<ul class="simple">
<li><a class="reference internal" href="#formal-arguments-tribits-add-executable">Formal Arguments (TRIBITS_ADD_EXECUTABLE())</a></li>
<li><a class="reference internal" href="#executable-and-target-name-tribits-add-executable">Executable and Target Name (TRIBITS_ADD_EXECUTABLE())</a></li>
<li><a class="reference internal" href="#additional-executable-and-source-file-properties-tribits-add-executable">Additional Executable and Source File Properties (TRIBITS_ADD_EXECUTABLE())</a></li>
<li><a class="reference internal" href="#install-target-tribits-add-executable">Install Target (TRIBITS_ADD_EXECUTABLE())</a></li>
</ul>
<p id="formal-arguments-tribits-add-executable"><strong>Formal Arguments (TRIBITS_ADD_EXECUTABLE())</strong></p>
<blockquote>
<p><tt class="docutils literal">&lt;exeRootName&gt;</tt></p>
<blockquote>
The root name of the exectuable (and CMake target) (see <a class="reference internal" href="#executable-and-target-name-tribits-add-executable">Executable and
Target Name (TRIBITS_ADD_EXECUTABLE())</a>).</blockquote>
<p><tt class="docutils literal">NOEXEPREFIX</tt></p>
<blockquote>
If passed in, then <tt class="docutils literal">${PACKAGE_NAME}_</tt> is not added the beginning of
the executable name (see <a class="reference internal" href="#executable-and-target-name-tribits-add-executable">Executable and Target Name
(TRIBITS_ADD_EXECUTABLE())</a>).</blockquote>
<p><tt class="docutils literal">NOEXESUFFIX</tt></p>
<blockquote>
If passed in, then <tt class="docutils literal"><span class="pre">${${PROJECT_NAME}_CMAKE_EXECUTABLE_SUFFIX}</span></tt> and
not added to the end of the executable name (see <a class="reference internal" href="#executable-and-target-name-tribits-add-executable">Executable and
Target Name (TRIBITS_ADD_EXECUTABLE())</a>).</blockquote>
<p><tt class="docutils literal">ADD_DIR_TO_NAME</tt></p>
<blockquote>
If passed in, the directory path relative to the package base directory
(with &quot;/&quot; replaced by &quot;_&quot;) is added to the executable name (see
<a class="reference internal" href="#executable-and-target-name-tribits-add-executable">Executable and Target Name (TRIBITS_ADD_EXECUTABLE())</a>).  This
provides a simple way to create unique test exectuable names inside of a
given TriBITS package.  Only test executables in the same directory
would need to have unique <tt class="docutils literal">&lt;execRootName&gt;</tt> passed in.</blockquote>
<p><tt class="docutils literal">SOURCES &lt;src0&gt; &lt;src1&gt; ...</tt></p>
<blockquote>
Gives the source files that will be compiled into the built executable.
By default, these sources are assumed to be in the current working
directory or gives the relative path to the current working directory.
If <tt class="docutils literal">&lt;srci&gt;</tt> is an absolute path, then that full file path is used.
This list of sources (with adjusted directory path) are passed into
<tt class="docutils literal"><span class="pre">ADD_EXECUTABLE(&lt;fullExeName&gt;</span> ... )</tt>.  After calling this function,
the properties of the source files can be altered using
<tt class="docutils literal">SET_SOURCE_FILE_PROPERTIES()</tt>.</blockquote>
<p><tt class="docutils literal">DIRECTORY &lt;dir&gt;</tt></p>
<blockquote>
If specified, then the soruces for the exectuable listed in <tt class="docutils literal">SOURCES
&lt;src0&gt; &lt;src1&gt; ...</tt> are assumed to be in the relative or absolute
directory <tt class="docutils literal">&lt;dir&gt;</tt> instead of the current source directory.  This
directrory path is prepended to each source file name <tt class="docutils literal">&lt;srci&gt;</tt> unless
<tt class="docutils literal">&lt;srci&gt;</tt> is an absolute path.</blockquote>
<p><tt class="docutils literal">CATEGORIES &lt;category0&gt; &lt;category1&gt; ...</tt></p>
<blockquote>
Gives the test categories for which this test will be added.  See
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> for more details.</blockquote>
<p><tt class="docutils literal">HOST &lt;host0&gt; &lt;host1&gt; ...</tt></p>
<blockquote>
The list of hosts for which to enable the test (see <a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>).</blockquote>
<p><tt class="docutils literal">XHOST &lt;host0&gt; &lt;host1&gt; ...</tt></p>
<blockquote>
The list of hosts for which <strong>not</strong> to enable the test (see
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>).</blockquote>
<p><tt class="docutils literal">HOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...</tt></p>
<blockquote>
The list of host types for which to enable the test (see
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>).</blockquote>
<p><tt class="docutils literal">XHOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...</tt></p>
<blockquote>
The list of host types for which <strong>not</strong> to enable the test (see
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a>).</blockquote>
<p><tt class="docutils literal">DEPLIBS &lt;lib0&gt; &lt;lib1&gt; ...</tt></p>
<blockquote>
<p>Specifies extra libraries that will be linked to the executable using
<tt class="docutils literal">TARGET_LINK_LIBRARY()</tt>.  Note that regular libraries (i.e. not
''TESTONLY'') defined in the current SE package or any upstream SE
packages do <strong>NOT</strong> need to be listed!  TriBITS automatically links
these libraries to the executable!  The only libraries that should be
listed in this argument are either <tt class="docutils literal">TESTONLY</tt> libraries, or other
libraries that are built external from this CMake project and are not
provided through a proper TriBITS TPL.  The latter usage is not
recommended.  External TPLs should be handled as a declared TriBITS TPL.
For a <tt class="docutils literal">TESTONLY</tt> library, the include directories will automatically
be added using:</p>
<pre class="literal-block">
INCLUDE_DIRECTORIES(${&lt;libi&gt;_INCLUDE_DIRS})
</pre>
<p>where <tt class="docutils literal">&lt;libi&gt;_INCLUDE_DIRS</tt> was set by:</p>
<pre class="literal-block">
TRIBITS_ADD_LIBRARY(&lt;libi&gt; ... TESTONLY ...)
</pre>
<p>Therefore, to link to a defined <tt class="docutils literal">TESTONLY</tt> library in any upstream
enabled package, one just needs to pass in the library name through
<tt class="docutils literal">DEPLIBS ... &lt;libi&gt; ...</tt> and that is it!</p>
</blockquote>
<p><tt class="docutils literal">COMM [serial] [mpi]</tt></p>
<blockquote>
If specified, selects if the test will be added in serial and/or MPI
mode.  See the <tt class="docutils literal">COMM</tt> argument in the script
<a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> for more details.</blockquote>
<p><tt class="docutils literal">LINKER_LANGUAGE (C|CXX|Fortran)</tt></p>
<blockquote>
If specified, overrides the linker language used by setting the target
property <tt class="docutils literal">LINKER_LANGUAGE</tt>.  By default, CMake choses the compiler to
be used as the linker based on file extensions.  The most typical use
case is when Fortran-only or C-only sources are passed in through
<tt class="docutils literal">SOURCES</tt> but a C++ linker is needed because there are upstream C++
libraries.</blockquote>
<p><tt class="docutils literal">DEFINES <span class="pre">-D&lt;define0&gt;</span> <span class="pre">-D&lt;define1&gt;</span> ...</tt></p>
<blockquote>
Add the listed defines using <tt class="docutils literal">ADD_DEFINITIONS()</tt>.  These should only
affect the listed sources for the built executable and not other
compiles in this directory due to the FUNCTION scoping.</blockquote>
<p><tt class="docutils literal">INSTALLABLE</tt></p>
<blockquote>
If passed in, then an install target will be added to install the built
exectuable into the <tt class="docutils literal"><span class="pre">${CMAKE_INSTALL_PREFIX}/bin/</span></tt> directory (see
<a class="reference internal" href="#install-target-tribits-add-executable">Install Target (TRIBITS_ADD_EXECUTABLE())</a>).</blockquote>
</blockquote>
<p id="executable-and-target-name-tribits-add-executable"><strong>Executable and Target Name (TRIBITS_ADD_EXECUTABLE())</strong></p>
<p>By default, the full name of the executable and target name
<tt class="docutils literal">&lt;fullExecName&gt;</tt> =</p>
<pre class="literal-block">
${PACKAGE_NAME}_&lt;exeRootName&gt;
</pre>
<p>If <tt class="docutils literal">ADD_DIR_TO_NAME</tt> is set, then the directory path relative to the
package base directory (with &quot;/&quot; replaced with &quot;_&quot;), or <tt class="docutils literal">&lt;relDirName&gt;</tt>, is
added to the executable name to form <tt class="docutils literal">&lt;fullExecName&gt;</tt> =</p>
<pre class="literal-block">
${PACKAGE_NAME}_&lt;relDirName&gt;_&lt;exeRootName&gt;
</pre>
<p>If the option <tt class="docutils literal">NOEXEPREFIX</tt> is pased in, the prefix <tt class="docutils literal">${PACKAGE_NAME}_</tt>
is removed.</p>
<p>CMake will add the executable suffix
<tt class="docutils literal"><span class="pre">${${PROJECT_NAME}_CMAKE_EXECUTABLE_SUFFIX}</span></tt> the actual executable file if
the option <tt class="docutils literal">NOEXESUFFIX</tt> is not passed in but this suffix is never added
to the target name.</p>
<p>The reason that a default prefix is prepended to the executable and target
name is because the primary reason to create an executable is typically to
create a test or an example that is private to the package.  This prefix
helps to namespace the exexutable and its target so as to avoid name clashes
with targets in other packages.  It also helps to avoid clashes if the
executable gets installed into the install directory (if <tt class="docutils literal">INSTALLABLE</tt> is
specified).</p>
<p id="additional-executable-and-source-file-properties-tribits-add-executable"><strong>Additional Executable and Source File Properties (TRIBITS_ADD_EXECUTABLE())</strong></p>
<p>Once <tt class="docutils literal"><span class="pre">ADD_EXECUTABLE(&lt;fullExeName&gt;</span> ... )</tt> is called, one can set and
change properties on the <tt class="docutils literal">&lt;fullExeName&gt;</tt> executable target using
<tt class="docutils literal">SET_TARGET_PROPERTIES()</tt> as well as properties on any of the source files
listed in <tt class="docutils literal">SOURCES</tt> using <tt class="docutils literal">SET_SOURCE_FILE_PROPERTIES()</tt> just like in
any CMake project.</p>
<p id="install-target-tribits-add-executable"><strong>Install Target (TRIBITS_ADD_EXECUTABLE())</strong></p>
<p>If <tt class="docutils literal">INSTALLABLE</tt> is passed in, then an install target <tt class="docutils literal">INSTALL(TARGETS
&lt;fullExeName&gt; <span class="pre">...)</span></tt> is added to install the built executable into the
<tt class="docutils literal"><span class="pre">${CMAKE_INSTALL_PREFIX}/bin/</span></tt> directory (actual install directory path is
determined by <tt class="docutils literal">${PROJECT_NAME}_INSTALL_RUNTIME_DIR</tt>) .</p>
</div>
<div class="section" id="tribits-add-executable-and-test">
<h3><a class="toc-backref" href="#id75">TRIBITS_ADD_EXECUTABLE_AND_TEST()</a></h3>
<p>Add an executable and a test (or several tests) all in one shot.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_EXECUTABLE_AND_TEST(
  &lt;exeRootName&gt;  [NOEXEPREFIX]  [NOEXESUFFIX]  [ADD_DIR_TO_NAME]
  SOURCES &lt;src0&gt; &lt;src1&gt; ...
  [NAME &lt;testName&gt; | NAME_POSTFIX &lt;testNamePostfix&gt;]
  [CATEGORIES &lt;category0&gt;  &lt;category1&gt; ...]
  [HOST &lt;host0&gt; &lt;host1&gt; ...]
  [XHOST &lt;xhost0&gt; &lt;xhost1&gt; ...]
  [XHOST_TEST &lt;xhost0&gt; &lt;xhost1&gt; ...]
  [HOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...]
  [XHOSTTYPE &lt;xhosttype0&gt; &lt;xhosttype1&gt; ...]
  [XHOSTTYPE_TEST &lt;xhosttype0&gt; &lt;xhosttype1&gt; ...]
  [DIRECTORY &lt;dir&gt;]
  [DEFINES -DS&lt;someDefine&gt;]
  [DEPLIBS &lt;lib0&gt; &lt;lib1&gt; ... ]
  [COMM [serial] [mpi]]
  [ARGS &quot;&lt;arg0&gt; &lt;arg1&gt; ...&quot; &quot;&lt;arg2&gt; &lt;arg3&gt; ...&quot; ...]
  [NUM_MPI_PROCS &lt;numProcs&gt;]
  [LINKER_LANGUAGE (C|CXX|Fortran)]
  [STANDARD_PASS_OUTPUT
    | PASS_REGULAR_EXPRESSION &quot;&lt;regex0&gt;;&lt;regex1&gt;;...&quot;]
  [FAIL_REGULAR_EXPRESSION &quot;&lt;regex0&gt;;&lt;regex1&gt;;...&quot;]
  [WILL_FAIL]
  [ENVIRONMENT &lt;var0&gt;=&lt;value0&gt; &lt;var1&gt;=&lt;value1&gt; ...]
  [INSTALLABLE]
  [TIMEOUT &lt;maxSeconds&gt;]
  )
</pre>
<p>This function takes a fairly common set of arguments to
<a class="reference internal" href="#tribits-add-executable">TRIBITS_ADD_EXECUTABLE()</a> and <a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> but not the full set
passed to <tt class="docutils literal">TRIBITS_ADD_TEST()</tt>.  See the documentation for
<a class="reference internal" href="#tribits-add-executable">TRIBITS_ADD_EXECUTABLE()</a> and <a class="reference internal" href="#tribits-add-test">TRIBITS_ADD_TEST()</a> to see which arguments
are accpeted by which functions.</p>
<p>Arguments that are specific to this function and not contained in
<tt class="docutils literal">TRIBITS_ADD_EXECUTABLE()</tt> or <tt class="docutils literal">TRIBITS_ADD_TEST()</tt> include:</p>
<blockquote>
<p><tt class="docutils literal">XHOST_TEST &lt;xhost0&gt; &lt;xhost1&gt; ...</tt></p>
<blockquote>
When specified, this disables just running the tests for the named hosts
<tt class="docutils literal">&lt;xhost0&gt;</tt>, <tt class="docutils literal">&lt;xhost0&gt;</tt> etc. but still builds the executable for the
test.</blockquote>
<p><tt class="docutils literal">XHOSTTYPE_TEST &lt;xhosttype0&gt; &lt;hosttype1&gt; ...</tt></p>
<blockquote>
When specified, this disables just running the tests for the named host
types <tt class="docutils literal">&lt;hosttype0&gt;</tt>, <tt class="docutils literal">&lt;hosttype0&gt;</tt>, ..., but still builds the
executable for the test.</blockquote>
</blockquote>
<p>This is the function to use for simple test executbles that you want to run
that either takes no arguments or just a simple set of arguments passed in
through <tt class="docutils literal">ARGS</tt>.</p>
</div>
<div class="section" id="tribits-add-library">
<h3><a class="toc-backref" href="#id76">TRIBITS_ADD_LIBRARY()</a></h3>
<p>Function used to add a CMake library and target using <tt class="docutils literal">ADD_LIBRARY()</tt>.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_LIBRARY(
  &lt;libName&gt;
  [HEADERS &lt;h0&gt; &lt;h1&gt; ...]
  [NOINSTALLHEADERS &lt;nih0&gt; &lt;hih1&gt; ...]
  [SOURCES &lt;src0&gt; &lt;src1&gt; ...]
  [DEPLIBS &lt;deplib0&gt; &lt;deplib1&gt; ...]
  [IMPORTEDLIBS &lt;ideplib0&gt; &lt;ideplib1&gt; ...]
  [TESTONLY]
  [NO_INSTALL_LIB_OR_HEADERS]
  [CUDALIBRARY]
  )
</pre>
<p><em>Sections:</em></p>
<ul class="simple">
<li><a class="reference internal" href="#formal-arguments-tribits-add-library">Formal Arguments (TRIBITS_ADD_LIBRARY())</a></li>
<li><a class="reference internal" href="#include-directories-tribits-add-library">Include Directories (TRIBITS_ADD_LIBRARY())</a></li>
<li><a class="reference internal" href="#install-targets-tribits-add-library">Install Targets (TRIBITS_ADD_LIBRARY())</a></li>
<li><a class="reference internal" href="#additional-library-and-source-file-properties-tribits-add-library">Additional Library and Source File Properties (TRIBITS_ADD_LIBRARY())</a></li>
<li><a class="reference internal" href="#miscellaneous-notes-tribits-add-library">Miscellaneous Notes (TRIBITS_ADD_LIBRARY())</a></li>
</ul>
<p id="formal-arguments-tribits-add-library"><strong>Formal Arguments (TRIBITS_ADD_LIBRARY())</strong></p>
<blockquote>
<p><tt class="docutils literal">&lt;libName&gt;</tt></p>
<blockquote>
<dl class="docutils">
<dt>Required name of the library.  This is the name passed to</dt>
<dd><tt class="docutils literal"><span class="pre">ADD_LIBRARY(&lt;libName&gt;</span> <span class="pre">...)</span></tt>.  The name is <em>not</em> prefixed by the
packae name.  CMake will of course add any standard prefix or post-fix
to the library file name appropriate for the platform and if this is a
static or shared library build.</dd>
</dl>
</blockquote>
<p><tt class="docutils literal">HEADERS &lt;h0&gt; &lt;h1&gt; ...</tt></p>
<blockquote>
List of public header files for using this library.  By default, these
header files are assumed to be in the current source directory.  They
can also contain the relative path or absolute path to the files if they
are not in the current source directory.  List list of headers is passed
into <tt class="docutils literal"><span class="pre">ADD_LIBRARY(...)</span></tt> as well (which is not strictly needed but is
helpful for some build tools, like MS Visual Stuido).  By default, these
headers will be installed as well (see <a class="reference internal" href="#include-directories-tribits-add-library">Include Directories
(TRIBITS_ADD_LIBRARY())</a>).</blockquote>
<p><tt class="docutils literal">NOINSTALLHEADERS &lt;nih0&gt; &lt;hih1&gt; ...</tt></p>
<blockquote>
List of private header files which are used by this library. These
headers are not installed and do not needed to be passed in for any
purpose other than to pass them into <tt class="docutils literal">ADD_LIBRARY()</tt> as some build
tools like to have these listed (e.g. MS Visual Studio).</blockquote>
<p><tt class="docutils literal">SOURCES &lt;src0&gt; &lt;src1&gt; ...</tt></p>
<blockquote>
List of source files passed into <tt class="docutils literal">ADD_LIBRARY()</tt> that are compiled
into header files and included in the library.  The compiler used to
compile the files is determined automatically based on the file
extension (see CMake documentation).</blockquote>
<p><tt class="docutils literal">DEPLIBS &lt;deplib0&gt; &lt;deplib1&gt; ...</tt></p>
<blockquote>
List of dependent libraries that are built in the current SE package
that this library is dependent on.  These libraries are passed into
<tt class="docutils literal"><span class="pre">TARGET_LINK_LIBRARIES(&lt;libName&gt;</span> <span class="pre">...)</span></tt> so that CMake knows about the
dependency.  You should <strong>not</strong> list libraries in other upstream SE
packages or libraries built externally from this TriBITS CMake project.
The TriBITS system automatically handles linking to libraries in uptream
TriBITS packages and external libraries need to be listed in
<tt class="docutils literal">IMPORTEDLIBS</tt> instead.</blockquote>
<p><tt class="docutils literal">IMPORTEDLIBS &lt;ideplib0&gt; &lt;ideplib1&gt; ...</tt></p>
<blockquote>
List of dependent libraries built exteranlly from this TriBITS CMake
project.  These libraries are passed into
<tt class="docutils literal"><span class="pre">TARGET_LINK_LIBRARIES(&lt;libName&gt;</span> <span class="pre">...)</span></tt> so that CMake knows about the
dependency.  These libraries are added the <tt class="docutils literal">${PACKAGE_NAME}_LIBRARIES</tt>
so that downstream SE packages will also have these libraries and the
link line also and these libraries will show up in the generated
<tt class="docutils literal"><span class="pre">Makefile.export.${PACKAGE_NAME}</span></tt> and <tt class="docutils literal">${PACKAGE_NAME}Config.cmake</tt>
files if they are generated.</blockquote>
<p><tt class="docutils literal">TESTONLY</tt></p>
<blockquote>
If passed in, then <tt class="docutils literal">&lt;libName&gt;</tt> will <strong>not</strong> be added to
<tt class="docutils literal">${PACKAGE_NAME}_LIBRARIES</tt> and an install target for the library will
not be added.  In this case, the current include directories will be set
in the global variable <tt class="docutils literal">&lt;libName&gt;_INCLUDE_DIR</tt> which will be used in
<a class="reference internal" href="#tribits-add-executable">TRIBITS_ADD_EXECUTABLE()</a> when a test-only library is linked in.</blockquote>
<p><tt class="docutils literal">NO_INSTALL_LIB_OR_HEADERS</tt></p>
<blockquote>
If specified, then no install targets will be added for the library
<tt class="docutils literal">&lt;libName&gt;</tt> or the header files listed in <tt class="docutils literal">HEADERS</tt>.</blockquote>
<p><tt class="docutils literal">CUDALIBRARY</tt></p>
<blockquote>
If specified then <tt class="docutils literal">CUDA_ADD_LIBRARY()</tt> is used instead of
<tt class="docutils literal">ADD_LIBRARY()</tt> where <tt class="docutils literal">CUDA_ADD_LIBRARY()</tt> is assumed to be defined
by the standard FindCUDA.cmake module as processed using the standard
TriBITS FindTPLCUDA.cmake file.  For this option to work, this SE
package must have an enabled direct or indirect dependency on the
TriBITS CUDA TPL or a configure-time error will occur about not finding
<tt class="docutils literal">CUDA_ALL_LIBRARY()</tt>.</blockquote>
</blockquote>
<p id="include-directories-tribits-add-library"><strong>Include Directories (TRIBITS_ADD_LIBRARY())</strong></p>
<p>Any base directories for these header files listed in <tt class="docutils literal">HEADERS</tt> or
<tt class="docutils literal">NOINSTALLHEADERS</tt> should be passed into <tt class="docutils literal">INCLUDE_DIRECTORIES()</tt> <em>before</em>
calling this function.  These include directories will then be added to
current packages list of include directories
<tt class="docutils literal">${PACKAGE_NAME}_INCLUDE_DIRS</tt>.</p>
<p id="install-targets-tribits-add-library"><strong>Install Targets (TRIBITS_ADD_LIBRARY())</strong></p>
<p>By default, an install target for the library is created using
<tt class="docutils literal">INSTALL(TARGETS &lt;libName&gt; <span class="pre">...)</span></tt> to install into the directory
<tt class="docutils literal"><span class="pre">${CMAKE_INSTALL_PREFIX}/lib/</span></tt> (actual install directory is given by
<tt class="docutils literal">${PROJECT}_INSTALL_LIB_DIR</tt>).  However, this install target will not get
created if <tt class="docutils literal">${PROJECT_NAME}_INSTALL_LIBRARIES_AND_HEADERS=FALSE</tt> and
<tt class="docutils literal">BUILD_SHARD_LIBS=OFF</tt>.  But when <tt class="docutils literal">BUILD_SHARD_LIBS=ON</tt>, the install
target will get created.  Also, this install target will <em>not</em> get created
if <tt class="docutils literal">TESTONLY</tt> or <tt class="docutils literal">NO_INSTALL_LIB_OR_HEADERS</tt> are passed in.</p>
<p>By default, an install target for the headers listed in <tt class="docutils literal">HEADERS</tt> will get
created using <tt class="docutils literal">INSTALL(FILES &lt;h1&gt; &lt;h2&gt; <span class="pre">...)</span></tt>, but only if <tt class="docutils literal">TESTONLY</tt> and
<tt class="docutils literal">NO_INSTALL_LIB_OR_HEADERS</tt> are not passed in as well.  These headers get
installed into the flat directory <tt class="docutils literal"><span class="pre">${CMAKE_INSTALL_PREFIX}/include/</span></tt> (the
actual install directory is given by
<tt class="docutils literal">${PROJECT_NAME}_INSTALL_INCLUDE_DIR</tt>).  Note that an install target will
<em>not</em> get created for the headers listed in <tt class="docutils literal">NOINSTALLHEADERS</tt>.</p>
<p id="additional-library-and-source-file-properties-tribits-add-library"><strong>Additional Library and Source File Properties (TRIBITS_ADD_LIBRARY())</strong></p>
<p>Once <tt class="docutils literal"><span class="pre">ADD_LIBRARY(&lt;libName&gt;</span> ... &lt;src0&gt; &lt;src1&gt; <span class="pre">...)</span></tt> is called, one can set
and change properties on the <tt class="docutils literal">&lt;libName&gt;</tt> library target using
<tt class="docutils literal">SET_TARGET_PROPERTIES()</tt> as well as properties on any of the source files
listed in <tt class="docutils literal">SOURCES</tt> using <tt class="docutils literal">SET_SOURCE_FILE_PROPERTIES()</tt> just like in
any CMake project.</p>
<p id="miscellaneous-notes-tribits-add-library"><strong>Miscellaneous Notes (TRIBITS_ADD_LIBRARY())</strong></p>
<p><strong>WARNING:</strong> Do <strong>NOT</strong> use <tt class="docutils literal">ADD_DEFINITIONS()</tt> to add defines
<tt class="docutils literal"><span class="pre">-D&lt;someDefine&gt;</span></tt> to the compile command line that will affect a header
file!  These defines are only set locally in this directory and child
directories.  These defines will <strong>NOT</strong> be set when code in peer
directories (e.g. a downstream TriBIS pacakge) compiles code that may
include these header files.  To add defines, please use a configured header
file (see <a class="reference internal" href="#tribits-configure-file">TRIBITS_CONFIGURE_FILE()</a>).</p>
</div>
<div class="section" id="tribits-add-option-and-define">
<h3><a class="toc-backref" href="#id77">TRIBITS_ADD_OPTION_AND_DEFINE()</a></h3>
<p>Add an option and a define variable in one shot.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_OPTION_AND_DEFINE( &lt;userOptionName&gt;  &lt;macroDefineName&gt;
  &quot;&lt;docStr&gt;&quot;  &lt;defaultValue&gt; )
</pre>
<p>This macro sets the user cache <tt class="docutils literal">BOOL</tt> variable <tt class="docutils literal">&lt;userOptionName&gt;</tt> and if
it is true, then sets the global (internal cache) macro define variable
<tt class="docutils literal">&lt;macroDefineName&gt;</tt> to <tt class="docutils literal">ON</tt>, and otherwise sets it to <tt class="docutils literal">OFF</tt>.  This is
designed to make it easy to add a user-enabled option to a configured header
file and have the define set in one shot.  This would require that the
package's configure file (see <a class="reference internal" href="#tribits-configure-file">TRIBITS_CONFIGURE_FILE()</a>) have the line:</p>
<pre class="literal-block">
#cmakedefine &lt;macroDefineName&gt;
</pre>
</div>
<div class="section" id="tribits-add-show-deprecated-warnings-option">
<h3><a class="toc-backref" href="#id78">TRIBITS_ADD_SHOW_DEPRECATED_WARNINGS_OPTION()</a></h3>
<p>Add the standard option <tt class="docutils literal">${PACKAGE_NAME}_SHOW_DEPRECATED_WARNINGS</tt> for the
package.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_SHOW_DEPRECATED_WARNINGS_OPTION()
</pre>
<p>This option is given the
default``${${PROJECT_NAME}_SHOW_DEPRECATED_WARNINGS}``.  This option is then
looked for in <a class="reference internal" href="#tribits-configure-file">TRIBITS_CONFIGURE_FILE()</a> to add macros to add deprecated
warnings to deprecated parts of a package.</p>
</div>
<div class="section" id="tribits-add-test">
<h3><a class="toc-backref" href="#id79">TRIBITS_ADD_TEST()</a></h3>
<p>Add a test or a set of tests for a single executable or command.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_TEST(
  &lt;exeRootName&gt;  [NOEXEPREFIX]  [NOEXESUFFIX]
  [NAME &lt;testName&gt; | NAME_POSTFIX &lt;testNamePostfix&gt;]
  [DIRECTORY &lt;directory&gt;]
  [ADD_DIR_TO_NAME]
  [ARGS &quot;&lt;arg0&gt; &lt;arg1&gt; ...&quot; &quot;&lt;arg2&gt; &lt;arg3&gt; ...&quot; ...
    | POSTFIX_AND_ARGS_0 &lt;postfix0&gt; &lt;arg0&gt; &lt;arg1&gt; ...
      POSTFIX_AND_ARGS_1 ... ]
  [COMM [serial] [mpi]]
  [NUM_MPI_PROCS &lt;numProcs&gt;]
  [CATEGORIES &lt;category0&gt;  &lt;category1&gt; ...]
  [HOST &lt;host0&gt; &lt;host1&gt; ...]
  [XHOST &lt;host0&gt; &lt;host1&gt; ...]
  [HOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...]
  [XHOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...]
  [STANDARD_PASS_OUTPUT
    | PASS_REGULAR_EXPRESSION &quot;&lt;regex0&gt;;&lt;regex1&gt;;...&quot;]
  [FAIL_REGULAR_EXPRESSION &quot;&lt;regex0&gt;;&lt;regex1&gt;;...&quot;]
  [WILL_FAIL]
  [ENVIRONMENT &lt;var0&gt;=&lt;value0&gt; &lt;var1&gt;=&lt;value1&gt; ...]
  [TIMEOUT &lt;maxSeconds&gt;]
  )
</pre>
<p><em>Sections:</em></p>
<ul class="simple">
<li><a class="reference internal" href="#formal-arguments-tribits-add-test">Formal Arguments (TRIBITS_ADD_TEST())</a></li>
<li><a class="reference internal" href="#determining-the-exectuable-or-command-to-run-tribits-add-test">Determining the Exectuable or Command to Run (TRIBITS_ADD_TEST())</a></li>
<li><a class="reference internal" href="#determining-the-full-test-name-tribits-add-test">Determining the Full Test Name (TRIBITS_ADD_TEST())</a></li>
<li><a class="reference internal" href="#adding-multiple-tests-tribits-add-test">Adding Multiple Tests  (TRIBITS_ADD_TEST())</a></li>
<li><a class="reference internal" href="#determining-pass-fail-tribits-add-test">Determining Pass/Fail (TRIBITS_ADD_TEST())</a></li>
<li><a class="reference internal" href="#setting-additional-test-properties-tribits-add-test">Setting additional test properties (TRIBITS_ADD_TEST())</a></li>
<li><a class="reference internal" href="#debugging-and-examining-test-generation-tribits-add-test">Debugging and Examining Test Generation (TRIBITS_ADD_TEST())</a></li>
<li><a class="reference internal" href="#disabling-tests-externally-tribits-add-test">Disabling Tests Externally (TRIBITS_ADD_TEST())</a></li>
</ul>
<p id="formal-arguments-tribits-add-test"><strong>Formal Arguments (TRIBITS_ADD_TEST())</strong></p>
<blockquote>
<p><tt class="docutils literal">&lt;exeRootName&gt;</tt></p>
<blockquote>
The name of the exectuble or path to the exectuable to run for the test
(see <a class="reference internal" href="#determining-the-exectuable-or-command-to-run-tribits-add-test">Determining the Exectuable or Command to Run
(TRIBITS_ADD_TEST())</a>).  This name is also the default root name for
the test (see <a class="reference internal" href="#determining-the-full-test-name-tribits-add-test">Determining the Full Test Name (TRIBITS_ADD_TEST())</a>).</blockquote>
<p><tt class="docutils literal">NOEXEPREFIX</tt></p>
<blockquote>
If specified, then the prefix <tt class="docutils literal">${PACKAGE_NAME}_</tt> is not assumed to be
prepended to <tt class="docutils literal">&lt;exeRootName&gt;</tt>.</blockquote>
<p><tt class="docutils literal">NOEXESUFFIX</tt></p>
<blockquote>
If specified, then the postfix
<tt class="docutils literal"><span class="pre">${${PROJECT_NAME}_CMAKE_EXECUTABLE_SUFFIX}</span></tt> is not assumed to be
post-pended to <tt class="docutils literal">&lt;exeRootName&gt;</tt>.</blockquote>
<p><tt class="docutils literal">NAME &lt;testRootName&gt;</tt></p>
<blockquote>
If specified, gives the root name of the test.
If not specified, then <tt class="docutils literal">&lt;testRootName&gt;</tt> is taken to be
<tt class="docutils literal">&lt;exeRootName&gt;</tt>.  The actual test name will always prefixed as
<tt class="docutils literal">${PACKAGE_NAME}_&lt;testRootName&gt;</tt> passed into the call to the built-in
CMake command <tt class="docutils literal"><span class="pre">ADD_TEST(...)</span></tt>.  The main purpose of this argument is to
allow multiple tests to be defined for the same executable.  CTest
requires all test names to be globally unique in a single project.</blockquote>
<p><tt class="docutils literal">NAME_POSTFIX &lt;testNamePostfix&gt;</tt></p>
<blockquote>
If specified, gives a postfix that will be added to the standard test
name based on <tt class="docutils literal">&lt;exeRootName&gt;</tt> (appended as <tt class="docutils literal">_&lt;NAME_POSTFIX&gt;</tt>).  If
the <tt class="docutils literal">NAME &lt;testRootName&gt;</tt> argument is given, this argument is ignored.</blockquote>
<p><tt class="docutils literal">DIRECTORY &lt;dir&gt;</tt></p>
<blockquote>
If specified, then the executable is assumed to be in the directory
given by by <tt class="docutils literal">&lt;dir&gt;</tt>.  The directory <tt class="docutils literal">&lt;dir&gt;</tt> can either be a relative
or absolute path.  If not specified, the executable is assumed to be in
the current bindary directory.</blockquote>
<p><tt class="docutils literal">ADD_DIR_TO_NAME</tt></p>
<blockquote>
If specified, then the directory name that this test resides in will be
added into the name of the test after the package name is added and
before the root test name (see below).  The directory will have the
package's base directory stripped off so only the unique part of the
test directory will be used.  All directory seperators will be changed
into underscores.</blockquote>
<p><tt class="docutils literal">RUN_SERIAL</tt></p>
<blockquote>
If specified then no other tests will be allowed to run while this test
is running. This is useful for devices(like cuda cards) that require
exclusive access for processes/threads.  This just sets the CTest test
property <tt class="docutils literal">RUN_SERIAL</tt> using the built-in CMake function
<tt class="docutils literal">SET_TESTS_PROPERTIES()</tt>.</blockquote>
<p><tt class="docutils literal">ARGS &quot;&lt;arg0&gt; &lt;arg1&gt; <span class="pre">...&quot;</span> &quot;&lt;arg2&gt; &lt;arg3&gt; <span class="pre">...&quot;</span> ...</tt></p>
<blockquote>
If specified, then a set of arguments can be passed in quotes.  If
multiple groups of arguments are passed in different quoted clusters of
arguments then a different test will be added for each set of arguments.
In this way, many different tests can be added for a single executable
in a single call to this function.  Each of these separate tests will be
named <tt class="docutils literal">${TEST_NAME}_xy</tt> where <tt class="docutils literal">xy</tt> = <tt class="docutils literal">00</tt>, <tt class="docutils literal">01</tt>, <tt class="docutils literal">02</tt>, and so
on.  <strong>WARNING:</strong> When defining multiple tests it is prefered to use the
<tt class="docutils literal">POSTFIX_AND_ARGS_&lt;IDX&gt;</tt> form instead.  <strong>WARNING:</strong> Multiple
arguments passed to a single test invocation must be quoted or multiple
tests taking single arguments will be created instead!  See <a class="reference internal" href="#adding-multiple-tests-tribits-add-test">Adding
Multiple Tests (TRIBITS_ADD_TEST())</a> for more details and exmaples.</blockquote>
<p><tt class="docutils literal">POSTFIX_AND_ARGS_&lt;IDX&gt; &lt;postfix&gt; &lt;arg0&gt; &lt;arg1&gt; ...</tt></p>
<blockquote>
<p>If specified, gives a sequence of sets of test postfix names and
arguments lists for different tests (up to <tt class="docutils literal">POSTFIX_AND_ARGS_19</tt>).
For example, a set of three different tests with argument lists can be
specified as:</p>
<pre class="literal-block">
POSTIFX_AND_ARGS_0 postfix0 --arg1 --arg2=&quot;dummy&quot;
POSTIFX_AND_ARGS_1 postfix1  --arg2=&quot;fly&quot;
POSTIFX_AND_ARGS_2 postfix2  --arg2=&quot;bags&quot;
</pre>
<p>This will create three different test cases with the postfix names
<tt class="docutils literal">postfix0</tt>, <tt class="docutils literal">postfix1</tt>, and <tt class="docutils literal">postfix2</tt>.  The indexes must be
consecutive starting a <tt class="docutils literal">0</tt> and going up to (currently) <tt class="docutils literal">19</tt>.  The
main advantages of using these arguments instead of just 'ARGS' are that
you can give meaningful name to each test case and you can specify
multiple arguments without having to quote them and you can allow long
argument lists to span multiple lines.  See <a class="reference internal" href="#adding-multiple-tests-tribits-add-test">Adding Multiple Tests
(TRIBITS_ADD_TEST())</a> for more details and exmaples.</p>
</blockquote>
<p><tt class="docutils literal">COMM [serial] [mpi]</tt></p>
<blockquote>
If specified, selects if the test will be added in serial and/or MPI
mode.  If the <tt class="docutils literal">COMM</tt> argument is missing, the test will be added in
both serial and MPI builds of the code.</blockquote>
<p><tt class="docutils literal">NUM_MPI_PROCS &lt;numProcs&gt;</tt></p>
<blockquote>
If specified, gives the number of processes that the test will be
defined to run.  If <tt class="docutils literal">&lt;numProcs&gt;</tt> is greater than
<tt class="docutils literal">${MPI_EXEC_MAX_NUMPROCS}</tt> then the test will be excluded.  If not
specified, then the default number of processes for an MPI build will be
<tt class="docutils literal">${MPI_EXEC_DEFAULT_NUMPROCS}</tt>.  For serial builds, this argument is
ignored.</blockquote>
<p><tt class="docutils literal">HOST &lt;host0&gt; &lt;host1&gt; ...</tt></p>
<blockquote>
If specified, gives a list of hostnames where the test will be included.
The current hostname is determined by the built-in CMake command
<tt class="docutils literal"><span class="pre">SITE_NAME(${PROJECT_NAME}_HOSTNAME)</span></tt>.  On Linux/Unix systems, this is
typically the value returned by 'uname -n'.  If this list is given, the
value of <tt class="docutils literal"><span class="pre">${${PROJECT_NAME}_HOSTNAME}</span></tt> must equal one of the listed
host names <tt class="docutils literal">&lt;hosti&gt;</tt> or test will not be added.  The value of
<tt class="docutils literal">${PROJECT_NAME}_HOSTNAME</tt> gets printed out in the TriBITS cmake
output under the section <tt class="docutils literal">Probing the environment</tt>.</blockquote>
<p><tt class="docutils literal">XHOST &lt;host0&gt; &lt;host1&gt; ...</tt></p>
<blockquote>
If specified, gives a list of hostnames (see <tt class="docutils literal">HOST</tt> argument) where
the test will <em>not</em> be added.  This check is performed after the check
for the hostnames in the <tt class="docutils literal">HOST</tt> list if it should exist.  Therefore,
this list exclusion list overrides the 'HOST' inclusion list.</blockquote>
<p><tt class="docutils literal">CATEGORIES &lt;category0&gt; &lt;category1&gt; ...</tt></p>
<blockquote>
If specified, gives the specific categories of the test.  Valid test
categories include <tt class="docutils literal">BASIC</tt>, <tt class="docutils literal">CONTINUOUS</tt>, <tt class="docutils literal">NIGHTLY</tt>, <tt class="docutils literal">WEEKLY</tt>
and <tt class="docutils literal">PERFORMANCE</tt>.  By default, the category is <tt class="docutils literal">BASIC</tt>.  When the
test category does not match <tt class="docutils literal">${PROJECT_NAME}_TEST_CATEGORIES</tt>, then
the test is not added.  When the <tt class="docutils literal">CATEGORIES</tt> is <tt class="docutils literal">BASIC</tt> it will
match <tt class="docutils literal">${PROJECT_NAME}_TEST_CATEGORIES</tt> eqaual to <tt class="docutils literal">CONTINUOUS</tt>,
<tt class="docutils literal">NIGHTLY</tt>, and <tt class="docutils literal">WEEKLY</tt>.  When the <tt class="docutils literal">CATEGORIES</tt> contains
<tt class="docutils literal">CONTINUOUS</tt> it will match <tt class="docutils literal">${PROJECT_NAME}_TEST_CATEGORIES</tt> equal
to <tt class="docutils literal">CONTINUOUS</tt>, <tt class="docutils literal">NIGHTLY</tt>, and <tt class="docutils literal">WEEKLY</tt>.  When the <tt class="docutils literal">CATEGORIES</tt>
is <tt class="docutils literal">NIGHTLY</tt> it will match <tt class="docutils literal">${PROJECT_NAME}_TEST_CATEGORIES</tt> equal
to <tt class="docutils literal">NIGHTLY</tt> and <tt class="docutils literal">WEEKLY</tt>.  When the <tt class="docutils literal">CATEGORIES</tt> is
<tt class="docutils literal">PERFORMANCE</tt> it will match
<tt class="docutils literal">${PROJECT_NAME}_TEST_CATEGORIES=PERFORMANCE</tt> only.</blockquote>
<p><tt class="docutils literal">HOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...</tt></p>
<blockquote>
If specified, gives the names of the host system type (given by
<tt class="docutils literal">CMAKE_HOST_SYSTEM_NAME</tt> which is printed in the TriBITS cmake
confgiure output in the section <tt class="docutils literal">Probing the environment</tt>) to include
the test.  Typical host system type names include <tt class="docutils literal">Linux</tt>, <tt class="docutils literal">Darwain</tt>
etc.</blockquote>
<p><tt class="docutils literal">XHOSTTYPE &lt;hosttype0&gt; &lt;hosttype1&gt; ...</tt></p>
<blockquote>
If specified, gives the names of the host system type to <em>not</em> include
the test.  This check is performed after the check for the host system
names in the <tt class="docutils literal">HOSTTYPE</tt> list if it should exist.  Therefore, this list
exclusion list overrides the <tt class="docutils literal">HOSTTYPE</tt> inclusion list.</blockquote>
<p><tt class="docutils literal">STANDARD_PASS_OUTPUT</tt></p>
<blockquote>
If specified, then the standard test output <tt class="docutils literal">End Result: TEST PASSED</tt>
is greped for to determine success.  This is needed for MPI tests on
some platforms since the return value is unreliable.  This is set using
the built-in ctest property <tt class="docutils literal">PASS_REGULAR_EXPRESSION</tt>.</blockquote>
<p><tt class="docutils literal">PASS_REGULAR_EXPRESSION <span class="pre">&quot;&lt;regex0&gt;;&lt;regex1&gt;;...&quot;</span></tt></p>
<blockquote>
If specified, then a test will be assumed to pass only if one of the
regular expressions <tt class="docutils literal">&lt;regex0&gt;</tt>, <tt class="docutils literal">&lt;regex1&gt;</tt> etc. match the output.
Otherwise, the test will fail.  This is set using the built-in test
property <tt class="docutils literal">PASS_REGULAR_EXPRESSION</tt>.  Consult standard CMake
documentation.</blockquote>
<p><tt class="docutils literal">FAIL_REGULAR_EXPRESSION <span class="pre">&quot;&lt;regex0&gt;;&lt;regex1&gt;;...&quot;</span></tt></p>
<blockquote>
If specified, then a test will be assumed to fail if one of the regular
expressions <tt class="docutils literal">&lt;regex0&gt;</tt>, <tt class="docutils literal">&lt;regex1&gt;</tt> etc. match the output.
Otherwise, the test will pass.  This is set using the built-in test
property <tt class="docutils literal">FAIL_REGULAR_EXPRESSION</tt>.</blockquote>
<p><tt class="docutils literal">WILL_FAIL</tt></p>
<blockquote>
If passed in, then the pass/fail criteria will be inverted.  This is set
using the built-in test property <tt class="docutils literal">WILL_FAIL</tt>.</blockquote>
<p><tt class="docutils literal">ENVIRONMENT <span class="pre">&lt;var0&gt;=&lt;value0&gt;</span> <span class="pre">&lt;var1&gt;=&lt;value1&gt;</span> ...</tt></p>
<blockquote>
If passed in, the listed environment varaibles will be set before
calling the test.  This is set using the built-in test property
<tt class="docutils literal">ENVIRONMENT</tt>.</blockquote>
<p><tt class="docutils literal">TIMEOUT &lt;maxSeconds&gt;</tt></p>
<blockquote>
If passed in, gives maximum number of seconds the test will be allowed
to run beforebeing timed-out.  This sets the test property <tt class="docutils literal">TIMEOUT</tt>.
<strong>WARNING:</strong> Rather than just increasing the timeout for an expensive
test, please try to either make the test run faster or relegate the test
to being run less often (i.e. set <tt class="docutils literal">CATEGORIES NIGHTLY</tt> or even
<tt class="docutils literal">WEEKLY</tt> for extremently expensive tests).  Expensive tests are one of
the worse forms of technical debt that a project can have!</blockquote>
</blockquote>
<p>In the end, this function just calls the built-in CMake commands
<tt class="docutils literal"><span class="pre">ADD_TEST(${TEST_NAME}</span> <span class="pre">...)</span></tt> and <tt class="docutils literal"><span class="pre">SET_TESTS_PROPERTIES(${TEST_NAME}</span>
<span class="pre">...)</span></tt> to set up a executable process for <tt class="docutils literal">ctest</tt> to run, determine
pass/fail criteria, and set some other test properties.  Therefore, this
wrapper funtion does not provide any fundamentally new features that are
already avaiable in the basic usage if CMake/CTest.  However, this wrapper
function takes care of many of the details and boiler-plate CMake code that
it takes to add such a test (or tests) and enforces consistency across a
large project for how tests are defined, run, and named (to avoid test name
clashes).</p>
<p>If more flexibility or control is needed when defining tests, then the
function <tt class="docutils literal">TRIBITS_ADD_ADVANCED_TEST()</tt> should be used instead.</p>
<p>In the following subsections, more details on how tests are defined and run
is given.</p>
<p id="determining-the-exectuable-or-command-to-run-tribits-add-test"><strong>Determining the Exectuable or Command to Run (TRIBITS_ADD_TEST())</strong></p>
<p>This funtion is primarily designed to make it easy to run tests for
exectaubles built using the function <a class="reference internal" href="#tribits-add-executable">TRIBITS_ADD_EXECUTABLE()</a>.  To set up
tests to run arbitrary executables, see below.</p>
<p>By default, the command to run for the executable is determined by first
getting the exectuable name which by default is assumed to be
<tt class="docutils literal">&lt;fullExeName</tt>&gt; =</p>
<pre class="literal-block">
${PACKAGE_NAME}_&lt;exeRootName&gt;${${PROJECT_NAME}_CMAKE_EXECUTABLE_SUFFIX}
</pre>
<p>which is (by no coincidence) idential to how it is selected in
<a class="reference internal" href="#tribits-add-executable">TRIBITS_ADD_EXECUTABLE()</a>.  This name can be alterned by passing in
<tt class="docutils literal">NOEXEPREFIX</tt>, <tt class="docutils literal">NOEXESUFFIX</tt>, and <tt class="docutils literal">ADD_DIR_TO_NAME</tt> as described in
<a class="reference internal" href="#executable-and-target-name-tribits-add-executable">Executable and Target Name (TRIBITS_ADD_EXECUTABLE())</a>.</p>
<p>By default, this executable is assumed to be in the current CMake binary
directory <tt class="docutils literal">${CMAKE_CURRENT_BINARY_DIR}</tt> but the directory location can be
changed using the <tt class="docutils literal">DIRECTORY &lt;dir&gt;</tt> argument.</p>
<p>If an arbitrary exectuable is to be run for the test, then pass in
<tt class="docutils literal">NOEXEPREFIX</tt> and <tt class="docutils literal">NOEXESUFFIX</tt> and set <tt class="docutils literal">&lt;exeRootName&gt;</tt> to the
relative or absolute path of the exeutable to be run.  If <tt class="docutils literal">&lt;exeRootName&gt;</tt>
is not an absolute path, then <tt class="docutils literal"><span class="pre">${CMAKE_CURRENT_BINARY_DIR}/&lt;exeRootName&gt;</span></tt>
is set as the executable to run.</p>
<p>Whatever executable path is specified using this logic, if the executable is
not found, then when <tt class="docutils literal">ctest</tt> goes to run the test, it will mark it as
<tt class="docutils literal">NOT RUN</tt>.</p>
<p id="determining-the-full-test-name-tribits-add-test"><strong>Determining the Full Test Name (TRIBITS_ADD_TEST())</strong></p>
<p>By default, the base test name is selected to be <tt class="docutils literal">&lt;fullTestName&gt;</tt> =</p>
<pre class="literal-block">
${PACKAGE_NAME}_&lt;exeRootName&gt;
</pre>
<p>If <tt class="docutils literal">NAME &lt;testRootName&gt;</tt> is passed in, then <tt class="docutils literal">&lt;testRootName&gt;</tt> is used
instead of <tt class="docutils literal">&lt;exeRootName&gt;</tt>.</p>
<p>If <tt class="docutils literal">NAME_POSTFIX &lt;testNamePostfix&gt;</tt> is passed in, then the base test name
is selected to be <tt class="docutils literal">&lt;fullTestName</tt> =</p>
<pre class="literal-block">
${PACKAGE_NAME}_&lt;exeRootName&gt;_&lt;testNamePostfix&gt;
</pre>
<p>If <tt class="docutils literal">ADD_DIR_TO_NAME</tt> is passed in, then the directory name realtive to the
package directory name is added to the name as well to help disambiguate the
test name (see the above).</p>
<p>Let the test name determined by this process be <tt class="docutils literal">TEST_NAME</tt>.  If no
arguments or one set of arguments are passed in through <tt class="docutils literal">ARGS</tt>, then this
is the test name actaully passed in to <tt class="docutils literal">ADD_TEST()</tt>.  If multiple tests
are defined, then this name becomes the base test name for each of the
tests. See below.</p>
<p>Finally, for any test that gets defined, if MPI is enabled
(i.e. <tt class="docutils literal">TPL_ENABLE_MPI=ON</tt>), then the terminal suffix
<cite>_MPI_${NUM_MPI_PROCS}</cite> will be added to the end of the test name (even for
multiple tests).  No such prefix is added for the serial case
(i.e. <tt class="docutils literal">TPL_ENABLE_MPI=OFF</tt>).</p>
<p id="adding-multiple-tests-tribits-add-test"><strong>Adding Multiple Tests  (TRIBITS_ADD_TEST())</strong></p>
<p>Using this function, one can add exectuable arguments and can even add
multiple tests in one of two ways.  One can either pass in 1 or more
<strong>quoted</strong> clusters of arguments using:</p>
<pre class="literal-block">
ARGS &quot;&lt;arg0&gt; &lt;arg1&gt; ...&quot; &quot;&lt;arg2&gt; &lt;arg3&gt; ...&quot; ...
</pre>
<p>or can pass in an explicit test name postfix and arguments with:</p>
<pre class="literal-block">
POSTFIX_AND_ARGS_0 &lt;postfix0&gt; &lt;arg0&gt; &lt;arg1&gt; ...
POSTFIX_AND_ARGS_1 &lt;postfix1&gt; &lt;arg2&gt; ...
...
</pre>
<p>If only one short set of arguments needs to be passed in, then passing:</p>
<pre class="literal-block">
ARGS &quot;&lt;arg0&gt; &lt;arg1&gt;&quot;
</pre>
<p>may be preferable since it will not add any postfix name to the test.  To
add more than one test case using <tt class="docutils literal">ARGS</tt>, you use more than one quoted set
of arugments such as with:</p>
<pre class="literal-block">
ARGS &quot;&lt;arg0&gt; &lt;arg1&gt;&quot; &quot;&lt;arg2&gt; &lt;arg2&gt;&quot;
</pre>
<p>which creates 2 tests with the names <tt class="docutils literal">&lt;fullTestName&gt;_00</tt> passing
arguments <tt class="docutils literal">&quot;&lt;arg0&gt; &lt;arg1&gt;&quot;</tt> and <tt class="docutils literal">&lt;fullTestName&gt;_01</tt> passing arguments
<tt class="docutils literal">&quot;&lt;arg2&gt; &lt;arg3&gt;&quot;</tt>.  However, when passing multiple sets of arguments it is
preferable to <strong>not</strong> use <tt class="docutils literal">ARGS</tt> but instead use:</p>
<pre class="literal-block">
POSTFIX_AND_ARGS_0 test_a &lt;arg0&gt; &lt;arg1&gt;
POSTFIX_AND_ARGS_1 test_b &lt;arg2&gt; &lt;arg2&gt;
</pre>
<p>which also creates the same 2 tests but now with the improved names
<tt class="docutils literal">&lt;fullTestName&gt;_test_a</tt> passing arguments <tt class="docutils literal">&quot;&lt;arg0&gt; &lt;arg1&gt;&quot;</tt> and
<tt class="docutils literal">&lt;fullTestName&gt;_test_b</tt> passing arguments <tt class="docutils literal">&quot;&lt;arg2&gt; &lt;arg3&gt;&quot;</tt>.  In this way,
the individual tests can be given more understandable names.</p>
<p>The other advantage of the <tt class="docutils literal">POSTFIX_AND_ARGS_&lt;IDX&gt;</tt> form is that the
arugments <tt class="docutils literal">&lt;arg0&gt;</tt>, <tt class="docutils literal">&lt;arg1&gt;</tt>, ... do not need to be quoted and can
therefore be extended over multiple lines like:</p>
<pre class="literal-block">
POSTFOX_AND_ARGS_0 long_args --this-is-the-first-long-arg=very
  --this-is-the-second-long-arg=verylong
</pre>
<p>If you don't use quotes when using <tt class="docutils literal">ARGS</tt> you actually get more than one
test.  For example, if you pass in:</p>
<pre class="literal-block">
ARGS --this-is-the-first-long-arg=very
  --this-is-the-second-long-arg=verylong
</pre>
<p>you actually get two tests, not one test.  This is a common mistake that
people make when using the <tt class="docutils literal">ARGS</tt> form of passing arguments.  This can't
be fixed or it will break backward compatibility.  If this could be designed
fresh, the <tt class="docutils literal">ARGS</tt> argument would only create a single test and the
arguments would not be quoted.</p>
<p id="determining-pass-fail-tribits-add-test"><strong>Determining Pass/Fail (TRIBITS_ADD_TEST())</strong></p>
<p>The only means to determine pass/fail is to use the built-in test properties
<tt class="docutils literal">PASS_REGULAR_EXPRESSION</tt> and <tt class="docutils literal">FAIL_REGULAR_EXPRESSION</tt> which can only
grep STDOUT/STDERR or to check for a 0 return value (or invert these using
<tt class="docutils literal">WILL_FAIL</tt>).  For simple tests, that is enough.  However, for more
complex executables, one may need to examine the output files to determine
pass fail.  Raw CMake/CTest cant' do this.  In this case, one should use
<a class="reference internal" href="#tribits-add-advanced-test">TRIBITS_ADD_ADVANCED_TEST()</a>.</p>
<p id="setting-additional-test-properties-tribits-add-test"><strong>Setting additional test properties (TRIBITS_ADD_TEST())</strong></p>
<p>After this function returns, any tests that get added using <tt class="docutils literal">ADD_TEST()</tt>
can have additional properties set and changed using
<tt class="docutils literal">SET_TEST_PROPERTIES()</tt>.  Therefore, any tests properties that are not
directly supported by this function and passed through this wrapper function
can be set in the outer <tt class="docutils literal">CMakeLists.txt</tt> file after the call to
<tt class="docutils literal">TRIBITS_ADD_TEST()</tt>.</p>
<p>ToDo: Describe how to use new variable ADDED_TESTS_OUT to get the list of
tests actually added (if they are added) in order to make it easy to set
additional test properties.</p>
<p id="debugging-and-examining-test-generation-tribits-add-test"><strong>Debugging and Examining Test Generation (TRIBITS_ADD_TEST())</strong></p>
<p>In order to see what tests are getting added and to debug some issues in
test creation, one can set the cache variable
<tt class="docutils literal">${PROJECT_NAME}_VERBOSE_CONFIGURE=ON</tt>.  This will result in the printout
of some information about the test getting added or not.</p>
<p>Also, CMake writes a file <tt class="docutils literal">CTestTestfile.cmake</tt> in the current binary
directory which contains all of the added tests and test properties that are
set.  This is the file that is read by <tt class="docutils literal">ctest</tt> when it runs to determine
what tests to run.  In that file, one can see the exact <tt class="docutils literal">ADD_TEST()</tt> and
<tt class="docutils literal">SET_TEST_PROPERTIES()</tt> commands.  The is the ultimate way to debug
exactly what tests are getting added by this function.</p>
<p id="disabling-tests-externally-tribits-add-test"><strong>Disabling Tests Externally (TRIBITS_ADD_TEST())</strong></p>
<p>The test can be disabled externally by setting the CMake cache variable
<tt class="docutils literal">${FULL_TEST_NAME}_DISABLE=TRUE</tt>.  This allows tests to be disable on a
case-by-case basis.  This is the <em>exact</em> name that shows up in 'ctest -N'
when running the test.  If multiple tests are added in this funtion through
multiple argument sets to <tt class="docutils literal">ARGS</tt> or through multiple
<tt class="docutils literal">POSTFIX_AND_ARGS_&lt;IDX&gt;</tt> arguments, then
<tt class="docutils literal">${FULL_TEST_NAME}_DISABLE=TRUE</tt> must be set for each test individually.</p>
</div>
<div class="section" id="tribits-add-test-directories">
<h3><a class="toc-backref" href="#id80">TRIBITS_ADD_TEST_DIRECTORIES()</a></h3>
<p>Macro called to add a set of test directories for an SE package.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ADD_TEST_DIRECTORIES(&lt;dir1&gt; &lt;dir2&gt; ...)
</pre>
<p>This macro only needs to be called from the top most CMakeList.txt file for
which all subdirectories are all &quot;tests&quot;.</p>
<p>This macro can be called several times within a package and it will have the
right effect.</p>
<p>Currently, really all it does macro does is to call
<tt class="docutils literal"><span class="pre">ADD_SUBDIRECTORY(&lt;diri&gt;)</span></tt> if <tt class="docutils literal">${PACKAGE_NAME}_ENABLE_TESTS</tt> or
<tt class="docutils literal">${PARENT_PACKAGE_NAME}_ENABLE_TESTS</tt> are true. However, this macro may be
extended in the futgure in order to modify behavior related to adding tests
and examples in a uniform way..</p>
</div>
<div class="section" id="tribits-allow-missing-external-packages">
<h3><a class="toc-backref" href="#id81">TRIBITS_ALLOW_MISSING_EXTERNAL_PACKAGES()</a></h3>
<p>Macro used in Dependencies.cmake files to allow some upstream dependent packages
to be missing.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_ALLOW_MISSING_EXTERNAL_PACKAGES(&lt;pack_1&gt; &lt;pack_2&gt; ...)
</pre>
<p>If the missing upstream SE package &lt;pack_i&gt; is optional, then the effect
will be to simply ignore the missing package and remove it from the
dependency list.  However, if the missing upstream SE package &lt;pack_i&gt; is
required, then in addition to ignoring the missing package, the current SE
(sub)package will also ee hard disabled,
i.e. ${PROJECT_NAME}_ENABLE_{CURRENT_PACKAGE}=OFF.</p>
<p>This function is typically used in packages in external TriBITS repos that
are depend on other packages in other exteral TriBITS repos that might be
missing.</p>
<p>NOTE: Using this function effectively turns off error checking for
misspelled package names so it is important to only use it when it
absolutely is needed.</p>
</div>
<div class="section" id="tribits-configure-file">
<h3><a class="toc-backref" href="#id82">TRIBITS_CONFIGURE_FILE()</a></h3>
<p>Macro that configures the package's main configured header file (typically
called <tt class="docutils literal">${PACKAGE_NAME}_config.h</tt> but any name can be used).</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_CONFIGURE_FILE(&lt;packageConfigFile&gt;)
</pre>
<p>This function requires the file:</p>
<pre class="literal-block">
${PACKAGE_SOURCE_DIR}/cmake/&lt;packageConfigFile&gt;.in
</pre>
<p>exists and it creates the file:</p>
<pre class="literal-block">
${CMAKE_CURRENT_BINARY_DIR}/&lt;packageConfigFile&gt;
</pre>
<p>by calling the built-in <tt class="docutils literal">CONFIGURE_FILE()</tt> command:</p>
<pre class="literal-block">
CONFIGURE_FILE(
  ${PACKAGE_SOURCE_DIR}/cmake/&lt;packageConfigFile&gt;.in
  ${CMAKE_CURRENT_BINARY_DIR}/&lt;packageConfigFile&gt;
  )
</pre>
<p>which does basic sustitution of CMake variables (see documentation for
built-in <tt class="docutils literal">CONFIGURE_FILE()</tt> command for rules on how it performs
substitutions).</p>
<p>In addition to just calling <tt class="docutils literal">CONFIGURE_FILE()</tt>, this function also aids in
creating configured header files adding macros for deprecating code.</p>
<p><strong>Deprecated Code Macros</strong></p>
<p>If <tt class="docutils literal">${PARENT_PACKAGE_NAME}_SHOW_DEPRECATED_WARNINGS</tt> is <tt class="docutils literal">TRUE</tt> (see
<a class="reference internal" href="#tribits-add-show-deprecated-warnings-option">TRIBITS_ADD_SHOW_DEPRECATED_WARNINGS_OPTION()</a>), then the local CMake
varible <tt class="docutils literal">${PARENT_PACKAGE_NAME_UC}_DEPRECATED_DECLARATIONS</tt> adds a define
<tt class="docutils literal">&lt;PARENT_PACKAGE_NAME_UC&gt;_DEPRECATED</tt> (where <tt class="docutils literal">&lt;PARENT_PACKAGE_NAME_UC&gt;</tt>
is the package name in all upper-case letters) add the compiler-specific
deprecated warning for an entity.  To use this, just add the line:</p>
<pre class="literal-block">
&#64;&lt;PARENT_PACKAGE_NAME_UC&gt;_DEPRECATED_DECLARATIONS&#64;
</pre>
<p>to the &lt;packageConfigFile&gt;.in file and it will be expended.</p>
<p>Then C/C++ code can use this macro to deprecate functions, variables,
classes, etc., for example, using:</p>
<pre class="literal-block">
&lt;PARENT_PACKAGE_NAME_UC&gt;_DEPRECATED class SomeDepreatedClass { ... }.
</pre>
<p>If the particular compiler does not support deprecated warnings, then this
macro is defined to be empty.  See <a class="reference internal" href="#regulated-backward-compatibility-and-deprecated-code">Regulated Backward Compatibility and
Deprecated Code</a> for more details.</p>
</div>
<div class="section" id="tribits-copy-files-to-binary-dir">
<h3><a class="toc-backref" href="#id83">TRIBITS_COPY_FILES_TO_BINARY_DIR()</a></h3>
<p>Function that copies a list of files from a soruce directory to a
destination directory at configure time, typically so that it can be used in
one or more tests.  This sets up all of the custom CMake commands and
targets to ensure that the files in the destiation directory are always up
to date just by building the <tt class="docutils literal">ALL</tt> target.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_COPY_FILES_TO_BINARY_DIR(
  &lt;targetName&gt;
  [SOURCE_FILES &lt;file1&gt; &lt;file2&gt; ...]
  [SOURCE_DIR &lt;sourceDir&gt;]
  [DEST_FILES &lt;dfile1&gt; &lt;dfile2&gt; ...]
  [DEST_DIR &lt;destDir&gt;]
  [TARGETDEPS &lt;targDep1&gt; &lt;targDep2&gt; ...]
  [EXEDEPS &lt;exeDep1&gt; &lt;exeDep2&gt; ...]
  [NOEXEPREFIX]
  [CATEGORIES &lt;category1&gt;  &lt;category2&gt; ...]
  )
</pre>
<p>This function has a few valid calling modes:</p>
<p><strong>1) Source files and destination files have the same name</strong>:</p>
<pre class="literal-block">
TRIBITS_COPY_FILES_TO_BINARY_DIR(
  &lt;targetName&gt;
  SOURCE_FILES &lt;file1&gt; &lt;file2&gt; ...
  [SOURCE_DIR &lt;sourceDir&gt;]
  [DEST_DIR &lt;destDir&gt;]
  [TARGETDEPS &lt;targDep1&gt; &lt;targDep2&gt; ...]
  [EXEDEPS &lt;exeDep1&gt; &lt;exeDep2&gt; ...]
  [NOEXEPREFIX]
  [CATEGORIES &lt;category1&gt;  &lt;category2&gt; ...]
  )
</pre>
<p>In this case, the names of the source files and the destination files
are the same but just live in different directories.</p>
<p><strong>2) Source files have a prefix different from the destination files</strong>:</p>
<pre class="literal-block">
TRIBITS_COPY_FILES_TO_BINARY_DIR(
  &lt;targetName&gt;
  DEST_FILES &lt;file1&gt; &lt;file2&gt; ...
  SOURCE_PREFIX &lt;srcPrefix&gt;
  [SOURCE_DIR &lt;sourceDir&gt;]
  [DEST_DIR &lt;destDir&gt;]
  [EXEDEPS &lt;exeDep1&gt; &lt;exeDep2&gt; ...]
  [NOEXEPREFIX]
  [CATEGORIES &lt;category1&gt;  &lt;category2&gt; ...]
  )
</pre>
<p>In this case, the source files have the same basic name as the
destination files except they have the prefix 'srcPrefix' appended
to the name.</p>
<p><strong>3) Source files and destination files have completely different names</strong>:</p>
<pre class="literal-block">
TRIBITS_COPY_FILES_TO_BINARY_DIR(
  &lt;targetName&gt;
  SOURCE_FILES &lt;sfile1&gt; &lt;sfile2&gt; ...
  [SOURCE_DIR &lt;sourceDir&gt;]
  DEST_FILES &lt;dfile1&gt; &lt;dfile2&gt; ...
  [DEST_DIR &lt;destDir&gt;]
  [EXEDEPS &lt;exeDep1&gt; &lt;exeDep2&gt; ...]
  [NOEXEPREFIX]
  [CATEGORIES &lt;category1&gt;  &lt;category2&gt; ...]
  )
</pre>
<p>In this case, the source files and destination files have completely
different prefixes.</p>
<p>The individual arguments are:</p>
<blockquote>
<p><tt class="docutils literal">SOURCE_FILES &lt;file1&gt; &lt;file2&gt; ...</tt></p>
<blockquote>
Listing of the source files relative to the source directory given by
the argument <tt class="docutils literal">SOURCE_DIR &lt;sourceDir&gt;</tt>.  If omited, this list will be
the same as <tt class="docutils literal">DEST_FILES</tt> with the argument <tt class="docutils literal">SOURCE_PREFIX
&lt;srcPrefix&gt;</tt> appended.</blockquote>
<p><tt class="docutils literal">SOURCE_DIR &lt;sourceDir&gt;</tt></p>
<blockquote>
Optional argument that gives (absolute) the base directory for all of the
source files.  If omited, this takes the default value of
<tt class="docutils literal">${CMAKE_CURRENT_SOURCE_DIR}</tt>.</blockquote>
<p><tt class="docutils literal">DEST_FILES &lt;file1&gt; &lt;file2&gt; ...</tt></p>
<blockquote>
Listing of the destination files relative to the destination directory
given by the argument <tt class="docutils literal">DEST_DIR &lt;destDir&gt;</tt> If omited, this list will
be the same as given by the <tt class="docutils literal">SOURCE_FILES</tt> list.</blockquote>
<p><tt class="docutils literal">DEST_DIR &lt;destDir&gt;</tt></p>
<blockquote>
Optional argument that gives the (absolute) base directory for all of the
destination files.  If omited, this takes the default value of
<tt class="docutils literal">${CMAKE_CURRENT_BINARY_DIR}</tt></blockquote>
<p><tt class="docutils literal">TARGETDEPS &lt;targDep1&gt; &lt;targDep2&gt; ...</tt></p>
<blockquote>
Listing of general CMake targets that these files will be added as
dependencies to.</blockquote>
<p><tt class="docutils literal">EXEDEPS &lt;exeDep1&gt; &lt;exeDep2&gt; ...</tt></p>
<blockquote>
Listing of executable targets that these files will be added as
dependencies to.  By default the prefix <tt class="docutils literal">${PACKAGE_NAME}_</tt> will is
appended to the names of the targets.  This ensures that if the
executable target is built that these files will also be copied as well.</blockquote>
<p><tt class="docutils literal">NOEXEPREFIX</tt></p>
<blockquote>
Option that determines if the prefix <tt class="docutils literal">${PACKAGE_NAME}_</tt> will be
appended to the arguments in the <tt class="docutils literal">EXEDEPS</tt> list.</blockquote>
</blockquote>
</div>
<div class="section" id="tribits-define-package-dependencies">
<h3><a class="toc-backref" href="#id84">TRIBITS_DEFINE_PACKAGE_DEPENDENCIES()</a></h3>
<p>Define the dependenices for a given TriBITS SE package (i.e. a top-level
package or a subpackage) in the package's
<a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a> file.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_DEFINE_PACKAGE_DEPENDENCIES(
   [LIB_REQUIRED_PACKAGES &lt;pkg1&gt; &lt;pkg2&gt; ...]
   [LIB_OPTIONAL_PACKAGES &lt;pkg1&gt; &lt;pkg2&gt; ...]
   [TEST_REQUIRED_PACKAGES &lt;pkg1&gt; &lt;pkg2&gt; ...]
   [TEST_OPTIONAL_PACKAGES &lt;pkg1&gt; &lt;pkg2&gt; ...]
   [LIB_REQUIRED_TPLS &lt;tpl1&gt; &lt;tpl2&gt; ...]
   [LIB_OPTIONAL_TPLS &lt;tpl1&gt; &lt;tpl2&gt; ...]
   [TEST_REQUIRED_TPLS &lt;tpl1&gt; &lt;tpl2&gt; ...]
   [TEST_OPTIONAL_TPLS &lt;tpl1&gt; &lt;tpl2&gt; ...]
   [REGRESSION_EMAIL_LIST  &lt;regression-email-address&gt;
   [SUBPACKAGES_DIRS_CLASSIFICATIONS_OPTREQS
     &lt;spkg1_name&gt;  &lt;spkg1_dir&gt;  &lt;spkg1_classifications&gt;  &lt;spkg1_optreq&gt;
     &lt;spkg2_name&gt;  &lt;spkg2_dir&gt;  &lt;spkg2_classifications&gt;  &lt;spkg2_optreq&gt;
     ...
     ]
   )
</pre>
<p>Every argument in this macro is optional.  The arguments that apply a package
itself are:</p>
<ul class="simple">
<li><strong>LIB_REQUIRED_PACKAGES:</strong> List of upstream packages that must be enabled
in order to build and use the libraries (or capabilities) in this
package.</li>
<li><strong>LIB_OPTIONAL_PACKAGES:</strong> List of additional optional upstream packages
that can be used in this package if enabled.  These upstream packages need
not be enabled in order to use this package but not enabling one or more
of these optional upstream packages will result in diminished capabilities
of this package.</li>
<li><strong>TEST_REQUIRED_PACKAGES:</strong> List of additional upstream packages that must
be enabled in order to build and/or run the tests and/or examples in this
packages.  If any of these upstream packages is not enabled, then there
will be no tests or examples defined or run for this package.</li>
<li><strong>TEST_OPTIONAL_PACKAGES:</strong> List of additional optional upstream packages
that can be used by the tests in this package.  These upstream packages
need not be enabled in order to run basic tests for this package.
Typically, extra tests that depend on optional test packages involve
integration testing of some type.</li>
<li><strong>LIB_REQUIRED_TPLS:</strong> List of upstream TPLs that must be enabled in order
to build and use the libraries (or capabilities) in this package.</li>
<li><strong>LIB_OPTIONAL_TPLS:</strong> List of additional optional upstream TPLs that can
be used in this package if enabled.  These upstream TPLs need not be
enabled in order to use this package but not enabling one or more of these
optional upstream TPLs will result in diminished capabilities of this
package.</li>
<li><strong>TEST_REQUIRED_TPLS:</strong> List of additional upstream TPLs that must
be enabled in order to build and/or run the tests and/or examples in this
packages.  If any of these upstream TPLs is not enabled, then there
will be no tests or examples defined or run for this package.</li>
<li><strong>TEST_OPTIONAL_TPLS:</strong> List of additional optional upstream TPLs
that can be used by the tests in this package.  These upstream TPLs
need not be enabled in order to run basic tests for this package.
Typically, extra tests that depend on optional test TPLs involve
integration testing of some type.</li>
</ul>
<p>Only upstream SE packages can be listed (as defined by the order the
packages are listed in <a class="reference internal" href="#tribits-define-repository-packages">TRIBITS_DEFINE_REPOSITORY_PACKAGES()</a> in the
<a class="reference internal" href="#repodir-packageslist-cmake">&lt;repoDir&gt;/PackagesList.cmake</a> file).  Otherwise an error will occur and
processing will stop.  Also, mispelled SE package names are caught as well.</p>
<p>Only direct package dependenices need to be listed.  Indirect package
dependencies are automatically handled.  For example, if this SE package
directly depends on PKG2 which depends on PKG1 (but this SE package does not
directly depend on anything in PKG1) then this package only needs to list a
dependency on PKG2, not PKG1.  The dependnecy on PKG1 will be taken care of
automatically by the TriBITS dependency tracking system.</p>
<p>However, currently, all TPL dependendies must be listed, even the indirect
ones.  This is a requirement that will be dropped in a future version of
TriBITS.</p>
<p>The packages listed in LIB_REQUIRED_PACKAGES are implicitly also
dependenices in TEST_REQUIRED_PACKAGES.  Likewise LIB_OPTIONAL_PACKAGES are
implicitly also dependenices in TEST_OPTIONAL_PACKAGES.  Same goes for TPL
dependencies.</p>
<p>The upstream dependencies within a single list do not need to be listed in
any order.  For example if <tt class="docutils literal">PKG2</tt> depends on <tt class="docutils literal">PKG1</tt>, and this given SE
package depends on both, one can list:</p>
<pre class="literal-block">
LIB_REQUIRED_PACKAGES PKG2 PKG1
</pre>
<p>or:</p>
<pre class="literal-block">
&quot;LIB_REQUIRED_PACKAGES PKG1 PKG2
</pre>
<p>Likewise the listing of TPLs order is not important.</p>
<p>If some upstream packages are allowed to be missing, this can be specified
by calling the macro <a class="reference internal" href="#tribits-allow-missing-external-packages">TRIBITS_ALLOW_MISSING_EXTERNAL_PACKAGES()</a>.</p>
<p>A top-level package can also have subpackages.  In this case, the following
varible must be set:</p>
<ul class="simple">
<li><strong>SUBPACKAGES_DIRS_CLASSIFICATIONS_OPTREQS:</strong> 2D array with rows listing
the subpackages and the columns:<ul>
<li><strong>SUBPACKAGE:</strong> The name of the subpackage &lt;spkg_name&gt;.  The full SE
package name is &quot;${PARENT_PACKAGE_NAME}&lt;spkg_name&gt;&quot;.  The full SE
package name is what is used in listing dependenices in other SE
packages.</li>
<li><strong>DIRS:</strong> The subdirectory &lt;spkg_dir&gt; relative to the parent package's
base directory.  All of the contents of the subpackage should be under
this subdirectory.  This is assumed by the TriBITS testing support
software when mapping modified files to SE packages that need to be
tested.</li>
<li><strong>CLASSIFICATIONS*</strong>: The test group PT, ST, EX and the maturity level
EP, RS, PG, PM, GRS, GPG, GPM, and UM, separated by a coma ',' with no
spaces in between (e.g. &quot;PT,GPM&quot;).  These have exactly the name meaning
as for full packages (see
<a class="reference internal" href="#tribits-define-repository-packages">TRIBITS_DEFINE_REPOSITORY_PACKAGES()</a>).</li>
<li><strong>OPTREQ:</strong> Determines if the outer parent package has an OPTIONAL or
REQUIRED dependence on this subpackage.</li>
</ul>
</li>
</ul>
<p>Other variables that this macro handles:</p>
<ul class="simple">
<li><strong>REGRESSION_EMAIL_LIST:</strong> The email list that is used to send CDash error
messages.  If this is missing, then the email list that CDash errors go to
is determined by other means (see <a class="reference internal" href="#cdash-regression-email-addresses">CDash regression email addresses</a>).</li>
</ul>
<p>NOTE: All this macro really does is to just define the variables:</p>
<ul class="simple">
<li>LIB_REQUIRED_DEP_PACKAGES</li>
<li>LIB_OPTIONAL_DEP_PACKAGES</li>
<li>TEST_REQUIRED_DEP_PACKAGES</li>
<li>TEST_OPTIONAL_DEP_PACKAGES</li>
<li>LIB_REQUIRED_DEP_TPLS</li>
<li>LIB_OPTIONAL_DEP_TPLS</li>
<li>TEST_REQUIRED_DEP_TPLS</li>
<li>TEST_OPTIONAL_DEP_TPLS</li>
<li>REGRESSION_EMAIL_LIST</li>
<li>SUBPACKAGES_DIRS_CLASSIFICATIONS_OPTREQS</li>
</ul>
<p>which are then read by the TriBITS cmake code to build the package
dependency graph.  The advantage of using this macro instead of just
directly setting the varibles is that you only need to list the dependencies
you have.  Otherwise, you need to set all of these varibles, even those that
are empty.  This is a error checking property of the TriBITS system to avoid
misspelling the names of these variables.</p>
</div>
<div class="section" id="tribits-define-repository-packages">
<h3><a class="toc-backref" href="#id85">TRIBITS_DEFINE_REPOSITORY_PACKAGES()</a></h3>
<p>Define the set of packages for a given TriBIT repo.  This macro is typically
called from inside of a <a class="reference internal" href="#repodir-packageslist-cmake">&lt;repoDir&gt;/PackagesList.cmake</a> file for a given
TriBITS repo.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_DEFINE_REPOSITORY_PACKAGES(
   &lt;pkg0&gt;  &lt;pkg0_dir&gt;  &lt;pkg0_classif&gt;
   &lt;pkg1&gt;  &lt;pkg1_dir&gt;  &lt;pkg1_classif&gt;
   ...
   )
</pre>
<p>This macro sets up a 2D array of NumPackages by NumColumns listing out the
packages for a TriBITS repository.  Each row (with 3 entries) specifies a
package which contains the 3 columns (ordered 0-2):</p>
<ol class="arabic simple" start="0">
<li><strong>PACKAGE</strong> (<tt class="docutils literal">&lt;pkgi&gt;</tt>): The name of the TriBITS package.  This name
must be unique across all other TriBITS packages in this or any other
TriBITS repo that might be combined into a single TriBITS project
meta-build.  The name should be a valid identifier (e.g. matches the
regex <tt class="docutils literal"><span class="pre">[a-zA-Z_][a-zA-Z0-9_]*</span></tt>).</li>
<li><strong>DIR</strong> (<tt class="docutils literal">&lt;pkgi_dir&gt;</tt>)): The relative directory for the package.  This
is relative to the TriBITS repository base directory.  Under this
directory will be a package-specific 'cmake/' directory with file
'cmake/Dependencies.cmake' and a base-level CMakeLists.txt file.  The
entire contents of the package including all of the source code and all
of the tests should be contained under this directory.  The TriBITS
testing infrastructure relies on the mapping of changed files to these
base directories when deciding what packages are modified and need to be
retested (along with downstream packages).</li>
<li><strong>CLASSIFICATION</strong> (<tt class="docutils literal">&lt;pkgi_classif&gt;</tt>)): Gives the testing group PT, ST,
EX and the maturity level EP, RS, PG, PM, GRS, GPG, GPM, UM.  These are
seprated by a coma with no space in between such as &quot;RS,PT&quot; for a
&quot;Research Stable&quot;, &quot;Primary Tested&quot; package.  No spaces are allowed so
that CMake treats this a one field in the array.  The maturity level can
be left off in which case it is assumed to be UM for &quot;Unspecified
Maturity&quot;.  This classification for individual packages can be changed to
<tt class="docutils literal">EX</tt> for specific platforms by calling
<a class="reference internal" href="#tribits-disable-package-on-platforms">TRIBITS_DISABLE_PACKAGE_ON_PLATFORMS()</a>.</li>
</ol>
<p><strong>IMPORTANT:</strong> The packages must be listed in increasing order of package
dependencies; there are no cyclic package dependencies allowed.  That is,
package <tt class="docutils literal">i</tt> can only list dependencies (in
<a class="reference internal" href="#packagedir-cmake-dependencies-cmake">&lt;packageDir&gt;/cmake/Dependencies.cmake</a>) for packages listed before this
package in this list (or in upstream TriBITS repositories).  This avoids an
expensive package sorting algorithm and makes it easy to flag packages with
circular dependencies or misspelling of package names.</p>
<p>NOTE: This macro just sets the varaible:</p>
<pre class="literal-block">
${REPOSITORY_NAME}_PACKAGES_AND_DIRS_AND_CLASSIFICATIONS
</pre>
<p>in the current
scope.  The advantages of using this macro instead of directly setting this
varible include:</p>
<ul class="simple">
<li>Asserts that the varible <tt class="docutils literal">REPOSITORY_NAME</tt> is defined and set</li>
<li>Avoids having to hard-code the assumed repository name
<tt class="docutils literal">${REPOSITORY_NAME}</tt>.  This provides more flexibility for how other
TriBITS project name a given TriBITS repo (i.e. the name of repo
subdirs).</li>
<li>Avoid mispelling the name of the varible
<tt class="docutils literal">${REPOSITORY_NAME}_PACKAGES_AND_DIRS_AND_CLASSIFICATIONS</tt>.  If you
misspell the name of the macro, it is an immediate error in CMake.</li>
</ul>
</div>
<div class="section" id="tribits-define-repository-tpls">
<h3><a class="toc-backref" href="#id86">TRIBITS_DEFINE_REPOSITORY_TPLS()</a></h3>
<p>Define the list of TPLs, find modules, and classifications for a given
TriBITS repository.  This macro is typically called from inside of a
TPLsList.cmake fil for a given TriBITS repo.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_DEFINE_REPOSITORY_TPLS(
  &lt;tpl0_name&gt;   &lt;tpl0_findmod&gt;  &lt;tpl0_classif&gt;
  &lt;tpl1_name&gt;   &lt;tpl1_findmod&gt;  &lt;tpl1_classif&gt;
  ...
  )
</pre>
<p>This macro sets up a 2D array of NumTPLS by NumColumns listing out the TPLs
for a TriBITS repository.  Each row (with 3 entries) specifies a package
which contains the 3 columns (ordered 0-2):</p>
<ol class="arabic simple" start="0">
<li><strong>TPL</strong> (<tt class="docutils literal">&lt;tpli_name&gt;</tt>)): The name of the TriBITS TPL <tt class="docutils literal">&lt;TPL_NAME&gt;</tt>.
This name must be unique across all other TriBITS TPLs in this or any
other TriBITS repo that might be combined into a single TriBITS project
meta-build.  However, a TPL can be redefined (see below).  The name should
be a valid identifier (e.g. matches the regex <tt class="docutils literal"><span class="pre">[a-zA-Z_][a-zA-Z0-9_]*</span></tt>).</li>
<li><strong>FINDMOD</strong> (<tt class="docutils literal">&lt;tpli_findmod&gt;</tt>): The relative path for the find module,
usually with the name <tt class="docutils literal"><span class="pre">FindTPL&lt;TPL_NAME&gt;.cmake</span></tt>.  This path is relative
to the repository base directory.  If just the base path for the find
module is given, ending with <tt class="docutils literal">&quot;/&quot;</tt> (e.g. <tt class="docutils literal">&quot;cmake/tpls/&quot;</tt>) then the
find module will be assumed to be under that this directory with the
standard name (e.g. <tt class="docutils literal"><span class="pre">cmake/tpls/FindTPL&lt;TPL_NAME&gt;.cmake</span></tt>).  A standard
way to write a <tt class="docutils literal"><span class="pre">FindTPL&lt;TPL_NAME&gt;.cmake</span></tt> module is to use the function
<a class="reference internal" href="#tribits-tpl-declare-libraries">TRIBITS_TPL_DECLARE_LIBRARIES()</a>.</li>
<li><strong>CLASSIFICATION</strong> (<tt class="docutils literal">&lt;tpl0_classif&gt;</tt>): Gives the testing group <tt class="docutils literal">PT</tt>,
<tt class="docutils literal">ST</tt>, <tt class="docutils literal">EX</tt> and the maturity level <tt class="docutils literal">EP</tt>, <tt class="docutils literal">RS</tt>, <tt class="docutils literal">PG</tt>, <tt class="docutils literal">PM</tt>,
<tt class="docutils literal">GRS</tt>, <tt class="docutils literal">GPG</tt>, <tt class="docutils literal">GPM</tt>, <tt class="docutils literal">UM</tt>.  These are seprated by a coma with no
space in between such as <tt class="docutils literal">&quot;RS,PT&quot;</tt> for a &quot;Research Stable&quot;, &quot;Primary
Tested&quot; package.  No spaces are allowed so that CMake treats this a one
field in the array.  The maturity level can be left off in which case it
is assumed by default to be <tt class="docutils literal">UM</tt> for &quot;Unspecified Maturity&quot;.</li>
</ol>
<p>A TPL defined in a upstream repo can listed again, which allows redefining
the find module that is used to specificy the TPL.  This allows downstream
repos to add additional requirements on a given TPL.  However, the
downstream repo's find module file must find the TPL components that are
fully compatible with the upstream's find module.</p>
<p>This macro just sets the varaible:</p>
<pre class="literal-block">
${REPOSITORY_NAME}_TPLS_FINDMODS_CLASSIFICATIONS
</pre>
<p>in the current scope.  The advantages of using this macro instead of
directly setting this varible include:</p>
<ul class="simple">
<li>Asserts that the varible <tt class="docutils literal">REPOSITORY_NAME</tt> is defined and set</li>
<li>Avoids having to hard-code the assumed repository name <tt class="docutils literal">${REPOSITORY_NAME}</tt>.
This provides more flexibility for how other TriBITS project name a given
TriBITS repo (i.e. the name of repo subdirs).</li>
<li>Avoid mispelling the name of the varible
<tt class="docutils literal">${REPOSITORY_NAME}_TPLS_FINDMODS_CLASSIFICATIONS</tt>.  If you misspell the
name of the macro, it is an immediate error in CMake.</li>
</ul>
</div>
<div class="section" id="tribits-disable-package-on-platforms">
<h3><a class="toc-backref" href="#id87">TRIBITS_DISABLE_PACKAGE_ON_PLATFORMS()</a></h3>
<p>Disable a package automatically for a list of platforms.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_DISABLE_PACKAGE_ON_PLATFORMS( &lt;packageName&gt;
  &lt;hosttype0&gt; &lt;hosttype1&gt; ...)
</pre>
<p>If any of the host-type arguments <tt class="docutils literal">&lt;hosttypei&gt;</tt> matches the
<tt class="docutils literal">${PROJECT_NAME}_HOSTTYPE</tt> variable for the current platform, then package
<tt class="docutils literal">&lt;packageName&gt;</tt> test group classification is changed to <tt class="docutils literal">EX</tt>.  Changing
the package test group classification to <tt class="docutils literal">EX</tt> results in the package being
disabled by default.  However, an explicit enable can still enable the
package.</p>
</div>
<div class="section" id="tribits-include-directories">
<h3><a class="toc-backref" href="#id88">TRIBITS_INCLUDE_DIRECTORIES()</a></h3>
<p>This function is to override the standard behavior of include_directories
for a TriBITS package.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_INCLUDE_DIRECTORIES(
  [REQUIRED_DURING_INSTALLATION_TESTING] &lt;dir0&gt; &lt;dir1&gt; ...
  )
</pre>
<p>If specified, <tt class="docutils literal">REQUIRED_DURING_INSTALLATION_TESTING</tt> can appear anywhere
in the argument list.</p>
<p>This function allows overriding the default behavior for installation
testing, to ensure that include directories will not be inadvertently added
to the build lines for tests during installation testing. Normally we want
the include directories to be handled as cmake usually does.  However during
TriBITS installation testing we do not want most of the include directories
to be used as the majority of the files should come from the installation we
are building against.  There is an exception to this and that is when there
are test only headers that are needed.  For that case we allow people to set
<tt class="docutils literal">REQUIRED_DURING_INSTALLATION_TESTING</tt> to tell us that this include
directory does need to be set for instaltion testing.</p>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id89">TRIBITS_PACKAGE()</a></h3>
<p>Macro called at the very beginning of a package's top-level CMakeLists.txt
file.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_PACKAGE(
  &lt;packageName&gt;
  [ENABLE_SHADOWING_WARNINGS]
  [DISABLE_STRONG_WARNINGS]
  [CLEANED]
  [DISABLE_CIRCULAR_REF_DETECTION_FAILURE]
  )
</pre>
<p>See <a class="reference internal" href="#tribits-package-decl">TRIBITS_PACKAGE_DECL()</a> for the documentation for the arguments and
<a class="reference internal" href="#tribits-package-decl">TRIBITS_PACKAGE_DECL()</a> and <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a> for a description the
side-effects (and varibles set) after calling this macro.</p>
</div>
<div class="section" id="tribits-package-decl">
<h3><a class="toc-backref" href="#id90">TRIBITS_PACKAGE_DECL()</a></h3>
<p>Macro called at the very beginning of a package's top-level CMakeLists.txt
file when a packages has subpackages.</p>
<p>If the package does not have subpackages, just call <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a>
which calls this macro.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_PACKAGE_DECL(
  &lt;packageName&gt;
  [ENABLE_SHADOWING_WARNINGS]
  [DISABLE_STRONG_WARNINGS]
  [CLEANED]
  [DISABLE_CIRCULAR_REF_DETECTION_FAILURE]
  )
</pre>
<p>The arguments are:</p>
<blockquote>
<p><tt class="docutils literal">&lt;packageName&gt;</tt></p>
<blockquote>
Gives the name of the Package, mostly just for checking and
documentation purposes.  This much match the name of the package
provided in the PackagesLists.cmake or it is an error.</blockquote>
<p><tt class="docutils literal">ENABLE_SHADOWING_WARNINGS</tt></p>
<blockquote>
If specified, then shadowing warnings will
be turned on for supported platforms/compilers.  The default is for
shadowing warnings to be turned off.  Note that this can be overridden
globally by setting the cache variable
${PROJECT_NAME}_ENABLE_SHADOWING_WARNINGS.</blockquote>
<p><tt class="docutils literal">DISABLE_STRONG_WARNINGS</tt></p>
<blockquote>
If specified, then all strong warnings will be turned off, if they are
not already turned off by global cache variables.  Strong warnings are
turned on by default in development mode.</blockquote>
<p><tt class="docutils literal">CLEANED</tt></p>
<blockquote>
If specified, then warnings will be promoted to errors for all defined
warnings.</blockquote>
<p><tt class="docutils literal">DISABLE_CIRCULAR_REF_DETECTION_FAILURE</tt></p>
<blockquote>
If specified, then the
standard grep looking for RCPNode circular references that causes tests to
fail will be disabled.  Note that if these warnings are being produced
then it means that the test is leaking memory and user like may also be
leaking memory.</blockquote>
</blockquote>
<p>There are several side-effects of calling this macro:</p>
<ul class="simple">
<li>The the varibles listed the packages set of library targets
<tt class="docutils literal">${PACKAGE_NAME}_LIB_TARGETS</tt> and all targets
<tt class="docutils literal">${PACKAGE_NAME}_ALL_TARGETS</tt> and are initialized to emtpy.</li>
<li>The local varibles <tt class="docutils literal">PACKAGE_SOURCE_DIR</tt> and <tt class="docutils literal">PACKAGE_BINARY_DIR</tt> are
set for this package's use in its CMakeLists.txt files.</li>
<li>Package-specific compiler options are set up in package-scoped (i.e., the
package's subdir and its subdirs) in <tt class="docutils literal">CMAKE_&lt;LANG&gt;_FLAG</tt>.</li>
<li>This packages's cmake subdir <tt class="docutils literal"><span class="pre">${PACKAGE_SOURCE_DIR}/cmake</span></tt> is added to
<tt class="docutils literal">CMAKE_MODULE_PATH</tt> locally so that the package's try-compile modules
can be read in with just a raw <tt class="docutils literal">INCLUDE()</tt> leaving off the full path and
the <tt class="docutils literal">*.cmake</tt> extension.</li>
</ul>
</div>
<div class="section" id="tribits-package-def">
<h3><a class="toc-backref" href="#id91">TRIBITS_PACKAGE_DEF()</a></h3>
<p>Macro called after subpackages are processed in order to
handle the libraries, tests, and examples of the final package.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_PACKAGE_DEF()
</pre>
<p>If the package does not have subpackages, just call <a class="reference internal" href="#id7">TRIBITS_PACKAGE()</a>
which calls this macro.</p>
<p>This macro has several side effects:</p>
<ul class="simple">
<li>The varible <tt class="docutils literal">PACKAGE_NAME</tt> is set in the local scope for usage by the
package's CMakeLists.txt files.</li>
<li>The intra-package dependency varibles (i.e. list of include directoires,
list of libraries, etc.) are initialized to emtpy.</li>
</ul>
</div>
<div class="section" id="tribits-package-postprocess">
<h3><a class="toc-backref" href="#id92">TRIBITS_PACKAGE_POSTPROCESS()</a></h3>
<p>Macro called at the very end of a package's top-level CMakeLists.txt file.
This macro performs some critical post-processing activities before
downstream packages are processed.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_PACKAGE_POSTPROCESS()
</pre>
<p>NOTE: It is unfortunate that a packages's CMakeLists.txt file must call this
macro but limitations of the CMake language make it necessary to do so.</p>
</div>
<div class="section" id="tribits-process-subpackages">
<h3><a class="toc-backref" href="#id93">TRIBITS_PROCESS_SUBPACKAGES()</a></h3>
<p>Macro that processes subpackages for packages that have them.  This is
called in the parent packages top-level CMakeLists.txt file.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_PROCESS_SUBPACKAGES()
</pre>
<p>Must be called after <a class="reference internal" href="#tribits-package-decl">TRIBITS_PACKAGE_DECL()</a> but before
<a class="reference internal" href="#tribits-package-def">TRIBITS_PACKAGE_DEF()</a>.</p>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id94">TRIBITS_PROJECT()</a></h3>
<p>Defines and processes a TriBITS project.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_PROJECT()
</pre>
<p>Requires that the project name variable <tt class="docutils literal">PROJECT_NAME</tt> be defined before
calling this macro.  Also, all default values for project settings should be
set before calling this (see <a class="reference internal" href="#tribits-global-project-settings">TriBITS Global Project Settings</a>).  Also, the
variable <tt class="docutils literal">${PROJECT_NAME}_TRIBITS_DIR</tt> must be set as well.</p>
<p>This macro then adds all of the necssary paths to <tt class="docutils literal">CMAKE_MODULE_PATH</tt> and
then performs all processing of the TriBITS project files (see ???).</p>
<p>ToDo: Give documentation!</p>
</div>
<div class="section" id="tribits-project-define-extra-repositories">
<h3><a class="toc-backref" href="#id95">TRIBITS_PROJECT_DEFINE_EXTRA_REPOSITORIES()</a></h3>
<p>Declare a set of extra extra repositories for a project (typically in the
project's <a class="reference internal" href="#projectdir-cmake-extrarepositorieslist-cmake">&lt;projectDir&gt;/cmake/ExtraRepositoriesList.cmake</a> file).</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_PROJECT_DEFINE_EXTRA_REPOSITORIES(
  &lt;repo0_name&gt; &lt;repo0_dir&gt; &lt;repo0_type&gt; &lt;repo0_url&gt; &lt;repo0_packstat&gt; &lt;repo0_classif&gt;
  &lt;repo1_name&gt; &lt;repo1_dir&gt; &lt;repo1_type&gt; &lt;repo1_url&gt; &lt;rep10_packstat&gt; &lt;repo1_classif&gt;
  ...
 )
</pre>
<p>This macro takes in a 2D array with 6 columns, where each row defines an
extra repository.  The 6 columns (ordered 0-5) are:</p>
<ol class="arabic simple" start="0">
<li><strong>REPO_NAME</strong> (<tt class="docutils literal">&lt;repoi_name&gt;</tt>): The name given to the repository
<tt class="docutils literal">REPOSITORY_NAME</tt>.</li>
<li><strong>REPO_DIR</strong> (<tt class="docutils literal">&lt;repoi_dir&gt;</tt>): The relative directory for the repository
under the project directory <tt class="docutils literal">${PROJECT_SOURCE_DIR}</tt> (or
<tt class="docutils literal">&lt;projectDir&gt;</tt>).  If this is set to empty quoted string <tt class="docutils literal">&quot;&quot;`</tt>, then
the relative directory name is assumed to be same as the repository name
<tt class="docutils literal">&lt;repoi_name&gt;</tt>.</li>
<li><strong>REPO_TYPE</strong> (<tt class="docutils literal">&lt;repoi_type&gt;</tt>): The version control (VC) type of the
repo.  Value choses include <tt class="docutils literal">GIT</tt> and <tt class="docutils literal">SVN</tt> (i.e. Subversion).
<em>WARNING:</em> Only VC repos of type <tt class="docutils literal">GIT</tt> can fully participate in the
TriBITS development tool workflows.  The other VC types are supported for
basic cloning and updating using the <tt class="docutils literal">TribitsCTestDriverCore.cmake</tt>
script.</li>
<li><strong>REPO_URL</strong> (<tt class="docutils literal">&lt;repoi_url&gt;</tt>): The URL of the VC repo.  This info is
used to initially obtain the repo source code using the VC tool listed in
<tt class="docutils literal">&lt;repoi_type&gt;</tt>.  If the repos don't need to be cloned for needed use
cases, then this can be the empty quoted string <tt class="docutils literal">&quot;&quot;</tt>.</li>
<li><strong>REPO_PACKSTAT</strong> (<tt class="docutils literal">&lt;repoi_packstat&gt;</tt>): Determines if the VC repository
contains any TriBITS packages or if it just provides directories and
files.  If the VC repo contains TriBITS packages, then this field is set
as the empty quoted string <tt class="docutils literal">&quot;&quot;</tt>, then this repository is considered to
be a <a class="reference internal" href="#tribits-repository">TriBITS Repository</a> and must therefore contain the files described
in <a class="reference internal" href="#tribits-repository-core-files">TriBITS Repository Core Files</a>.  If the listed repository is <strong>not</strong>
a TriBITS repository, and just provideds directories and packages, then
this field is set as <tt class="docutils literal">NOPACKAGES</tt>.</li>
<li><strong>REPO_CLASSIFICATION</strong> (<tt class="docutils literal">&lt;repoi_classif&gt;</tt>): Gives the testing
classification of the repository which also happens to be the CTest/CDash
testing mode and the default dashboard track.  The valid values are
<tt class="docutils literal">Continuous</tt>, <tt class="docutils literal">Nightly</tt>, and <tt class="docutils literal">Experimental</tt>.  See <a class="reference internal" href="#tribits-package-by-package-ctest-dash-driver">TriBITS
Package-by-Package CTest/Dash Driver</a> for a detailed description of
repository classifications.</li>
</ol>
<p>This command is used to put together one or more VC and/or TriBITS
repositories to construct a larger project.  Files that contain this macro
call are what is passed in for the option <a class="reference external" href="../build_quick_ref/TribitsBuildQuickRef.html#project-extrarepos-file">&lt;Project&gt;_EXTRAREPOS_FILE</a>).
Repositories with <tt class="docutils literal"><span class="pre">&lt;repoi_packstat&gt;=&quot;&quot;</span></tt> are <strong>not</strong> TriBITS Repositories
and are technically not considered at all during the basic configuration of
the a TriBITS project.  They are only listed in this file so that they can
be used in the version control logic for tools that perform version control
with the repositories (such as cloning, updating, looking for changed files,
etc.).</p>
<p><strong>NOTE</strong>: These repositories must be listed in the order of package
dependencies.  That is, all of the packages listed in repository <tt class="docutils literal">i</tt> must
have upstream TPL and SE package dependencies listed before this package in
this repository or in upstream repositories <tt class="docutils literal"><span class="pre">i-1</span></tt>, <tt class="docutils literal"><span class="pre">i-2</span></tt>, etc.</p>
<p>NOTE: This module just sets the local varaible:</p>
<pre class="literal-block">
${PROJECT_NAME}_EXTRAREPOS_DIR_REPOTYPE_REPOURL_PACKSTAT_CATEGORY
</pre>
<p>in the current scope.  The advantages of using this macro instead of
directly setting this varible include:</p>
<ul class="simple">
<li>Asserts that the varible <tt class="docutils literal">PROJECT_NAME</tt> is defined and set.</li>
<li>Avoids having to hard-code the assumed project name <tt class="docutils literal">${PROJECT_NAME}</tt>.
This provides more flexibility for how other TriBITS project name a given
TriBITS repo (i.e. the name of repo subdirs).</li>
<li>Avoid mispelling the name of the varible
<tt class="docutils literal">${PROJECT_NAME}_EXTRAREPOS_DIR_REPOTYPE_REPOURL_PACKSTAT_CATEGORY</tt>.  If
you misspell the name of the macro, it is an immediate error in CMake.</li>
</ul>
</div>
<div class="section" id="tribits-set-st-for-dev-mode">
<h3><a class="toc-backref" href="#id96">TRIBITS_SET_ST_FOR_DEV_MODE()</a></h3>
<p>Function that allows packages to easily make a feature <tt class="docutils literal">ST</tt> for
development builds and <tt class="docutils literal">PT</tt> for release builds by default.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_SET_ST_FOR_DEV_MODE(&lt;outputVar&gt;)
</pre>
<p><tt class="docutils literal"><span class="pre">${&lt;outputVar&gt;}</span></tt> is set to <tt class="docutils literal">ON</tt> or <tt class="docutils literal">OFF</tt> based on the configure state.
In development mode (i.e. <tt class="docutils literal"><span class="pre">${PROJECT_NAME}_ENABLE_DEVELOPMENT_MODE==ON</span></tt>),
<tt class="docutils literal"><span class="pre">${&lt;outputVar&gt;}</span></tt> will be set to <tt class="docutils literal">ON</tt> only if <tt class="docutils literal">ST</tt> code is enabled
(i.e. <tt class="docutils literal"><span class="pre">${PROJECT_NAME}_ENABLE_SECONDARY_TESTED_CODE==ON</span></tt>), otherwise it is
set to <tt class="docutils literal">OFF</tt>. In release mode
(i.e. <tt class="docutils literal"><span class="pre">${PROJECT_NAME}_ENABLE_DEVELOPMENT_MODE==OFF</span></tt>) it is always set to
<tt class="docutils literal">ON</tt>.  This allows some sections of a TriBITS package to be considered
<tt class="docutils literal">ST</tt> for development mode reducing testing time which includes only <tt class="docutils literal">PT</tt>
code., while still having important functionality available to users by
default in a release.</p>
</div>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id97">TRIBITS_SUBPACKAGE()</a></h3>
<p>Declare a subpackage.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_SUBPACKAGE(&lt;spkgName&gt;)
</pre>
<p>Once called, the following local varibles are in scope:</p>
<blockquote>
<p><tt class="docutils literal">PARENT_PACKAGE_NAME</tt></p>
<blockquote>
The name of the parent package.</blockquote>
<p><tt class="docutils literal">SUBPACKAGE_NAME</tt></p>
<blockquote>
The local name of the subpackage (does not contain
the parent package name).</blockquote>
<p><tt class="docutils literal">SUBPACKAGE_FULLNAME</tt></p>
<blockquote>
The full project-level name of the subpackage (which includes the parent
package name at the beginning).</blockquote>
<p><tt class="docutils literal">PACKAGE_NAME</tt></p>
<blockquote>
Inside the subpackage, the same as <tt class="docutils literal">SUBPACKAGE_FULLNAME</tt>.</blockquote>
</blockquote>
</div>
<div class="section" id="tribits-subpackage-postprocess">
<h3><a class="toc-backref" href="#id98">TRIBITS_SUBPACKAGE_POSTPROCESS()</a></h3>
<p>Postprocess after defining a subpackage.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_SUBPACKAGE_POSTPROCESS()
</pre>
<p>NOTE: It is unfortunate that a Subpackages's CMakeLists.txt file must call
this macro but limitations of the CMake language make it necessary to do so.</p>
</div>
<div class="section" id="tribits-tpl-declare-libraries">
<h3><a class="toc-backref" href="#id99">TRIBITS_TPL_DECLARE_LIBRARIES()</a></h3>
<p>Function that sets up cache variables for users to specify where to find a
TPL's headers and libraries.  This function is typically called inside of a
file <tt class="docutils literal"><span class="pre">FindTPL&lt;tpl_name&gt;.cmake</span></tt> file.</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_TPL_DECLARE_LIBRARIES(
  &lt;tpl_name&gt;
  [REQUIRED_HEADERS &lt;header1&gt; &lt;header2&gt; ...]
  [MUST_FIND_ALL_HEADERS]
  [REQUIRED_LIBS_NAMES &lt;libname1&gt; &lt;libname2&gt; ...]
  [MUST_FIND_ALL_LIBS]
  [NO_PRINT_ENABLE_SUCCESS_FAIL]
  )
</pre>
<p>This function can set up a with header files and/or libraries.</p>
<p>The input arguments to this function are:</p>
<ul>
<li><p class="first"><tt class="docutils literal">&lt;tpl_name&gt;</tt>: Name of the TPL that is listed in a TPLsList.cmake file.
Below, this is referted to as the local CMake variable <tt class="docutils literal">TPL_NAME</tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal">REQUIRED_HEADERS</tt>: List of header files that are searched for the TPL
using <tt class="docutils literal">FIND_PATH()</tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal">MUST_FIND_ALL_HEADERS</tt>:  If set, then all of the header files listed in
REQUIRED_HEADERS must be found in order for TPL_${TPL_NAME}_INCLUDE_DIRS
to be defined.</p>
</li>
<li><p class="first"><tt class="docutils literal">REQUIRED_LIBS_NAMES</tt>: List of libraries that are searched for when
looked for the TPLs libraries with FIND_LIBRARY(...).</p>
</li>
<li><p class="first"><tt class="docutils literal">MUST_FIND_ALL_LIBS</tt>:  If set, then all of the library files listed in
REQUIRED_LIBS_NAMES must be found or the TPL is considered not
found!</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal">NO_PRINT_ENABLE_SUCCESS_FAIL</tt>: If set, then the final success/fail</dt>
<dd><p class="first last">will not be printed</p>
</dd>
</dl>
</li>
</ul>
<p>The following cache variables, if set, will be used by that this function:</p>
<ul class="simple">
<li><tt class="docutils literal">${TPL_NAME}_INCLUDE_DIRS:PATH</tt>: List of paths to search first for
header files defined in <tt class="docutils literal">REQUIRED_HEADERS</tt>.</li>
<li><tt class="docutils literal">${TPL_NAME}_INCLUDE_NAMES:STIRNG</tt>: List of include names to be looked
for instead of what is specified in REQUIRED_HEADERS.</li>
<li><tt class="docutils literal">${TPL_NAME}_LIBRARY_DIRS:PATH</tt>: The list of directories to search first
for libraies defined in REQUIRED_LIBS_NAMES.</li>
<li><tt class="docutils literal">${TPL_NAME}_LIBRARY_NAMES:STIRNG</tt>: List of library names to be looked
for instead of what is specified in REQUIRED_LIBS_NAMES.</li>
</ul>
<p>This function sets global varibles to return state so it can be called from
anywhere in the call stack.  The following cache variables defined that are
intended for the user to set and/or use:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">TPL_${TPL_NAME}_INCLUDE_DIRS</span></tt>: A list of common-separated full
directory paths that contain the TPLs headers.  If this varible is set
before calling this function, then no headers are searched for and this
variable will be assumed to have the correct list of header paths.</li>
<li><tt class="docutils literal"><span class="pre">TPL_${TPL_NAME}_LIBRARIES</span></tt>: A list of commons-seprated full library
names (output from FIND_LIBRARY(...)) for all of the libraries found for
the TPL.  IF this varible is set before calling this function, no
libraries are searched for and this varaible will be assumed to have the
correct list of libraries to link to.</li>
</ul>
</div>
<div class="section" id="tribits-write-flexible-package-client-export-files">
<h3><a class="toc-backref" href="#id100">TRIBITS_WRITE_FLEXIBLE_PACKAGE_CLIENT_EXPORT_FILES()</a></h3>
<p>Utility function for writing ${PACKAGE_NAME}Config.cmake and/or the
Makefile.export.${PACKAGE_NAME} for package PACKAGE_NAME with some greater
flexibility than TRIBITS_WRITE_PACKAGE_CLIENT_EXPORT_FILES()</p>
<p>Usage:</p>
<pre class="literal-block">
TRIBITS_WRITE_FLEXIBLE_PACKAGE_CLIENT_EXPORT_FILES(
  PACKAGE_NAME &lt;pakageName&gt;
  [EXPORT_FILE_VAR_PREFIX &lt;exportFileVarPrefix&gt;]
  [WRITE_CMAKE_CONFIG_FILE &lt;cmakeConfigFileFullPath&gt;]
  [WRITE_EXPORT_MAKLEFILE &lt;exportMakefileFileFullPath&gt;]
  [WRITE_INSTALL_CMAKE_CONFIG_FILE]
  [WRITE_INSTALL_EXPORT_MAKLEFILE]
  )
</pre>
<p>The arguments are:</p>
<blockquote>
<p><tt class="docutils literal">PACKAGE_NAME &lt;pakageName&gt;</tt></p>
<blockquote>
Gives the name of the TriBITS package for which the export files should be
created for.</blockquote>
<p><tt class="docutils literal">EXPORT_FILE_VAR_PREFIX &lt;exportFileVarPrefix&gt;</tt></p>
<blockquote>
If specified, then all of the varibles in the generated export files will
be prefixed with &quot;&lt;exportFileVarPrefix&gt;_&quot; instead of &quot;${PACKAGE_NAME}_&quot;.
This is to provide flexibility.</blockquote>
<p><tt class="docutils literal">WRITE_CMAKE_CONFIG_FILE &lt;cmakeConfigFileFullPath&gt;</tt></p>
<blockquote>
If specified, then the package &lt;packageName&gt;'s cmake configure export file
for extenral CMake client projects will be created in the file
&lt;cmakeConfigFileFullPath&gt;.  NOTE: the argument should be the full path!</blockquote>
<p><tt class="docutils literal">WRITE_EXPORT_MAKLEFILE &lt;exportMakefileFileFullPath&gt;</tt></p>
<blockquote>
If specified, then the package &lt;packageName&gt;'s cmake configure export file
for external Makefile client projects will be created in the file
&lt;exportMakefileFileFullPath&gt;.  NOTE: the argument should be the full path!</blockquote>
<p><tt class="docutils literal">WRITE_INSTALL_CMAKE_CONFIG_FILE</tt></p>
<blockquote>
If specified, then the package &lt;packageName&gt;'s install cmake configure
export to be installed will be written.  The name and location of this
file is hard-coded.</blockquote>
<p><tt class="docutils literal">WRITE_INSTALL_EXPORT_MAKLEFILE</tt></p>
<blockquote>
If specified, then the package &lt;packageName&gt;'s install export makefile to
be installed will be written.  The name and location of this file is
hard-coded.</blockquote>
</blockquote>
<p>NOTE: The arguments to this function may look strange but the motivation is
to support versy speicalized use cases such as when a TriBITS package needs
to generate an export makefile for a given package but name the export
makefile differently and use different variable name prefixes.  The
particular driver use case is when wrapping an external autotools project
that depends on Trilinos and needs to read in the Makefile.export.Trilinos
file but this file needs to be generated for a subset of enabled packages on
the fly during a one-pass configure.</p>
<p>NOTE: This function does <em>not</em> contain the the INSTALL() commands because
CMake will not allow those to even be present in scripting mode that is used
for unit testing this function.</p>
</div>
</div>
<div class="section" id="general-utility-macros-and-functions">
<h2><a class="toc-backref" href="#id101">12.3&nbsp;&nbsp;&nbsp;General Utility Macros and Functions</a></h2>
<p>The following subsections give detailed documentation for some CMake macros
and functions which are <em>not</em> a core part of the TriBITS system but are
included in the TriBITS system that are used inside of the TriBITS system and
are provided as a convenience to TriBITS project developers.  One will see
many of these functions and macros used throughout the implementation of
TriBITS and even in the <tt class="docutils literal">CMakeLists.txt</tt> files for projects that use
TriBITS.</p>
<p>These macros and functions are <em>not</em> prefixed with <tt class="docutils literal">TRIBITS_</tt>.  There is
really not a large risk to defining and using these non-namespaces utility
functions and macros.  It turns out that CMake allows you to redefine any
macro or function, even built-in ones, inside of your project so even if CMake
did add new comamnds that clashed with these names, there would be no
conflicit.  When overridding a built-in command <tt class="docutils literal">some_builtin_command()</tt>,
you can always access the original built-in command as
<tt class="docutils literal">_some_builtin_command()</tt>.</p>
<!-- WARNING: The file UtilsMacroFunctionDoc.rst is autogenerated from -->
<!-- the file UtilsMacroFunctionDocTemplate.rst in the script -->
<!-- generate-dev-guide.sh.  Only the file UtilsMacroFunctionDoc.rst -->
<!-- should be directly modified! -->
<div class="section" id="add-subdirectories">
<h3><a class="toc-backref" href="#id102">ADD_SUBDIRECTORIES()</a></h3>
<p>Macro that adds a list of subdirectories all at once (removed boiler-place
code).</p>
<p>Usage:</p>
<pre class="literal-block">
ADD_SUBDIRECTORIES(&lt;dir1&gt; &lt;dir2&gt; ...)
</pre>
</div>
<div class="section" id="advanced-option">
<h3><a class="toc-backref" href="#id103">ADVANCED_OPTION()</a></h3>
<p>Macro that sets an option and marks it as advanced (removes boiler-plate and
duplication).</p>
<p>Usage:</p>
<pre class="literal-block">
ADVANCED_OPTION(&lt;varName&gt; [other arguments])
</pre>
<p>This is identical to:</p>
<pre class="literal-block">
ADVANCED_OPTION(&lt;varName&gt; [other arguments])
MARK_AS_ADVANCED(&lt;varName&gt;)
</pre>
</div>
<div class="section" id="advanced-set">
<h3><a class="toc-backref" href="#id104">ADVANCED_SET()</a></h3>
<p>Macro that sets a variable and marks it as advanced (removes boiler-plate
and duplication).</p>
<p>Usage:</p>
<pre class="literal-block">
ADVANCED_SET(&lt;varName&gt; [other arguments])
</pre>
<p>This is identical to:</p>
<pre class="literal-block">
ADVANCED_SET(&lt;varName&gt; [other arguments])
MARK_AS_ADVANCED(&lt;varName&gt;)
</pre>
</div>
<div class="section" id="append-cmndline-args">
<h3><a class="toc-backref" href="#id105">APPEND_CMNDLINE_ARGS()</a></h3>
<p>Utility function that appends command-line arguments to a variable of
command-line options.</p>
<p>Usage:</p>
<pre class="literal-block">
APPEND_CMNDLINE_ARGS(&lt;var&gt; &quot;&lt;extraArgs&gt;&quot;)
</pre>
<p>This function just appends the command-line arguments in the string
<tt class="docutils literal">&quot;&lt;extraArgs&gt;&quot;</tt> but does not add an extra space if <tt class="docutils literal">&lt;var&gt;</tt> is empty on
input.</p>
</div>
<div class="section" id="append-glob">
<h3><a class="toc-backref" href="#id106">APPEND_GLOB()</a></h3>
<p>Utility macro that does a <tt class="docutils literal">FILE(GLOB <span class="pre">...)</span></tt> and appends to an existing list
(removes boiler-plate code).</p>
<p>Usage:</p>
<pre class="literal-block">
APPEND_GLOB(&lt;fileListVar&gt; &lt;glob0&gt; &lt;glob1&gt; ...)
</pre>
<p>On output, <tt class="docutils literal">&lt;fileListVar&gt;</tt> will have the list of glob files appended.</p>
</div>
<div class="section" id="append-global-set">
<h3><a class="toc-backref" href="#id107">APPEND_GLOBAL_SET()</a></h3>
<p>Utility macro that appends arguments to a global variable (reduces
boiler-plate code and mistakes).</p>
<p>Usage:</p>
<pre class="literal-block">
APPEND_GLOBAL_SET(&lt;varName&gt; &lt;arg0&gt; &lt;arg1&gt; ...)
</pre>
<p>NOTE: The variable <tt class="docutils literal">&lt;varName&gt;</tt> must exist before calling this function.
To set it empty initially use <a class="reference internal" href="#global-null-set">GLOBAL_NULL_SET()</a>.</p>
</div>
<div class="section" id="append-set">
<h3><a class="toc-backref" href="#id108">APPEND_SET()</a></h3>
<p>Utility function to append elements to a varible (reduces boiler-plate
code).</p>
<p>Usage:</p>
<pre class="literal-block">
APPEND_SET(&lt;varName&gt; &lt;arg0&gt; &lt;arg1&gt; ...)
</pre>
<p>Just calls:</p>
<pre class="literal-block">
LIST(APPEND &lt;varName&gt; &lt;arg0&gt; &lt;arg1&gt; ...)
</pre>
</div>
<div class="section" id="append-string-var">
<h3><a class="toc-backref" href="#id109">APPEND_STRING_VAR()</a></h3>
<p>Append strings to an existing string variable (reduces boiler-place code and
reduces mistakes).</p>
<p>Usage:</p>
<pre class="literal-block">
APPEND_STIRNG_VAR(&lt;stringVar&gt; &quot;&lt;string1&gt;&quot; &quot;&lt;string2&gt;&quot; ...)
</pre>
<p>Note that the usage of the characters <tt class="docutils literal">'['</tt>, <tt class="docutils literal">']'</tt>, <tt class="docutils literal">'{'</tt>, <tt class="docutils literal">'}'</tt> are
taken by CMake to bypass the meaning of ';' to separate string characters.</p>
<p>If you want to ignore the meaning of these special characters and are okay with
just adding one string at a time use <a class="reference internal" href="#append-string-var-ext">APPEND_STRING_VAR_EXT()</a>.</p>
</div>
<div class="section" id="append-string-var-ext">
<h3><a class="toc-backref" href="#id110">APPEND_STRING_VAR_EXT()</a></h3>
<p>Append a single string to an existing string variable, ignoring ';' (reduces
boiler-place code and reduces mistakes).</p>
<p>Usage:</p>
<pre class="literal-block">
APPEND_STIRNG_VAR_EXT(&lt;stringVar&gt; &quot;&lt;string&gt;&quot;)
</pre>
<p>Simply sets <tt class="docutils literal">&lt;stringVar&gt; = <span class="pre">&quot;${&lt;stringVar&gt;}&lt;string&gt;&quot;</span></tt>.</p>
</div>
<div class="section" id="append-string-var-with-sep">
<h3><a class="toc-backref" href="#id111">APPEND_STRING_VAR_WITH_SEP()</a></h3>
<p>Append strings to a given string varible, joining them using a seperator.</p>
<p>Usage:</p>
<pre class="literal-block">
APPEND_STRING_VAR_WITH_SEP(&lt;stringVar&gt; &quot;&lt;sepStr&gt;&quot; &quot;&lt;str0&gt;&quot; &quot;&lt;str&gt;&quot; ...)
</pre>
<p>Each of the strings <tt class="docutils literal">&lt;stri&gt;</tt> are appended to <tt class="docutils literal">&lt;stringVar&gt;</tt> using the
separation string <tt class="docutils literal">&lt;sepStr&gt;</tt>.</p>
</div>
<div class="section" id="assert-defined">
<h3><a class="toc-backref" href="#id112">ASSERT_DEFINED()</a></h3>
<p>Assert that a varaible is defined and if not call <tt class="docutils literal">MESSAGE(SEND_ERROR <span class="pre">...)</span></tt>.</p>
<p>Usage:</p>
<pre class="literal-block">
ASSERT_DEFINED(&lt;varName&gt;)
</pre>
<p>This is used to get around the problem of CMake not asserting the
defreferencing of undefined varibles.  For example, how do you know if you
did not mispell the name of a varible in an if statement like:</p>
<pre class="literal-block">
IF (SOME_VARBLE)
  ...
ENDIF()
</pre>
<dl class="docutils">
<dt>?  If you mispelled the varible <tt class="docutils literal">SOME_VARBLE</tt> (which you likely did in</dt>
<dd><p class="first">this case), the the if statement will always be false.  To avoid this
problem when you always expect the explicitly set, instead do:</p>
<pre class="last literal-block">
ASSERT_DEFINED(SOME_VARBLE)
IF (SOME_VARBLE)
  ...
ENDIF()
</pre>
</dd>
</dl>
<p>Now if you misspell the varible, it will asset and stop processing.  This is
not a perfect solution since you can mispell the varible name in the
following if statemnt but typically you would always just copy and paste
between the two statements so they are always the same.  This is the best we
can do in CMake unfortunately.</p>
</div>
<div class="section" id="combined-option">
<h3><a class="toc-backref" href="#id113">COMBINED_OPTION()</a></h3>
<p>Set up a bool cache variable (i.e. an option) based on a set of dependent
options.</p>
<p>Usage:</p>
<pre class="literal-block">
COMBINED_OPTION( &lt;combinedOptionName&gt;
  DEP_OPTIONS_NAMES &lt;depOpName0&gt; &lt;depOptName1&gt; ...
  DOCSTR &quot;&lt;docstr0&gt;&quot; &quot;&lt;docstr1&quot; ...
  )
</pre>
<p>This sets up a bool cache variable <tt class="docutils literal">&lt;combinedOptionName&gt;</tt> which is
defaulted to <tt class="docutils literal">ON</tt> if all of the listed dependent option varaibles
<tt class="docutils literal">&lt;depOpName0&gt;</tt>, <tt class="docutils literal">&lt;depOptName1&gt;</tt>, ... are all <tt class="docutils literal">ON</tt>.  However, if
<tt class="docutils literal">&lt;combinedOptionName&gt;</tt> is set to <tt class="docutils literal">ON</tt> by the user and not all of the
dependent option varibles are also true, this results in a fatal eror and
alll processing stops.</p>
<p>This is used by a CMake project to by default automatically turn on a
feature that requires a set of other features to also be turned on but
allows a user to disable the feature if desired.</p>
</div>
<div class="section" id="concat-strings">
<h3><a class="toc-backref" href="#id114">CONCAT_STRINGS()</a></h3>
<p>Concatenate a set of string argumnets.</p>
<p>Usage:</p>
<pre class="literal-block">
CONCAT_STRINGS(&lt;outputVar&gt; &quot;&lt;str0&gt;&quot; &quot;&lt;str1&gt;&quot; ...)
</pre>
<p>On output, <tt class="docutils literal">&lt;outputVar&gt;</tt> is set to <tt class="docutils literal"><span class="pre">&quot;&lt;str0&gt;&lt;str1&gt;...&quot;</span></tt>.</p>
</div>
<div class="section" id="dual-scope-append-cmndline-args">
<h3><a class="toc-backref" href="#id115">DUAL_SCOPE_APPEND_CMNDLINE_ARGS()</a></h3>
<p>Utility function that appends command-line arguments to a variable of
command-line options and sets the result in current scope and parent scope.</p>
<p>Usage:</p>
<pre class="literal-block">
DUAL_SCOPE_APPEND_CMNDLINE_ARGS(&lt;var&gt; &quot;&lt;extraArgs&gt;&quot;)
</pre>
<p>Just calls <a class="reference internal" href="#append-cmndline-args">APPEND_CMNDLINE_ARGS()</a> and then <tt class="docutils literal"><span class="pre">SET(&lt;var&gt;</span> <span class="pre">${&lt;var&gt;}</span> PARENT_SCOPE)</tt>.</p>
</div>
<div class="section" id="dual-scope-prepend-cmndline-args">
<h3><a class="toc-backref" href="#id116">DUAL_SCOPE_PREPEND_CMNDLINE_ARGS()</a></h3>
<p>Utility function that prepends command-line arguments to a variable of
command-line options and sets the result in current scope and parent scope.</p>
<p>Usage:</p>
<pre class="literal-block">
DUAL_SCOPE_PREPEND_CMNDLINE_ARGS(&lt;var&gt; &quot;&lt;extraArgs&gt;&quot;)
</pre>
<p>Just calls <a class="reference internal" href="#prepend-cmndline-args">PREPEND_CMNDLINE_ARGS()</a> and then <tt class="docutils literal"><span class="pre">SET(&lt;var&gt;</span> <span class="pre">${&lt;var&gt;}</span> PARENT_SCOPE)</tt>.</p>
</div>
<div class="section" id="dual-scope-set">
<h3><a class="toc-backref" href="#id117">DUAL_SCOPE_SET()</a></h3>
<p>Macro that sets a variable name both in the current scope and the
parent scope.</p>
<p>Usage:</p>
<pre class="literal-block">
DUAL_SCOPE_SET(&lt;varName&gt; [other args])
</pre>
<p>It turns out that when you call <tt class="docutils literal"><span class="pre">ADD_SUBDIRECTORY(&lt;someDir&gt;)</span></tt> or enter a
FUNCTION that CMake actaully creates a copy of all of the regular non-cache
varaibles in the current scope in order to create a new set of variables for
the <tt class="docutils literal">CMakeLists.txt</tt> file in <tt class="docutils literal">&lt;someDir&gt;</tt>.  This means that if you call
<tt class="docutils literal">SET(SOMEVAR Blah PARENT_SCOPE)</tt> that it will not affect the value of
<tt class="docutils literal">SOMEVAR</tt> in the current scope.  This macro therefore is designed to set
the value of the variable in the current scope and the parent scope in one
shot to avoid confusion.</p>
<p>Global variables are different.  When you move to a subordinate
<tt class="docutils literal">CMakeLists.txt</tt> file or enter a function, a local copy of the variable is
<em>not</em> created.  If you set the value name locally, it will shadow the global
variable.  However, if you set the globlal value with SET(SOMEVAR someValue
CACHE INTERNAL &quot;&quot;), then the value will get changed in the current
subordinate scope and in all parent scopes all in one shot!</p>
</div>
<div class="section" id="global-null-set">
<h3><a class="toc-backref" href="#id118">GLOBAL_NULL_SET()</a></h3>
<p>Set a variable as a null internal global (cache) variable (removes boiler
plate).</p>
<p>Usage:</p>
<pre class="literal-block">
GLOBAL_NULL_SET(&lt;varName&gt;)
</pre>
<p>This just calls:</p>
<pre class="literal-block">
SET(&lt;varName&gt; &quot;&quot; CACHE INTERNAL &quot;&quot;)
</pre>
</div>
<div class="section" id="global-set">
<h3><a class="toc-backref" href="#id119">GLOBAL_SET()</a></h3>
<p>Set a variable as an internal global (cache) variable (removes boiler
plate).</p>
<p>Usage:</p>
<pre class="literal-block">
GLOBAL_SET(&lt;varName&gt; [other args])
</pre>
<p>This just calls:</p>
<pre class="literal-block">
SET(&lt;varName&gt; [other args] CACHE INTERNAL &quot;&quot;)
</pre>
</div>
<div class="section" id="join">
<h3><a class="toc-backref" href="#id120">JOIN()</a></h3>
<p>Join a set of strings into a single string using a join string.</p>
<p>Usage:</p>
<pre class="literal-block">
JOIN(&lt;outputStrVar&gt; &lt;sepStr&gt; &lt;quoteElements&gt;
  &quot;&lt;string0&gt;&quot; &quot;&lt;string1&quot;&gt; ...)
</pre>
<p>Arguments:</p>
<blockquote>
<p><tt class="docutils literal">&lt;outputStrVar&gt;</tt></p>
<blockquote>
The name of a variable that will hold the output string.</blockquote>
<p><tt class="docutils literal">&lt;sepStr&gt;</tt></p>
<blockquote>
A string to use to join the list of strings.</blockquote>
<p><tt class="docutils literal">&lt;quoteElements&gt;</tt></p>
<blockquote>
<dl class="docutils">
<dt>If TRUE, then each <tt class="docutils literal">&lt;stingi&gt;</tt> is quoted using an escaped quote char</dt>
<dd><tt class="docutils literal">\&quot;</tt>.  If <tt class="docutils literal">FALSE</tt> then no escaped quote is used.</dd>
</dl>
</blockquote>
</blockquote>
<p>On output the variable <tt class="docutils literal">&lt;outputStrVar&gt;</tt> is set to:</p>
<pre class="literal-block">
&quot;&lt;string0&gt;&lt;sepStr&gt;&lt;string1&gt;&lt;sepStr&gt;...&quot;
</pre>
<p>If <tt class="docutils literal"><span class="pre">&lt;quoteElements&gt;=TRUE</span></tt>, then it is set to:</p>
<pre class="literal-block">
&quot;\&quot;&lt;string0&gt;\&quot;&lt;sepStr&gt;\&quot;&lt;string1&gt;\&quot;&lt;sepStr&gt;...&quot;
</pre>
<p>For example, the latter can be used to set up a set of command-line
arguments given a CMake array like:</p>
<pre class="literal-block">
JOIN(CMND_LINE_ARGS &quot; &quot; TRUE ${CMND_LINE_ARRAY})
</pre>
<p>WARNING: Be careful to quote string arguments that have spaces because CMake
interpet those ase array boundaries.</p>
</div>
<div class="section" id="message-wrapper">
<h3><a class="toc-backref" href="#id121">MESSAGE_WRAPPER()</a></h3>
<p>Function that wraps the standard CMake/CTest <tt class="docutils literal">MESSAGE()</tt> function call in
order to allow unit testing to intercept the call.</p>
<p>Usage:</p>
<pre class="literal-block">
MESSAGE_WRAPPER(&lt;arg0&gt; &lt;arg1&gt; ...)
</pre>
<p>This function takes exactly the same argumnets as built-in <tt class="docutils literal">MESSAGE()</tt>.
When the varible <tt class="docutils literal">MESSAGE_WRAPPER_UNIT_TEST_MODE</tt> is set to <tt class="docutils literal">TRUE</tt>, then
this function will not call <tt class="docutils literal"><span class="pre">MESSAGE(&lt;arg0&gt;</span> &lt;arg1&gt; <span class="pre">...)</span></tt> but instead will
prepend set to global varible <tt class="docutils literal">MESSAGE_WRAPPER_INPUT</tt> that input
argumnets.  To capture just this call's input, first call
<tt class="docutils literal">GLOBAL_NULL_SET(MESSAGE_WRAPPER_INPUT(MESSAGE_WRAPPER_INPUT)</tt> before
calling this function.</p>
<p>This function allows one to unit test other user-defined CMake macros and
functions that call this to catch error conditions wihtout stopping the
CMake program.  Otherwise, this is used to capture print messages to verify
that they say the right thing.</p>
</div>
<div class="section" id="multiline-set">
<h3><a class="toc-backref" href="#id122">MULTILINE_SET()</a></h3>
<p>Function to set a single string by concatenating a list of separate strings</p>
<p>Usage:</p>
<pre class="literal-block">
MULTILINE_SET(&lt;outputStrVar&gt;
  &quot;&lt;string0&gt;&quot;
  &quot;&lt;string1&gt;&quot;
  ...
  )
</pre>
<p>On output, the local variables <tt class="docutils literal">&lt;outputStrVar&gt;</tt> is set to:</p>
<pre class="literal-block">
&quot;&lt;string0&gt;&lt;string1&gt;...&quot;
</pre>
<p>The purpose of this is to make it easier to set longer strings without going
to far to the right.</p>
</div>
<div class="section" id="parse-arguments">
<h3><a class="toc-backref" href="#id123">PARSE_ARGUMENTS()</a></h3>
<p>Parse a set of macro/functon input arguments into different lists.  This
allows the easy implementation of keyword-based user-defined macros and
functions.</p>
<p>Usage:</p>
<pre class="literal-block">
PARSE_ARGUMENTS(
  &lt;prefix&gt;  &lt;argNamesList&gt;  &lt;optionNamesList&gt;
  &lt;inputArgsList&gt;
  )
</pre>
<p>Arguments to this macro:</p>
<blockquote>
<p><tt class="docutils literal">&lt;prefix&gt;</tt></p>
<blockquote>
Prefix <tt class="docutils literal">&lt;prefix&gt;_</tt> added the list and option variables created listed
in <tt class="docutils literal">&lt;argNamesList&gt;</tt> and <tt class="docutils literal">&lt;optionNamesList&gt;</tt>.</blockquote>
<p><tt class="docutils literal">&lt;argNamesList&gt;</tt></p>
<blockquote>
Quoted array of list arguments (e.g. <tt class="docutils literal"><span class="pre">&quot;&lt;argName0&gt;;&lt;argName1&gt;;...&quot;</span></tt>).
For each varaible name <tt class="docutils literal">&lt;argNamei&gt;</tt>, a local varible will be created
in the current scope with the name <tt class="docutils literal">&lt;prefix&gt;_&lt;argNamei&gt;</tt> which gives
the list of varibles parsed out of <tt class="docutils literal">&lt;inputArgsList&gt;</tt>.</blockquote>
<p><tt class="docutils literal">&lt;optionNamesList&gt;</tt></p>
<blockquote>
Quoted array of list arguments (e.g. <tt class="docutils literal"><span class="pre">&quot;&lt;optName0&gt;;&lt;optName1&gt;;...&quot;</span></tt>).
For each varaible name <tt class="docutils literal">&lt;optNamei&gt;</tt>, a local varible will be created
in the current scope with the name <tt class="docutils literal">&lt;prefix&gt;_&lt;optNamei&gt;</tt> that is
either set to <tt class="docutils literal">TRUE</tt> or <tt class="docutils literal">FALSE</tt> depending if <tt class="docutils literal">&lt;optNamei&gt;</tt> apears
in <tt class="docutils literal">&lt;inputArgsList&gt;</tt> or not.</blockquote>
<p><tt class="docutils literal">&lt;inputArgsList&gt;</tt></p>
<blockquote>
List of arguments keyword-based arguments passed in for the outer macro
or function to be parsed out into the different argument and option
lists.</blockquote>
</blockquote>
<p>What this macro does is very simple yet very useful.  What it does is to
allow you to create your own user-defined keyword-based macros and functions
like is used by some built-in CMake comamnds..</p>
<p>For example, consider the following user-defined macro that uses both
positional and keyword-based arguments using <tt class="docutils literal">PARSE_ARGUMENTS()</tt>:</p>
<pre class="literal-block">
MACRO(PARSE_SPECIAL_VARS  BASE_NAME)

  PARSE_ARGUMENTS(
    #prefix
    ${BASE_NAME}
    #lists
    &quot;ARG0;ARG1;ARG2&quot;
    #options
    &quot;OPT0;OPT1&quot;
    ${ARGN}
    )

ENDMACRO()
</pre>
<p>Calling this macro as:</p>
<pre class="literal-block">
PARSE_SPECIAL_VARS(MyVar ARG0 a b ARG2 c OPT1)
</pre>
<p>sets the following varibles in the current scope:</p>
<pre class="literal-block">
MyVar_ARG0=&quot;a;b&quot;
MyVar_ARG1=&quot;&quot;
MyVar_ARG2=&quot;c&quot;
MyVar_OPT0=&quot;FALSE&quot;
MyVar_OPT1=&quot;TRUE&quot;
</pre>
<p>This allows you to define user-defined macros and functions that have a
mixture of positional arguments and keyword-based arguments like you can do
in other languages.  The keyword-based arguments can be passed in any
order and those that are missing are empty (or false) by default.</p>
<p>Any initial arguments that are not recongnised as <tt class="docutils literal">&lt;argNamesList&gt;</tt> or
<tt class="docutils literal">&lt;optionNamesList&gt;</tt> keyword arguments will be put into the local varible
<tt class="docutils literal">_DEFAULT_ARGS</tt>.  If no arguments in <tt class="docutils literal">${ARGN}</tt> match any in
<tt class="docutils literal">&lt;argNamesList&gt;</tt>, then all non-option arguments are point into
<tt class="docutils literal">DEFAULT_ARGS</tt>.  For example, if you pass in:</p>
<pre class="literal-block">
PARSE_SPECIAL_VARS(MyVar ARG5 a b c)
</pre>
<p>you will get:</p>
<pre class="literal-block">
DEFAULT_ARGS=&quot;a;b;c&quot;
MyVar_ARG0=&quot;&quot;
MyVar_ARG1=&quot;&quot;
MyVar_ARG2=&quot;&quot;
MyVar_OPT0=&quot;FALSE&quot;
MyVar_OPT1=&quot;FALSE&quot;
</pre>
<p>Multiple occurances of keyword arguments in <tt class="docutils literal">${ARGN}</tt> is allowed but only
the last one listed will be recored.  For example, if you call:</p>
<pre class="literal-block">
PARSE_SPECIAL_VARS(MyVar ARG1 a b ARG1 c)
</pre>
<p>then this wil set:</p>
<pre class="literal-block">
MyVar_ARG0=&quot;&quot;
MyVar_ARG1=&quot;c&quot;
MyVar_ARG2=&quot;&quot;
MyVar_OPT0=&quot;FALSE&quot;
MyVar_OPT1=&quot;FALSE&quot;
</pre>
<p>This is actually consistent with the way that most arugment list parsers
behave with respect to multiple instances of the same argument so hopefully
this will not be a surprise to anyone.</p>
<p>If you put an option keyword in the middle of a keyword argument list, the
option keyword will get pulled out of the list.  For exmaple, if you call:</p>
<pre class="literal-block">
PARSE_SPECIAL_VARS(MyVar ARG0 a OPT0 c)
</pre>
<p>then this wil set:</p>
<pre class="literal-block">
MyVar_ARG0=&quot;a;c&quot;
MyVar_ARG1=&quot;&quot;
MyVar_ARG2=&quot;&quot;
MyVar_OPT0=&quot;TRUE&quot;
MyVar_OPT1=&quot;FALSE&quot;
</pre>
<p>If <tt class="docutils literal"><span class="pre">PARSE_ARGUMENTS_DUMP_OUTPUT_ENABLED``is</span> set to ``TRUE</tt>, then a bunch
of detailed debug info will be printed.  This should only lbe used in the
most desparate of debug situations because it will print a <em>lot</em> of output!</p>
<p><strong>PERFORMANCE:</strong> This function will scale as:</p>
<pre class="literal-block">
O( (len(&lt;argNamesList&gt;) * len(&lt;optionNamesList&gt;)) * len(&lt;inputArgsList&gt;) )
</pre>
<p>Therefore, this could scale very badly for large lests of argument and
option names and input argument lists.</p>
</div>
<div class="section" id="prepend-cmndline-args">
<h3><a class="toc-backref" href="#id124">PREPEND_CMNDLINE_ARGS()</a></h3>
<p>Utility function that prepends command-line arguments to a variable of
command-line options.</p>
<p>Usage:</p>
<pre class="literal-block">
PREPEND_CMNDLINE_ARGS(&lt;var&gt; &quot;&lt;extraArgs&gt;&quot;)
</pre>
<p>This function just prepends the command-line arguments in the string
<tt class="docutils literal">&quot;&lt;extraArgs&gt;&quot;</tt> but does not add an extra space if <tt class="docutils literal">&lt;var&gt;</tt> is empty on
input.</p>
</div>
<div class="section" id="prepend-global-set">
<h3><a class="toc-backref" href="#id125">PREPEND_GLOBAL_SET()</a></h3>
<p>Utility macro that prepends arguments to a global variable (reduces
boiler-plate code and mistakes).</p>
<p>Usage:</p>
<pre class="literal-block">
PREPEND_GLOBAL_SET(&lt;varName&gt; &lt;arg0&gt; &lt;arg1&gt; ...)
</pre>
<p>NOTE: The variable <tt class="docutils literal">&lt;varName&gt;</tt> must exist before calling this function.
To set it empty initially use <a class="reference internal" href="#global-null-set">GLOBAL_NULL_SET()</a>.</p>
</div>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id126">APPEND_SET()</a></h3>
<p>Utility function to append elements to a varible (reduces boiler-plate
code).</p>
<p>Usage:</p>
<pre class="literal-block">
APPEND_SET(&lt;varName&gt; &lt;arg0&gt; &lt;arg1&gt; ...)
</pre>
<p>Just calls:</p>
<pre class="literal-block">
LIST(APPEND &lt;varName&gt; &lt;arg0&gt; &lt;arg1&gt; ...)
</pre>
</div>
<div class="section" id="print-nonempty-var">
<h3><a class="toc-backref" href="#id127">PRINT_NONEMPTY_VAR()</a></h3>
<p>Print a defined variable giving its name then value only if it is not empty.</p>
<p>Usage:</p>
<pre class="literal-block">
PRINT_NONEMPTY_VAR(&lt;varName&gt;)
</pre>
<p>Calls <tt class="docutils literal"><span class="pre">PRINT_VAR(&lt;varName&gt;)</span></tt> if <tt class="docutils literal"><span class="pre">${&lt;varName&gt;}</span></tt> is not empty.</p>
</div>
<div class="section" id="print-var">
<h3><a class="toc-backref" href="#id128">PRINT_VAR()</a></h3>
<p>Unconditionally print a variable giving its name then value.</p>
<p>Usage:</p>
<pre class="literal-block">
PRINT_VAR(&lt;varName&gt;)
</pre>
<p>This prints:</p>
<pre class="literal-block">
MESSAGE(&quot;-- &quot; &quot;${VARIBLE_NAME}='${${VARIBLE_NAME}}'&quot;)
</pre>
<p>The variable <tt class="docutils literal">&lt;varName&gt;</tt> can be defined or undefined or empty.  This uses
an explicit &quot;-- &quot; line prefix so that it prints nice even on Windows CMake.</p>
</div>
<div class="section" id="remove-global-duplicates">
<h3><a class="toc-backref" href="#id129">REMOVE_GLOBAL_DUPLICATES()</a></h3>
<p>Remove duplicate elements from a global list variable.</p>
<p>Usage:</p>
<pre class="literal-block">
REMOVE_GLOBAL_DUPLICATES(&lt;globalVarName&gt;)
</pre>
<p>This function is necessary in order to preserve the &quot;global&quot; nature of the
variable.  If you just call LIST(REMOVE_DUPLICATES ...) it will actually
create a local variable of the same name and shadow the global variable!
That is a fun bug to track down!</p>
</div>
<div class="section" id="set-and-inc-dirs">
<h3><a class="toc-backref" href="#id130">SET_AND_INC_DIRS()</a></h3>
<p>Set a variable to an include dir and call <tt class="docutils literal">INCLUDE_DIRECTORIES()</tt> (removes
boiler plate).</p>
<p>Usage:</p>
<blockquote>
SET_AND_INC_DIRS(&lt;dirVarName&gt; &lt;includeDir&gt;)</blockquote>
<p>On output, this justs <tt class="docutils literal">&lt;dirVarName&gt;</tt> to <tt class="docutils literal">&lt;includeDir&gt;</tt> in the local
scope and calls <tt class="docutils literal"><span class="pre">INCLUDE_DIRECTORIES(&lt;includeDir&gt;)</span></tt>.</p>
</div>
<div class="section" id="set-cache-on-off-empty">
<h3><a class="toc-backref" href="#id131">SET_CACHE_ON_OFF_EMPTY()</a></h3>
<p>Usage:</p>
<pre class="literal-block">
SET_CACHE_ON_OFF_EMPTY(&lt;varName&gt; &lt;initialVal&gt; &quot;&lt;docString&gt;&quot; [FORCE])
</pre>
<p>Sets a special string cache variable with possible values &quot;&quot;, &quot;ON&quot;, or
&quot;OFF&quot;.  This results in a nice dropdown box in the CMake cache manipulation
GUIs.</p>
</div>
<div class="section" id="set-default">
<h3><a class="toc-backref" href="#id132">SET_DEFAULT()</a></h3>
<p>Give a local variable a default if a non-empty value is not already set.</p>
<p>Usage:</p>
<pre class="literal-block">
SET_DEFAULT(&lt;varName&gt; &lt;arg0&gt; &lt;arg1&gt; ...)
</pre>
<p>If on input <tt class="docutils literal"><span class="pre">&quot;${&lt;varName&gt;}&quot;==&quot;&quot;</span></tt>, then <tt class="docutils literal">&lt;varName&gt;</tt> is set to the given
default.  Otherwise, the existing non-empty value is preserved.</p>
</div>
<div class="section" id="set-default-and-from-env">
<h3><a class="toc-backref" href="#id133">SET_DEFAULT_AND_FROM_ENV()</a></h3>
<p>Set a default value for a local variable and override from an env var of the
same name if it is set.</p>
<p>Usage:</p>
<pre class="literal-block">
SET_DEFAULT_AND_FROM_ENV(&lt;varName&gt; &lt;defaultVal&gt;)
</pre>
<p>First calls <tt class="docutils literal"><span class="pre">SET_DEFAULT(&lt;varName&gt;</span> &lt;defaultVal&gt;)</tt> and then looks for an
environment variable named <tt class="docutils literal">&lt;varName&gt;</tt> and if non-empty, then overrides
the value of <tt class="docutils literal">&lt;varName&gt;</tt>.</p>
<p>This macro is primarily used in CTest code to provide a way to pass in the
value of CMake variables.  Older versions of <tt class="docutils literal">ctest</tt> did not support the
option <tt class="docutils literal"><span class="pre">-D</span> <span class="pre">&lt;var&gt;:&lt;type&gt;=&lt;value&gt;</span></tt> to allow varaibles to be set through the
commandline like <tt class="docutils literal">cmake</tt> always allowed.</p>
</div>
<div class="section" id="split">
<h3><a class="toc-backref" href="#id134">SPLIT()</a></h3>
<p>Split a string varible into a string array/list variable.</p>
<p>Usage:</p>
<pre class="literal-block">
SPLIT(&quot;&lt;inputStr&gt;&quot; &quot;&lt;sepStr&gt;&quot; &lt;outputStrListVar&gt;)
</pre>
<p>The <tt class="docutils literal">&lt;sepStr&gt;</tt> string is used with <tt class="docutils literal">STRING(REGEX <span class="pre">...)</span></tt> to replace all
occurrences of <tt class="docutils literal">&lt;sepStr&gt;` in <span class="pre">``&lt;inputStr&gt;</span></tt> with &quot;;&quot; and writing into
<tt class="docutils literal">&lt;outputStrListVar&gt;</tt>.</p>
<p>WARNING: <tt class="docutils literal">&lt;sepStr&gt;</tt> is interpreted as a regular expression so keep that in
mind when considering special regex chars like <tt class="docutils literal">'*'</tt>, <tt class="docutils literal">'.'</tt>, etc!</p>
</div>
<div class="section" id="timer-get-raw-seconds">
<h3><a class="toc-backref" href="#id135">TIMER_GET_RAW_SECONDS()</a></h3>
<p>Return the raw time in seconds since epoch, i.e., since 1970-01-01 00:00:00
UTC.</p>
<p>Usage:</p>
<pre class="literal-block">
TIMER_GET_RAW_SECONDS(&lt;rawSecondsVar&gt;)
</pre>
<p>This function is used along with <a class="reference internal" href="#timer-get-rel-seconds">TIMER_GET_REL_SECONDS()</a>, and
<a class="reference internal" href="#timer-print-rel-time">TIMER_PRINT_REL_TIME()</a> to time big chunks of CMake code for timing and
profiling purposes.  See <a class="reference internal" href="#timer-print-rel-time">TIMER_PRINT_REL_TIME()</a> for more details and an
example.</p>
<p>NOTE: This function runs an external process to run the <tt class="docutils literal">date</tt> command.
Therefsore, it only works on Unix/Linux type systems that have a standard
<tt class="docutils literal">date</tt> command.  Since this runs an external process, this function should
only be used to time very course grained operations (i.e. that take longer
than a second).</p>
</div>
<div class="section" id="timer-get-rel-seconds">
<h3><a class="toc-backref" href="#id136">TIMER_GET_REL_SECONDS()</a></h3>
<p>Return the relative time between start and stop seconds.</p>
<p>Usage:</p>
<pre class="literal-block">
TIMER_GET_REL_SECONDS(&lt;startSeconds&gt; &lt;endSeconds&gt; &lt;relSecondsOutVar&gt;)
</pre>
<p>This simple function computes the relative number of seconds between
<tt class="docutils literal">&lt;startSeconds&gt;</tt> and <tt class="docutils literal">&lt;endSeconds&gt;</tt> (i.e. from
<a class="reference internal" href="#timer-get-raw-seconds">TIMER_GET_RAW_SECONDS()</a>) and sets the result in the local variable
<tt class="docutils literal">&lt;relSecondsOutVar&gt;</tt>.</p>
</div>
<div class="section" id="timer-print-rel-time">
<h3><a class="toc-backref" href="#id137">TIMER_PRINT_REL_TIME()</a></h3>
<p>Print the relative time between start and stop timers in <tt class="docutils literal">&lt;min&gt;m&lt;sec&gt;s</tt>
format.</p>
<p>Usage:</p>
<blockquote>
TIMER_PRINT_REL_TIME(&lt;startSeconds&gt; &lt;endSeconds&gt; &quot;&lt;messageStr&gt;&quot;)</blockquote>
<p>Differences the raw times <tt class="docutils literal">&lt;startSeconds&gt;</tt> and <tt class="docutils literal">&lt;endSeconds&gt;</tt>
(i.e. gotten from <a class="reference internal" href="#timer-get-raw-seconds">TIMER_GET_RAW_SECONDS()</a>) and prints the time in
<tt class="docutils literal">&lt;min&gt;m&lt;sec&gt;s</tt> format.  This can only resolve times a second or greater
apart.  If the start and end times are less than a second then <tt class="docutils literal">0m0s</tt> will
be printed.</p>
<p>This is meant to be used with <a class="reference internal" href="#timer-get-raw-seconds">TIMER_GET_RAW_SECONDS()</a> to time expensive
blocks of CMake code like:</p>
<pre class="literal-block">
TIMER_GET_RAW_SECONDS(REAL_EXPENSIVE_START)

REAL_EXPENSIVE(...)

TIMER_GET_RAW_SECONDS(REAL_EXPENSIVE_END)

TIMER_PRINT_REL_TIME(${REAL_EXPENSIVE_START} ${REAL_EXPENSIVE_END}
   &quot;REAL_EXPENSIVE() time&quot;)
</pre>
<p>This will print something like:</p>
<pre class="literal-block">
REAL_EXPENSIVE() time: 0m5s
</pre>
<p>Again, don't try to time something that takes less than 1 second as it will
be recored as <tt class="docutils literal">0m0s</tt>.</p>
</div>
<div class="section" id="unittest-compare-const">
<h3><a class="toc-backref" href="#id138">UNITTEST_COMPARE_CONST()</a></h3>
<p>Perform a single unit test equality check and update overall test statistics</p>
<p>Usage:</p>
<pre class="literal-block">
UNITTEST_COMPARE_CONST(&lt;varName&gt; &lt;expectedValue&gt;)
</pre>
<p>If <tt class="docutils literal"><span class="pre">${&lt;varName&gt;}</span> == &lt;expectedValue&gt;</tt>, then the check passes, otherwise it
fails.  This prints the variable name and values and shows the test result.</p>
<p>This updates the global variables <tt class="docutils literal">UNITTEST_OVERALL_NUMRUN</tt>,
<tt class="docutils literal">UNITTEST_OVERALL_NUMPASSED</tt>, and <tt class="docutils literal">UNITTEST_OVERALL_PASS</tt> which are used
by the unit test harness system to assess overall pass/fail.</p>
</div>
<div class="section" id="unittest-string-regex">
<h3><a class="toc-backref" href="#id139">UNITTEST_STRING_REGEX()</a></h3>
<p>Perform a series regexes of given strings and update overall test statistics.</p>
<p>Usage:</p>
<pre class="literal-block">
UNITTEST_STRING_REGEX(
  &lt;inputString&gt;
  REGEX_STRINGS &lt;str0&gt; &lt;str1&gt; ...
  )
</pre>
<p>If the <tt class="docutils literal">&lt;inputString&gt;</tt> matches all of the of the regexs <tt class="docutils literal">&lt;str0&gt;</tt>,
''&lt;str1&gt;``, ..., then the test passes.  Otherwise it fails.</p>
<p>This updates the global variables <tt class="docutils literal">UNITTEST_OVERALL_NUMRUN</tt>,
<tt class="docutils literal">UNITTEST_OVERALL_NUMPASSED</tt>, and <tt class="docutils literal">UNITTEST_OVERALL_PASS</tt> which are used
by the unit test harness system to assess overall pass/fail.</p>
</div>
<div class="section" id="unittest-file-regex">
<h3><a class="toc-backref" href="#id140">UNITTEST_FILE_REGEX()</a></h3>
<p>Perform a series regexes of given strings and update overall test statistics.</p>
<p>Usage:</p>
<pre class="literal-block">
UNITTEST_FILE_REGEX(
  &lt;inputFileName&gt;
  REGEX_STRINGS &lt;str1&gt; &lt;str2&gt; ...
  )
</pre>
<p>The contents of <tt class="docutils literal">&lt;inputFileName&gt;</tt> are read into a string and then passed
to <a class="reference internal" href="#unittest-string-regex">UNITTEST_STRING_REGEX()</a> to assess pass/fail.</p>
</div>
<div class="section" id="unittest-final-result">
<h3><a class="toc-backref" href="#id141">UNITTEST_FINAL_RESULT()</a></h3>
<p>Print final statstics from all tests and assert final pass/fail</p>
<p>Usage:</p>
<pre class="literal-block">
UNITTEST_FINAL_RESULT(&lt;expectedNumPassed&gt;)
</pre>
<p>If <tt class="docutils literal"><span class="pre">${UNITTEST_OVERALL_PASS}==TRUE</span></tt> and <tt class="docutils literal">${UNITTEST_OVERALL_NUMPASSED} ==
&lt;expectedNumPassed&gt;</tt>, then the overall test program is determined to have
passed and string:</p>
<pre class="literal-block">
&quot;Final UnitTests Result: PASSED&quot;
</pre>
<p>is printed.  Otherwise, the overall tets program is determined to have
failed, the string:</p>
<pre class="literal-block">
&quot;Final UnitTests Result: FAILED&quot;
</pre>
<p>is printed and <tt class="docutils literal">MESSAGE(SEND_ERROR &quot;FAIL&quot;)</tt> is called.</p>
<p>The reason that we require passing in the expected number of passed tests is
an an extra precaution to make sure that important unit tests are not left
out.  CMake is a loosely typed language and it pays to be a little paranoid.</p>
</div>
</div>
</div>
<div class="section" id="appendix">
<h1><a class="toc-backref" href="#id142">13&nbsp;&nbsp;&nbsp;Appendix</a></h1>
<div class="section" id="history-of-tribits">
<h2><a class="toc-backref" href="#id143">13.1&nbsp;&nbsp;&nbsp;History of TriBITS</a></h2>
<p>TriBITS started development in November 2007 as a set of helper macros to
provide a CMake build system for a small subset of packages in Trilinos.  The
initial goal was to just to support a native Windows build (using Visual C++)
to compile and install these few Trilinos packages on Windows for usage by
another project (the Sandia Titan project which included VTK).  At that time,
Trilinos was using a highly customized autotools build system.  Initially,
this CMake system was just a set of macros to streamline creating executables
and tests.  Some of the conventions started in that early effort (e.g. naming
conventions of variables and macros where functions use upper case like old
FORTRAN and variables are mixed case) were continued in later efforts and are
reflected in the current.  Then, stating in early 2008, a more detailed
evaluation was performed to see if Trilinos should stitch over to CMake as the
default (and soon only) supported build and test system (see &quot;Why CMake?&quot; in
<a class="reference external" href="../overview/TribitsOverview.pdf">TriBITS Overview</a>).  This lead to the
initial implementation of a scale-able package-based architecture
(PackageArch) for the Trilinos CMake project in late 2008.  This Trilinos
CMake PackageArch system evolved over the next few years with development in
the system slowing into 2010.  This Trilinos CMake build system was then
adopted as the build infrastructure for the CASL VERA effort in 2011 where
CASL VERA packages were treated as add-on Trilinos packages (see Section
<a class="reference internal" href="#multi-repository-support">Multi-Repository Support</a>).  Over the next year, there was significant
development of the system to support larger multi-repo projects in support of
CASL VERA.  That lead to the decision to formally generalize the Trilinos
CMake PackageArch build system outside of Trilinos and the name TriBITS was
formally adopted in November 2011.  Work to refactor the Trilinos CMake system
into a general reusable stand-alone CMake-based build system started in
October 2011 and an initial implementation was complete in December 2011 when
it was used for the CASL VERA build system.  In early 2012, the ORNL
CASL-related projects Denovo and SCALE (see [<a class="reference internal" href="#scale">SCALE</a>]) adopted TriBITS as
their native development build systems.  Shortly after TriBITS was adopted the
native build system for the the CASL-related University of Michigan code
MPACT.  In addition to being used in CASL, all of these codes also had a
significant life outside of CASL.  Because they used the same TriBITS build
system, it proved relatively easy to keep these various codes integrated
together in the CASL VERA code meta-build.  At the same time, TriBITS well
served the independent development teams and non-CASL projects independent
from CASL VERA.  Since the initial extraction of TriBITS from Trilinos, the
TriBITS system was further extended and refined, driven by CASL VERA
development and expansion.  Independently, an early version of TriBITS from
2012 was adopted by the LiveV projectfootnote{<a class="reference external" href="https://github.com/lifev/cmake">https://github.com/lifev/cmake</a>}
which was forked and extended independently.</p>
<p>Note that a TriBITS &quot;Package&quot; is not the same thing as a &quot;Package&quot; in raw
CMake terminology.  In raw CMake, a &quot;Package&quot; is some externally provided bit
of software or other utiltiy for which the current CMake project has an
optional or required dependency.  Therefore, a raw CMake &quot;Package&quot; actually
maps to a <a class="reference internal" href="#tribits-tpl">TriBITS TPL</a>.  A raw CMake &quot;Package&quot; (e.g. Boost, CUDA, etc.)  can
be found using a standard CMake find module <tt class="docutils literal"><span class="pre">Find&lt;rawPackageName&gt;.cmake</span></tt>
using the built-in command <tt class="docutils literal"><span class="pre">FIND_PACKAGE(&lt;rawPackageName&gt;)</span></tt>.  It is
unfortunate that the TriBITS and the raw CMake defintions of the term
&quot;Package&quot; are not the same.  However, the term &quot;Package&quot; was coined by the
Trilinos project long ago before CMake was adopted as the Trilinos build
system and Trilinos' definition of &quot;Package&quot; (going back to 1998) pre-dates
the development of CMake and therefore dictated the terminology of TriBITS</p>
</div>
<div class="section" id="design-considerations-for-tribits">
<h2><a class="toc-backref" href="#id144">13.2&nbsp;&nbsp;&nbsp;Design Considerations for TriBITS</a></h2>
<p>ToDo: Discuss design requirements.</p>
<p>ToDo: Discuss why it is a good idea to explicitly list packages instead of
just searching for them.</p>
</div>
<div class="section" id="checkin-test-py-help">
<h2><a class="toc-backref" href="#id145">13.3&nbsp;&nbsp;&nbsp;checkin-test.py --help</a></h2>
<p>ToDo: Include output from checkin-test --help</p>
</div>
<div class="section" id="egdist-help">
<h2><a class="toc-backref" href="#id146">13.4&nbsp;&nbsp;&nbsp;egdist --help</a></h2>
<p>ToDo: Include output from egdist --help</p>
</div>
</div>
</div>
</body>
</html>
